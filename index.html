<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æ·±æ·µã®ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ - ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ç·¨æˆRPG v2.0</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=DotGothic16&display=swap');
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'DotGothic16','MS Gothic',monospace;background:#1a1a2e;color:#e0e0e0;min-height:100vh;overflow-x:hidden}
.screen{display:none;min-height:100vh;padding:12px;max-width:960px;margin:0 auto}
.screen.active{display:block}
h1{text-align:center;color:#ffd700;font-size:1.6em;margin:12px 0;text-shadow:0 0 10px #ffd70066}
h2{text-align:center;color:#aaa;font-size:1em;margin-bottom:16px}
.subtitle{text-align:center;color:#888;font-size:.85em;margin-bottom:20px}

/* === ã‚­ãƒ£ãƒ©é¸æŠ === */
.char-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(165px,1fr));gap:10px;margin-bottom:16px}
.char-card{background:#16213e;border:2px solid #333;border-radius:10px;padding:12px 10px 10px;cursor:pointer;transition:.2s;text-align:center;user-select:none;position:relative;touch-action:manipulation;-webkit-tap-highlight-color:transparent}
.char-card:hover{border-color:#5588ff;transform:translateY(-3px);box-shadow:0 4px 16px #5588ff22}
.char-card.selected{border-color:#ffd700;background:#1a2a4e;box-shadow:0 0 16px #ffd70044}
.char-card.disabled{opacity:.35;pointer-events:none}
.char-icon{font-size:2.4em;margin-bottom:2px}
.char-name{font-size:1em;color:#fff;font-weight:bold;display:flex;align-items:center;justify-content:center;gap:4px}
.gender-m{color:#6ec6ff}
.gender-f{color:#ff8ec4}
.char-class{font-size:.8em;color:#aaa;margin:2px 0}
.char-trait{font-size:.72em;color:#b8b8d0;margin:2px 0}
.char-quote{font-size:.68em;color:#8899aa;font-style:italic;margin:4px 0 6px;min-height:2em;line-height:1.3}
.char-stats-bars{margin-top:6px;text-align:left}
.stat-row{display:flex;align-items:center;gap:4px;margin:2px 0;font-size:.65em;color:#999}
.stat-label{width:28px;text-align:right;flex-shrink:0}
.stat-bar-bg{flex:1;height:6px;background:#222;border-radius:3px;overflow:hidden}
.stat-bar-fill{height:100%;border-radius:3px;transition:width .3s}
.stat-bar-fill.hp{background:#4caf50}
.stat-bar-fill.atk{background:#ff6b6b}
.stat-bar-fill.def{background:#5588ff}
.stat-bar-fill.spd{background:#ffd700}
.stat-val{width:22px;text-align:left;flex-shrink:0}

/* ã‚«ãƒ¼ãƒ‰è©³ç´°ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ— */
.card-detail-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.7);z-index:100;justify-content:center;align-items:center;padding:16px}
.card-detail-overlay.show{display:flex}
.card-detail{background:#16213e;border:2px solid #5588ff;border-radius:12px;padding:20px;max-width:400px;width:100%;max-height:80vh;overflow-y:auto;position:relative}
.card-detail .close-btn{position:absolute;top:8px;right:12px;background:none;border:none;color:#aaa;font-size:1.4em;cursor:pointer}
.card-detail .close-btn:hover{color:#fff}
.card-detail h3{text-align:center;color:#ffd700;margin-bottom:10px;font-size:1.2em}
.card-detail .detail-section{margin:10px 0;padding:8px;background:#111a2e;border-radius:6px}
.card-detail .detail-section h4{color:#5588ff;font-size:.85em;margin-bottom:4px}
.card-detail .detail-section p{font-size:.8em;color:#ccc;line-height:1.5}
.card-detail .detail-stats .stat-row{font-size:.78em}
.card-detail .detail-stats .stat-bar-bg{height:8px}

/* ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼é¸æŠãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ */
.party-info{text-align:center;margin:12px 0;font-size:1.1em;color:#ffd700}
.party-preview{position:fixed;bottom:0;left:0;right:0;background:#0d1117ee;border-top:2px solid #ffd700;padding:10px 12px;z-index:50;display:none;backdrop-filter:blur(6px)}
.party-preview.show{display:block}
.party-preview-inner{max-width:960px;margin:0 auto}
.party-preview-members{display:flex;gap:10px;justify-content:center;flex-wrap:wrap;margin-bottom:4px}
.party-preview-member{display:flex;align-items:center;gap:6px;background:#16213e;border:1px solid #ffd700;border-radius:8px;padding:6px 10px;min-width:100px}
.party-preview-member .pp-icon{font-size:1.4em}
.party-preview-member .pp-info{font-size:.75em;line-height:1.3}
.party-preview-member .pp-name{color:#fff;font-weight:bold}
.party-preview-member .pp-class{color:#aaa}
.party-preview-empty{width:100px;height:48px;border:1px dashed #555;border-radius:8px;display:flex;align-items:center;justify-content:center;color:#555;font-size:.8em}
.party-hint{text-align:center;font-size:.72em;color:#f783ac;margin-top:4px;min-height:1.2em}

.btn{display:block;margin:10px auto;padding:12px 40px;font-family:inherit;font-size:1.1em;background:#ffd700;color:#1a1a2e;border:none;border-radius:6px;cursor:pointer;font-weight:bold;transition:.2s;touch-action:manipulation;-webkit-tap-highlight-color:transparent}
.btn:hover{background:#ffed4a;transform:scale(1.05)}
.btn:disabled{opacity:.4;cursor:default;transform:none}

/* === ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ç”»é¢ === */
.dungeon-sticky{position:sticky;top:0;z-index:30;background:#1a1a2e;padding:6px 0 8px;border-bottom:2px solid #333}
.dungeon-header{display:flex;justify-content:space-between;align-items:center;padding:4px 0}
.floor-display{font-size:1.8em;color:#ffd700;font-weight:bold;text-shadow:0 0 12px #ffd70055;letter-spacing:2px}
.party-hp{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:6px;margin-top:8px}
.hp-bar-wrap{background:#16213e;border:1px solid #333;border-radius:6px;padding:7px 10px;transition:opacity .3s, filter .3s}
.hp-bar-wrap.dead{opacity:.4;filter:grayscale(1)}
.hp-name{font-size:.8em;margin-bottom:3px;display:flex;justify-content:space-between;align-items:center}
.hp-name .char-info-left{display:flex;align-items:center;gap:4px}
.hp-name .status-icons{font-size:.9em}
.hp-bar-bg{background:#333;height:10px;border-radius:4px;overflow:hidden}
.hp-bar{height:100%;background:#4caf50;transition:width .4s ease;border-radius:4px}
.hp-bar.low{background:linear-gradient(90deg,#ff5722,#ff8a65)}
.hp-bar.mid{background:linear-gradient(90deg,#ff9800,#ffcc02)}

/* ãƒ­ã‚°ã‚¨ãƒªã‚¢ï¼ˆæŠ˜ã‚ŠãŸãŸã¿å¼ï¼‰ */
.log-wrapper{position:relative;margin:0 12px}
.log-toggle{display:flex;align-items:center;justify-content:space-between;background:#16213e;border:1px solid #333;border-radius:8px 8px 0 0;padding:6px 14px;cursor:pointer;user-select:none;color:#888;font-size:.78em;transition:.2s}
.log-toggle:hover{background:#1a2a4e;color:#aaa}
.log-toggle .toggle-arrow{transition:transform .3s;font-size:1.2em}
.log-toggle .toggle-arrow.collapsed{transform:rotate(180deg)}
.log-area{background:#0d1117;border:1px solid #333;border-top:none;border-radius:0 0 8px 8px;padding:10px;height:150px;overflow-y:auto;font-size:.78em;line-height:1.6;scroll-behavior:smooth;transition:height .3s ease,padding .3s ease,opacity .3s ease}
.log-area.collapsed{height:0;padding:0 10px;opacity:0;overflow:hidden}
.log-line{animation:fadeIn .3s;padding:2px 4px;border-radius:4px;margin:1px 0}
.log-line.battle{color:#ff6b6b}
.log-line.heal{color:#69db7c}
.log-line.trap{color:#ffa94d}
.log-line.rest{color:#74c0fc}
.log-line.love{color:#f783ac;background:#f783ac11;padding:4px 8px;border-left:3px solid #f783ac}
.log-line.synergy{color:#ffd700}
.log-line.floor{color:#fff;font-weight:bold;font-size:1.1em;background:linear-gradient(90deg,#1a2a4e,#16213e,#1a2a4e);padding:8px 12px;margin:10px -4px 6px;border-radius:6px;text-align:center;letter-spacing:2px;border:1px solid #334}
.log-line.death{color:#ff3333;font-weight:bold;background:#ff000015;padding:4px 8px;border-left:3px solid #ff3333}
.log-line.system{color:#aaa}
.log-line.talk{color:#7ecfcf;background:#7ecfcf0a;padding:4px 10px;margin:2px 0;border-radius:8px;border:1px solid #7ecfcf15;position:relative}
.log-line.talk-bubble{background:#1a2e3e;border:1px solid #2a4e5e;border-radius:12px;padding:6px 12px;margin:3px 0 3px 16px;color:#a0dede;position:relative}

/* === ã‚²ãƒ¼ãƒ ã‚¹ãƒ†ãƒ¼ã‚¸ï¼ˆã‚¢ã‚¯ã‚·ãƒ§ãƒ³é¢¨ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼‰ === */
.adventure-field{
  position:relative;
  width:100%;
  height:60vh;
  min-height:420px;
  background:linear-gradient(180deg,#0a0a1a 0%,#0d1020 25%,#1a1a2e 50%,#1e2a3a 80%,#2a1e1a 100%);
  border:2px solid #4a5568;
  border-radius:15px;
  margin:10px 12px;
  overflow:hidden;
}
/* åœ°é¢ */
.stage-ground{
  position:absolute;
  bottom:0;left:0;right:0;
  height:25%;
  background:linear-gradient(180deg,transparent,rgba(40,30,20,0.5) 30%,rgba(50,35,20,0.7));
  border-top:1px solid rgba(100,80,60,0.25);
  z-index:1;
}
.stage-ground::before{
  content:'';position:absolute;inset:0;
  background:repeating-linear-gradient(90deg,transparent,transparent 60px,rgba(80,60,40,0.08) 60px,rgba(80,60,40,0.08) 61px);
}
/* èƒŒæ™¯ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«ï¼ˆç§»å‹•æ„Ÿï¼‰ */
.stage-particles{position:absolute;inset:0;pointer-events:none;overflow:hidden;z-index:0}
.stage-particle{
  position:absolute;
  width:2px;height:2px;
  background:rgba(200,200,255,0.15);
  border-radius:50%;
  animation:particleDrift linear infinite;
}
@keyframes particleDrift{
  from{transform:translateX(0)}
  to{transform:translateX(-120vw)}
}

/* ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚¹ãƒ—ãƒ©ã‚¤ãƒˆ */
.stage-char{
  position:absolute;
  display:flex;flex-direction:column;align-items:center;
  z-index:10;
  pointer-events:none;
  will-change:transform;
  transition:none;
}
.stage-char.dead-char{opacity:0.3;filter:grayscale(0.8)}
.char-shadow{
  position:absolute;bottom:-4px;
  width:40px;height:10px;
  background:radial-gradient(ellipse,rgba(0,0,0,0.45) 0%,transparent 70%);
  z-index:-1;
}
.character-sprite{
  width:52px;height:52px;
  border-radius:50%;
  display:flex;align-items:center;justify-content:center;
  font-size:1.9em;
  background:linear-gradient(135deg,#2d3748,#4a5568);
  border:2px solid #5588ff;
  position:relative;
  box-shadow:0 3px 10px rgba(0,0,0,0.4);
  will-change:transform;
}
.character-sprite.dead{opacity:0.3;filter:grayscale(1);border-color:#666}
.char-hp-bar{
  width:48px;height:6px;
  background:#222;border-radius:3px;
  overflow:hidden;border:1px solid #444;
  position:relative;margin-top:2px;
}
.hp-fill{height:100%;background:linear-gradient(90deg,#4caf50,#8bc34a);transition:width 0.5s ease;border-radius:2px}
.hp-fill.low{background:linear-gradient(90deg,#f44336,#ff9800)}
.hp-fill.mid{background:linear-gradient(90deg,#ff9800,#ffc107)}
.hp-text{position:absolute;top:0;left:50%;transform:translateX(-50%);font-size:0.55em;color:#fff;text-shadow:1px 1px 2px rgba(0,0,0,0.9);line-height:6px}
.char-status{text-align:center;position:relative;width:100%}
.char-name-mini{font-size:0.6em;color:#e2e8f0;font-weight:bold;margin-top:1px;text-shadow:1px 1px 3px rgba(0,0,0,0.8);white-space:nowrap}
.damage-numbers{position:absolute;top:-25px;left:50%;transform:translateX(-50%);pointer-events:none}
.damage-popup{position:absolute;font-weight:bold;font-size:1.2em;animation:damageFloat 1.5s ease-out forwards;text-shadow:2px 2px 4px rgba(0,0,0,0.9)}
.damage-popup.damage{color:#ff4444}
.damage-popup.heal{color:#44ff44}
.damage-popup.miss{color:#888;font-size:0.9em}

/* æ•µã‚¹ãƒ—ãƒ©ã‚¤ãƒˆ */
.stage-enemy{
  position:absolute;
  display:flex;flex-direction:column;align-items:center;
  z-index:10;will-change:transform;
  pointer-events:none;
}
.enemy-shadow{
  position:absolute;bottom:-6px;
  width:70px;height:16px;
  background:radial-gradient(ellipse,rgba(0,0,0,0.5) 0%,transparent 70%);
  z-index:-1;
}
.enemy-sprite{
  width:80px;height:80px;
  border-radius:50%;
  display:flex;align-items:center;justify-content:center;
  font-size:2.6em;
  background:linear-gradient(135deg,#744210,#975a16);
  border:3px solid #ff6b6b;
  position:relative;
  box-shadow:0 4px 15px rgba(255,107,107,0.3);
  will-change:transform;
}
.enemy-status{text-align:center;position:relative;width:100%}
.enemy-name-mini{font-size:0.7em;color:#ff8a65;font-weight:bold;margin-top:3px;text-shadow:1px 1px 2px rgba(0,0,0,0.8)}
.enemy-hp-bar{width:90px;height:8px;background:#333;border-radius:4px;overflow:hidden;border:1px solid #666;margin-top:3px;position:relative}
.enemy-hp-fill{height:100%;background:linear-gradient(90deg,#ff6b6b,#ff8a65);transition:width 0.5s ease;border-radius:3px}
.enemy-hp-text{position:absolute;top:0;left:50%;transform:translateX(-50%);font-size:0.6em;color:#fff;text-shadow:1px 1px 2px rgba(0,0,0,0.8);line-height:8px}

/* ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãƒ¬ã‚¤ãƒ¤ãƒ¼ */
.effects-layer{position:absolute;inset:0;pointer-events:none;z-index:15}
.fx-projectile{
  position:absolute;
  animation:fxFly 0.4s ease-in forwards;
  font-size:1.4em;
  filter:drop-shadow(0 0 6px rgba(255,200,50,0.6));
  z-index:16;
}
@keyframes fxFly{
  0%{opacity:1;transform:scale(1)}
  100%{opacity:0.5;transform:scale(1.2)}
}
.fx-slash{
  position:absolute;width:60px;height:60px;
  background:radial-gradient(ellipse,rgba(255,255,200,0.4) 0%,transparent 70%);
  border-radius:50%;
  animation:fxSlash 0.3s ease-out forwards;
  z-index:16;
}
@keyframes fxSlash{0%{transform:scale(0.5);opacity:1}100%{transform:scale(1.5);opacity:0}}
.fx-heal{
  position:absolute;width:50px;height:50px;
  background:radial-gradient(ellipse,rgba(100,255,100,0.3) 0%,transparent 70%);
  border-radius:50%;
  animation:fxHeal 0.8s ease-out forwards;
  z-index:16;
}
@keyframes fxHeal{0%{transform:scale(0.5) translateY(0);opacity:1}100%{transform:scale(1.5) translateY(-20px);opacity:0}}
/* ç„šãç« */
.fx-campfire{
  position:absolute;font-size:2em;
  animation:campflicker 1s ease-in-out infinite alternate;
  z-index:8;filter:drop-shadow(0 0 15px rgba(255,150,50,0.5));
}
@keyframes campflicker{0%{transform:scale(1);filter:drop-shadow(0 0 15px rgba(255,150,50,0.5))}100%{transform:scale(1.1);filter:drop-shadow(0 0 20px rgba(255,100,30,0.7))}}

/* ã‚¹ãƒ†ãƒ¼ã‚¸ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ï¼ˆUIæƒ…å ±ï¼‰ */
.stage-overlay{
  position:absolute;inset:0;
  pointer-events:none;z-index:20;
  display:flex;flex-direction:column;
}
.stage-top-bar{
  display:flex;justify-content:space-between;align-items:flex-start;
  padding:10px 14px;
}
.floor-info{
  background:rgba(10,10,26,0.85);
  border:2px solid #ffd700;
  border-radius:8px;
  padding:4px 14px;
  backdrop-filter:blur(4px);
}
.floor-number{font-size:1.2em;color:#ffd700;font-weight:bold;text-shadow:0 0 8px #ffd70055}
.event-status{font-size:0.7em;color:#aaa;text-align:center}
.env-info-mini{
  background:rgba(10,10,26,0.7);
  border:1px solid #334;border-radius:6px;
  padding:4px 10px;font-size:0.7em;color:#b8b8d0;
  backdrop-filter:blur(4px);
}
.env-description{font-style:italic;line-height:1.3}
.stage-center-event{
  align-self:center;
  background:rgba(10,10,30,0.85);
  border:1px solid #4a5568;border-radius:10px;
  padding:8px 20px;color:#e2e8f0;
  font-size:0.9em;margin-top:4px;
  backdrop-filter:blur(4px);
  animation:fieldMsgIn 0.4s ease;
}

/* ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãƒ•ã‚£ãƒ¼ãƒ‰ */
.field-dialogue-feed{
  position:absolute;bottom:8px;left:8px;right:8px;
  max-height:35%;overflow-y:auto;
  display:flex;flex-direction:column;gap:4px;
  padding:4px;scroll-behavior:smooth;
  pointer-events:auto;
  mask-image:linear-gradient(to bottom,transparent 0%,black 20%,black 100%);
  -webkit-mask-image:linear-gradient(to bottom,transparent 0%,black 20%,black 100%);
}
.field-msg{
  animation:fieldMsgIn .4s ease;
  padding:5px 10px;border-radius:8px;
  font-size:.78em;line-height:1.3;
  text-align:left;word-break:break-word;
  backdrop-filter:blur(6px);
}
.field-msg.event{background:rgba(13,17,23,0.75);border:1px solid #21262d;color:#b8b8d0;text-align:center}
.field-msg.battle-msg{background:rgba(255,107,107,0.15);border:1px solid rgba(255,107,107,0.25);color:#ff8a8a}
.field-msg.heal-msg{background:rgba(105,219,124,0.15);border:1px solid rgba(105,219,124,0.25);color:#69db7c}
.field-msg.trap-msg{background:rgba(255,169,77,0.15);border:1px solid rgba(255,169,77,0.25);color:#ffa94d}
.field-msg.rest-msg{background:rgba(116,192,252,0.15);border:1px solid rgba(116,192,252,0.25);color:#74c0fc}
.field-msg.treasure-msg{background:rgba(255,215,0,0.15);border:1px solid rgba(255,215,0,0.25);color:#ffd700}
.field-msg.love-msg{background:rgba(247,131,172,0.15);border:1px solid rgba(247,131,172,0.25);color:#f783ac}
.field-msg.system-msg{background:rgba(100,100,120,0.15);border:1px solid rgba(100,100,120,0.2);color:#aaa;font-size:.72em}
.field-msg.floor-msg{background:linear-gradient(90deg,rgba(26,42,78,0.85),rgba(22,33,62,0.85));border:1px solid #334;color:#fff;font-weight:bold;font-size:.85em;text-align:center;letter-spacing:1px;padding:6px}
.field-msg.death-msg{background:rgba(255,51,51,0.15);border:1px solid rgba(255,51,51,0.25);color:#ff3333;font-weight:bold}

/* ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å†…ã‚»ãƒªãƒ•å¹ãå‡ºã— */
.field-dialogue{
  display:flex;align-items:flex-start;gap:6px;
  padding:4px 6px;animation:fieldMsgIn .4s ease;
}
.field-dialogue .speaker-icon{
  width:28px;height:28px;border-radius:50%;
  background:linear-gradient(135deg,#2d3748,#4a5568);
  border:2px solid #5588ff;
  display:flex;align-items:center;justify-content:center;
  font-size:1em;flex-shrink:0;
}
.field-dialogue .dialogue-content{
  background:rgba(26,46,62,0.85);border:1px solid #2a4e5e;
  border-radius:0 10px 10px 10px;padding:4px 10px;
  color:#a0dede;font-size:.78em;line-height:1.3;
  backdrop-filter:blur(6px);max-width:calc(100% - 38px);
}
.field-dialogue .speaker-name{font-size:.65em;color:#7ecfcf;font-weight:bold;margin-bottom:1px}
@keyframes fieldMsgIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}

/* ç’°å¢ƒã‚¨ãƒ•ã‚§ã‚¯ãƒˆ */
.env-effect{position:absolute;inset:0;pointer-events:none;border-radius:15px;transition:opacity 0.8s ease;opacity:0;z-index:2}
.env-effect.active{opacity:1}
.env-effect.battle-env{background:radial-gradient(ellipse at center,rgba(255,50,50,0.08) 0%,transparent 70%);border-color:#ff6b6b44}
.env-effect.trap-env{background:radial-gradient(ellipse at center,rgba(255,169,77,0.1) 0%,transparent 70%)}
.env-effect.rest-env{background:radial-gradient(ellipse at center,rgba(100,200,255,0.08) 0%,transparent 70%)}
.env-effect.treasure-env{background:radial-gradient(ellipse at center,rgba(255,215,0,0.1) 0%,transparent 70%)}

/* ãƒ€ãƒ¡ãƒ¼ã‚¸ãƒ»ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
@keyframes damageFloat{0%{opacity:1;transform:translateX(-50%) translateY(0) scale(1)}20%{transform:translateX(-50%) translateY(-12px) scale(1.3)}100%{opacity:0;transform:translateX(-50%) translateY(-45px) scale(0.8)}}
@keyframes flash{0%,100%{filter:brightness(1)}50%{filter:brightness(2.5) saturate(0) contrast(2)}}
.hit-flash{animation:flash 0.3s ease-in-out}
@keyframes shake{0%,100%{transform:translateX(0)}10%,30%,50%,70%,90%{transform:translateX(-3px)}20%,40%,60%,80%{transform:translateX(3px)}}
@keyframes enemyBreathe{0%,100%{transform:scale(1)}50%{transform:scale(1.04)}}
.speech-bubble{display:none}
.event-messages{display:none}
.log-line.talk-bubble::before{content:'';position:absolute;left:-8px;top:10px;width:0;height:0;border-top:5px solid transparent;border-bottom:5px solid transparent;border-right:8px solid #2a4e5e}
@keyframes fadeIn{from{opacity:0;transform:translateY(4px)}to{opacity:1;transform:translateY(0)}}

/* çµæœç”»é¢ */
.result-box{background:#16213e;border:2px solid #ffd700;border-radius:12px;padding:24px;margin:20px auto;max-width:500px;text-align:center}
.result-floor{font-size:3em;color:#ffd700;margin:10px 0}
.result-detail{text-align:left;font-size:.85em;line-height:1.8;margin:16px 0;color:#ccc}
.result-detail span{color:#ffd700}
.death-summary{background:#1a1a2e;border-radius:6px;padding:12px;margin:12px 0;text-align:left;font-size:.82em;line-height:1.7}
.death-summary .death{color:#ff6b6b}
.death-summary .love{color:#f783ac}
.speed-control{text-align:center;margin:8px 0}
.speed-control button{font-family:inherit;background:#333;color:#ccc;border:1px solid #555;padding:4px 12px;margin:0 2px;border-radius:4px;cursor:pointer;font-size:.8em}
.speed-control button.active{background:#ffd700;color:#1a1a2e;border-color:#ffd700}

/* === ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ– === */
@media(max-width:600px){
  .char-grid{grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:8px}
  .char-card{padding:10px 8px 8px}
  .char-quote{font-size:.62em}
  .floor-display{font-size:1.4em}
  .party-hp{grid-template-columns:1fr 1fr}
  .hp-bar-wrap{padding:5px 7px}
  .log-area{height:120px;font-size:.75em;padding:8px}
  .party-preview-members{gap:6px}
  .party-preview-member{min-width:80px;padding:4px 8px}
  .card-detail{padding:14px;max-width:95vw}
  .screen{padding:8px}
  h1{font-size:1.3em}
}
@media(max-width:768px){
  .adventure-field{margin:5px;min-height:45vh;height:50vh}
  .character-sprite{width:42px;height:42px;font-size:1.5em}
  .enemy-sprite{width:65px;height:65px;font-size:2.2em}
  .field-dialogue-feed{max-height:30%}
  .stage-center-event{font-size:0.8em;padding:6px 14px}
}
@media(max-width:480px){
  .char-grid{grid-template-columns:1fr 1fr;gap:6px}
  .party-hp{grid-template-columns:1fr}
  .adventure-field{height:45vh;min-height:350px}
  .character-sprite{width:36px;height:36px;font-size:1.3em}
  .char-hp-bar{width:38px;height:5px}
  .char-name-mini{font-size:0.5em}
  .enemy-sprite{width:55px;height:55px;font-size:1.8em}
  .enemy-hp-bar{width:70px}
  .field-dialogue-feed{max-height:25%}
}
</style>
</head>
<body>

<!-- é¸æŠç”»é¢ -->
<div class="screen active" id="select-screen">
<h1>âš”ï¸ æ·±æ·µã®ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³</h1>
<h2>ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã‚’ç·¨æˆã›ã‚ˆï¼ˆ4äººé¸æŠï¼‰</h2>
<div class="subtitle">ç›¸æ€§ã®è‰¯ã„çµ„ã¿åˆã‚ã›ã‚’è¦‹ã¤ã‘ã¦ã€ã‚ˆã‚Šæ·±ã„éšå±¤ã‚’ç›®æŒ‡ãã†</div>
<div class="party-info" id="party-info">0 / 4 äººé¸æŠä¸­</div>
<div class="char-grid" id="char-grid"></div>
<div style="height:140px"></div>
</div>
<!-- ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆå›ºå®šä¸‹éƒ¨ï¼‰ï¼‹å‡ºç™ºãƒœã‚¿ãƒ³ -->
<div class="party-preview" id="party-preview">
<div class="party-preview-inner">
<div class="party-preview-members" id="party-preview-members"></div>
<div class="party-hint" id="party-hint"></div>
<button class="btn" id="start-btn" disabled onclick="startDungeon()" style="margin:8px auto 0;padding:10px 36px;font-size:1em">âš”ï¸ å‡ºç™ºï¼</button>
</div>
</div>
<!-- ã‚­ãƒ£ãƒ©è©³ç´°ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ— -->
<div class="card-detail-overlay" id="card-detail-overlay">
<div class="card-detail" id="card-detail">
<button class="close-btn" onclick="closeDetail()">&times;</button>
<div id="card-detail-content"></div>
</div>
</div>

<!-- ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ç”»é¢ -->
<div class="screen" id="dungeon-screen">
<div class="dungeon-sticky">
<div class="dungeon-header">
<div class="floor-display" id="floor-display">B1F</div>
<div class="speed-control">
<button onclick="setSpeed(0)" id="spd0">â–¶</button>
<button onclick="setSpeed(1)" id="spd1" class="active">â–¶â–¶</button>
<button onclick="setSpeed(2)" id="spd2">â–¶â–¶â–¶</button>
</div>
</div>
<div class="party-hp" id="party-hp"></div>
</div>

<!-- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚²ãƒ¼ãƒ é¢¨ã‚¹ãƒ†ãƒ¼ã‚¸ -->
<div class="adventure-field" id="adventureField">
  <!-- åœ°é¢ -->
  <div class="stage-ground"></div>
  <!-- èƒŒæ™¯ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ« -->
  <div class="stage-particles" id="stageParticles"></div>

  <!-- ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚¹ãƒ—ãƒ©ã‚¤ãƒˆ -->
  <div class="stage-char" data-index="0" id="stageChar0">
    <div class="char-shadow"></div>
    <div class="character-sprite" id="char0"></div>
    <div class="char-status">
      <div class="char-name-mini"></div>
      <div class="char-hp-bar"><div class="hp-fill" id="charHp0"></div><div class="hp-text" id="charHpText0"></div></div>
      <div class="damage-numbers"></div>
    </div>
  </div>
  <div class="stage-char" data-index="1" id="stageChar1">
    <div class="char-shadow"></div>
    <div class="character-sprite" id="char1"></div>
    <div class="char-status">
      <div class="char-name-mini"></div>
      <div class="char-hp-bar"><div class="hp-fill" id="charHp1"></div><div class="hp-text" id="charHpText1"></div></div>
      <div class="damage-numbers"></div>
    </div>
  </div>
  <div class="stage-char" data-index="2" id="stageChar2">
    <div class="char-shadow"></div>
    <div class="character-sprite" id="char2"></div>
    <div class="char-status">
      <div class="char-name-mini"></div>
      <div class="char-hp-bar"><div class="hp-fill" id="charHp2"></div><div class="hp-text" id="charHpText2"></div></div>
      <div class="damage-numbers"></div>
    </div>
  </div>
  <div class="stage-char" data-index="3" id="stageChar3">
    <div class="char-shadow"></div>
    <div class="character-sprite" id="char3"></div>
    <div class="char-status">
      <div class="char-name-mini"></div>
      <div class="char-hp-bar"><div class="hp-fill" id="charHp3"></div><div class="hp-text" id="charHpText3"></div></div>
      <div class="damage-numbers"></div>
    </div>
  </div>

  <!-- æ•µã‚¹ãƒ—ãƒ©ã‚¤ãƒˆ -->
  <div class="stage-enemy" id="stageEnemy" style="display:none;">
    <div class="enemy-shadow"></div>
    <div class="enemy-sprite" id="currentEnemy"></div>
    <div class="enemy-status">
      <div class="enemy-name-mini" id="enemyName"></div>
      <div class="enemy-hp-bar"><div class="enemy-hp-fill" id="enemyHpFill"></div><div class="enemy-hp-text" id="enemyHpText"></div></div>
      <div class="damage-numbers"></div>
    </div>
  </div>

  <!-- ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãƒ¬ã‚¤ãƒ¤ãƒ¼ -->
  <div class="effects-layer" id="effectsLayer"></div>
  <!-- ç’°å¢ƒã‚¨ãƒ•ã‚§ã‚¯ãƒˆ -->
  <div class="env-effect" id="envEffect"></div>

  <!-- ã‚¹ãƒ†ãƒ¼ã‚¸UI ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ -->
  <div class="stage-overlay">
    <div class="stage-top-bar">
      <div class="floor-info">
        <div class="floor-number" id="fieldFloorDisplay">B1F</div>
        <div class="event-status" id="eventStatus">æ¢ç´¢ä¸­...</div>
      </div>
      <div class="env-info-mini" id="envInfo">
        <span class="env-description">å†·ãŸã„çŸ³ã®å£ã«å›²ã¾ã‚ŒãŸé€šè·¯</span>
      </div>
    </div>
    <div class="stage-center-event" id="actionDesc" style="display:none;">ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ã‚’æ¢ç´¢ã—ã¦ã„ã‚‹</div>
    <div class="field-dialogue-feed" id="fieldDialogueFeed"></div>
  </div>
</div>

<div class="log-wrapper">
<div class="log-toggle" id="logToggle" onclick="toggleLog()">
  <span>ğŸ“œ ãƒ†ã‚­ã‚¹ãƒˆãƒ­ã‚°</span>
  <span class="toggle-arrow collapsed" id="toggleArrow">â–²</span>
</div>
<div class="log-area collapsed" id="log-area"></div>
</div>
</div>

<!-- çµæœç”»é¢ -->
<div class="screen" id="result-screen">
<h1>ğŸ° æ¢ç´¢çµ‚äº†</h1>
<div class="result-box" id="result-box"></div>
<button class="btn" onclick="backToSelect()">ğŸ”„ ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦</button>
</div>

<script>
// ===== ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ =====
const CLASSES = [
  {id:'knight',name:'é¨å£«',icon:'ğŸ›¡ï¸',hp:180,atk:30,def:25,spd:8,desc:'é«˜HPãƒ»é«˜é˜²å¾¡ã®å£å½¹'},
  {id:'mage',name:'é­”è¡“å¸«',icon:'ğŸ”®',hp:80,atk:55,def:8,spd:15,desc:'é«˜ç«åŠ›ãƒ»ç´™è€ä¹…'},
  {id:'healer',name:'ãƒ’ãƒ¼ãƒ©ãƒ¼',icon:'ğŸ’š',hp:100,atk:15,def:12,spd:12,desc:'å›å¾©ã®ã‚¹ãƒšã‚·ãƒ£ãƒªã‚¹ãƒˆ'},
  {id:'thief',name:'ç›—è³Š',icon:'ğŸ—¡ï¸',hp:110,atk:35,def:10,spd:25,desc:'ç´ æ—©ã•ã¨ç½ è§£é™¤'},
  {id:'archer',name:'å¼“ä½¿ã„',icon:'ğŸ¹',hp:120,atk:40,def:14,spd:18,desc:'ãƒãƒ©ãƒ³ã‚¹ã®è‰¯ã„å°„æ‰‹'},
  {id:'priest',name:'åƒ§ä¾¶',icon:'ğŸ“¿',hp:95,atk:20,def:15,spd:10,desc:'ãƒãƒ•ãƒ»ãƒ‡ãƒãƒ•ã®é”äºº'},
];

const NAMES = {
  knight: {m:'ã‚¬ãƒ¬ã‚¹', f:'ã‚¢ãƒ‡ãƒ©ã‚¤ãƒ³'},
  mage:   {m:'ã‚¼ãƒãƒ³', f:'ãƒ«ã‚·ã‚¨ãƒ©'},
  healer: {m:'ã‚¨ãƒ«ãƒãƒ¼', f:'ãƒ•ã‚£ã‚ªãƒŠ'},
  thief:  {m:'ã‚«ã‚¤ãƒˆ', f:'ã‚·ãƒ£ãƒ¼ãƒªã‚£'},
  archer: {m:'ãƒ­ã‚¤ãƒ‰', f:'ã‚¨ãƒ¬ãƒŠ'},
  priest: {m:'ã‚»ãƒ‰ãƒªãƒƒã‚¯', f:'ãƒªãƒªã‚¢ãƒ¼ãƒ'},
};

const GENDERS = [{id:'m',label:'â™‚'},{id:'f',label:'â™€'}];

// ===== æ€§æ ¼è¨­å®š =====
const PERSONALITIES = {
  knight_m: {
    name:'ã‚¬ãƒ¬ã‚¹', trait:'ç”ŸçœŸé¢ç›®ãƒ»æ­£ç¾©æ„Ÿ', traitShort:'ç”ŸçœŸé¢ç›®ãªæ­£ç¾©æ¼¢', quote:'å®ˆã‚‹ã¹ãã‚‚ã®ãŒã‚ã‚‹é™ã‚Šã€å€’ã‚Œã¯ã—ãªã„ï¼', tone:'å …ã„å£èª¿',
    backstory:'é¨å£«å›£ã®æ¬¡ç”·åŠã€‚å…„ã®æˆ¦æ­»å¾Œã€ãã®æ„å¿—ã‚’ç¶™ã„ã§å‰ç·šã«ç«‹ã¤ã€‚',
    battleCry:['ä¿ºãŒå‰ã«å‡ºã‚‹ï¼','å®ˆã‚‹ã¹ãã‚‚ã®ãŒã‚ã‚‹é™ã‚Šã€å€’ã‚Œã¯ã—ãªã„ï¼','ã“ã®ç›¾ãŒã‚ã‚‹é™ã‚Šã€ä»²é–“ã«ã¯æŒ‡ä¸€æœ¬è§¦ã‚Œã•ã›ã‚“ï¼','å…¨å“¡ä¿ºã®å¾Œã‚ã«ä¸‹ãŒã‚Œï¼'],
    battleWin:['ä»»å‹™å®Œäº†ã ','çš†ã€ã‚ˆãã‚„ã£ãŸ','ã¾ã å…ˆã¯é•·ã„ã€‚æ°—ã‚’å¼•ãç· ã‚ã‚'],
    battleHurt:['ãã£...ã“ã®ç¨‹åº¦...ï¼','ã¾ã ã ...ã¾ã ç«‹ã¦ã‚‹ï¼','ç—›ã¿ãªã©ã€è¦šæ‚Ÿã®ä¸Šã '],
    restLine:['å°‘ã—ä¼‘ã‚€ãã€‚äº¤ä»£ã§è¦‹å¼µã‚Šã‚’é ¼ã‚€','...æ•…éƒ·ã®å¤•æ—¥ã‚’æ€ã„å‡ºã™ãª','å‰£ã®æ‰‹å…¥ã‚Œã§ã‚‚ã™ã‚‹ã‹'],
    trapLine:['å…¨å“¡æ­¢ã¾ã‚Œï¼è¶³å…ƒã‚’ç¢ºèªã—ã‚ï¼','ç½ ã‹...æ…é‡ã«é€²ã‚€ã'],
  },
  knight_f: {
    name:'ã‚¢ãƒ‡ãƒ©ã‚¤ãƒ³', trait:'å…ƒãŠå¬¢æ§˜ãƒ»ä¸Šå“ã ãŒèŠ¯ãŒå¼·ã„', traitShort:'æ°—é«˜ããŠå¬¢æ§˜é¨å£«', quote:'ãŠè¦šæ‚Ÿã¯ã‚ˆã‚ã—ãã¦ï¼Ÿ', tone:'ã§ã™ã‚å£èª¿',
    backstory:'åå®¶ã®ä»¤å¬¢ã ã£ãŸãŒã€è­·è¡›é¨å£«ã«æ†§ã‚Œå®¶ã‚’é£›ã³å‡ºã—ãŸã€‚',
    battleCry:['é€€ããªã•ã„ã€‚ã“ã®å‰£ã®éŒ†ã«ã—ã¦ã‚ã’ã¾ã™ã‚','ã‚ãŸãã—ã®å‰ã«ç«‹ã¤ã¨ã¯ã€ã„ã„åº¦èƒ¸ã§ã™ã“ã¨','ãŠè¦šæ‚Ÿã¯ã‚ˆã‚ã—ãã¦ï¼Ÿ','ãƒ¬ãƒ‡ã‚£ã«å‰£ã‚’æŠœã‹ã›ã‚‹ãªã‚“ã¦ã€ä¸‡æ­»ã«å€¤ã—ã¾ã™ã‚'],
    battleWin:['æ±—ã‚’ã‹ã„ã¦ã—ã¾ã„ã¾ã—ãŸã‚...','ãŠç‰‡ä»˜ã‘å®Œäº†ã§ã™ã‚ã­','æ€ã£ãŸã‚ˆã‚Šéª¨ãŒã‚ã‚Šã¾ã—ãŸã‚'],
    battleHurt:['ãã‚ƒã£...ï¼ã“ã€ã“ã®ç¨‹åº¦...ï¼','ãƒ‰ãƒ¬ã‚¹ãŒ...ã„ãˆã€é§ãŒå‚·ã¤ãã¾ã—ãŸã‚ï¼','ç—›ã„...ã§ã™ã‘ã©ã€æ³£ãã¾ã›ã‚“ã‚ã‚ˆ'],
    restLine:['ç´…èŒ¶ãŒæ‹ã—ã„ã§ã™ã‚...','æ˜ŸãŒè¦‹ãˆãªã„ã®ãŒæ®‹å¿µã§ã™ã‚ã­','æ•…éƒ·ã®ãƒãƒ©åœ’ã‚’æ€ã„å‡ºã—ã¾ã™ã‚'],
    trapLine:['ã¾ã‚ã€ãªã‚“ã¦é‡è›®ãªä»•æ›ã‘ã§ã™ã“ã¨','ãŠæ°—ã‚’ã¤ã‘ã¦ã€‚è¶³å…ƒãŒæ€ªã—ã„ã§ã™ã‚'],
  },
  mage_m: {
    name:'ã‚¼ãƒãƒ³', trait:'çŸ¥è­˜æ¬²ã®å¡Šãƒ»å†·ã‚ã¦ã¦çš®è‚‰å±‹', traitShort:'å†·å¾¹ãªçŸ¥è­˜ã®æ¢æ±‚è€…', quote:'çŸ¥è­˜ã“ããŒæœ€å¼·ã®æ­¦å™¨ã ', tone:'ç†çŸ¥çš„ãƒ»çš®è‚‰',
    backstory:'é­”è¡“å­¦é™¢ã‚’ä¸»å¸­å’æ¥­ã€‚å®Ÿåœ°ãƒ‡ãƒ¼ã‚¿åé›†ã®ãŸã‚ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ã«æ½œã‚‹ã€‚',
    battleCry:['ãµã‚€ã€èˆˆå‘³æ·±ã„åå¿œã ','ãƒ‡ãƒ¼ã‚¿ãŒè¶³ã‚Šãªã„ãª...ã‚µãƒ³ãƒ—ãƒ«ã«ãªã£ã¦ã‚‚ã‚‰ãŠã†','ç†è«–é€šã‚Šã«ã„ãã‹ã€æ¤œè¨¼ã•ã›ã¦ã‚‚ã‚‰ã†','é­”åŠ›æ¼”ç®—...å®Œäº†ã€‚æ’ƒã¤ã'],
    battleWin:['æƒ³å®šå†…ã ','ãƒ‡ãƒ¼ã‚¿ã¯å–ã‚ŒãŸã€‚æ¬¡ã«è¡Œã“ã†','ä»®èª¬ã¯æ­£ã—ã‹ã£ãŸã‚ˆã†ã '],
    battleHurt:['ã...è¨ˆç®—å¤–ã ','ç—›è¦šã®ãƒ‡ãƒ¼ã‚¿ãªã©ä¸è¦ãªã‚“ã ãŒ','ãªã‚‹ã»ã©ã€ã“ã®å¨åŠ›ã‹...ãƒ¡ãƒ¢ã—ã¦ãŠã“ã†'],
    restLine:['å°‘ã—è«–æ–‡ã‚’æ›¸ãæ™‚é–“ãŒæ¬²ã—ã„ãª','ã“ã®å£ã®ç´‹æ§˜...å¤ä»£æ–‡å­—ã‹ï¼Ÿèˆˆå‘³æ·±ã„','çŸ¥è­˜ã“ããŒæœ€å¼·ã®æ­¦å™¨ã '],
    trapLine:['ãµã‚€ã€ã“ã®ç½ ã®æ©Ÿæ§‹ã¯...ã„ã‚„ã€ä»Šã¯è§£é™¤ãŒå…ˆã‹','è«–ç†çš„ã«è€ƒãˆã‚Œã°å›é¿ã¯å¯èƒ½ã '],
  },
  mage_f: {
    name:'ãƒ«ã‚·ã‚¨ãƒ©', trait:'å¤©æ‰è‚Œãƒ»å¤©ç„¶ãƒœã‚±', traitShort:'å¤©æ‰è‚Œã®å¤©ç„¶ãƒœã‚±', quote:'ãƒ‰ã‚«ãƒ¼ãƒ³ã§ã„ã„ã‹ï¼', tone:'ãµã‚ãµã‚ãƒ»ãƒã‚¤ãƒšãƒ¼ã‚¹',
    backstory:'é­”æ³•ã®åé–€å®¶ç³»ã ãŒæœ¬äººã¯ç„¡è‡ªè¦šãªå¤©æ‰ã€‚ã‚ˆãé­”æ³•ã‚’é–“é•ãˆã‚‹ã€‚',
    battleCry:['ã‚ã‚Œã€ä»Šã®ã©ã®é­”æ³•ã ã£ã‘...ã¾ã‚ã„ã£ã‹ã€ç‡ƒãˆã¦ã‚‹ã—','ãˆãƒ¼ã£ã¨ã€ãƒ•ã‚¡ã‚¤ã‚¢ã ã£ã‘ï¼Ÿãƒ–ãƒªã‚¶ãƒ‰ã ã£ã‘ï¼Ÿ...ãƒ‰ã‚«ãƒ¼ãƒ³ã§ã„ã„ã‹ï¼','ãã‚‰ãã‚‰ã€œã£ã¦ã‚„ã¤ã€ã„ãã‚ˆã€œ','ã‚ã€å‡ºã¡ã‚ƒã£ãŸï¼ã§ã‚‚å½“ãŸã£ãŸã‹ã‚‰OKï¼'],
    battleWin:['ã‚„ã£ãŸãï¼...ã‚ã‚Œã€ä½•å€’ã—ãŸã‚“ã ã£ã‘','çµ‚ã‚ã£ãŸï¼ŸãŠè…¹ã™ã„ãŸãªã','é­”æ³•ä½¿ã„ã™ãã¦çœ ã„...'],
    battleHurt:['ã„ãŸãŸ...ã‚‚ã†ã€æœãŒç„¦ã’ã¡ã‚ƒã£ãŸ','ãˆã€ç—›ã„ã€‚ç—›ã„ã‚ˆã…','ã†ã‚ãã‚“ã€ä½•ã™ã‚‹ã®ã‰'],
    restLine:['ã­ã‡ã­ã‡ã€ã“ã®å…‰ã‚‹ã‚­ãƒã‚³é£Ÿã¹ã‚‰ã‚Œã‚‹ã‹ãªï¼Ÿ','ãŠæ˜Ÿã•ã¾è¦‹ãˆãªã„ã‹ãªã...åœ°ä¸‹ã ã£ãŸ','ã‚ã€æ–°ã—ã„é­”æ³•æ€ã„ã¤ã„ã¡ã‚ƒã£ãŸ...ã‹ã‚‚'],
    trapLine:['ã‚ã€ä½•ã‹å…‰ã£ã¦ã‚‹ï¼ãã‚Œãƒ¼...ã£ã¦ç½ !?','ã‚ã¶ãªãƒ¼ã„ï¼...ã‚ã‚Œã€ç§ãŒè¸ã‚“ã ï¼Ÿ'],
  },
  healer_m: {
    name:'ã‚¨ãƒ«ãƒãƒ¼', trait:'ç©ã‚„ã‹ãƒ»å„ªã—ã„å…„è²´åˆ†', traitShort:'åŒ…å®¹åŠ›ã®å…„è²´ãƒ’ãƒ¼ãƒ©ãƒ¼', quote:'å¤§ä¸ˆå¤«ã€ä¿ºãŒã¤ã„ã¦ã‚‹', tone:'è½ã¡ç€ã„ãŸå„ªã—ã„å£èª¿',
    backstory:'å­¤å…é™¢è‚²ã¡ã€‚å­ä¾›ãŸã¡ã‚’å®ˆã‚‹ãŸã‚ç™’ã—ã®åŠ›ã‚’ç£¨ã„ãŸã€‚',
    battleCry:['å¤§ä¸ˆå¤«ã€ä¿ºãŒã¤ã„ã¦ã‚‹','ç„¡ç†ã™ã‚‹ãªã‚ˆã€‚å›å¾©ã¯ä»»ã›ã‚','å‰è¡›ã¯æ°—ã«ã›ãšæ”»ã‚ã‚ã€‚å¾Œã‚ã¯ä¿ºãŒå®ˆã‚‹','ã¾ã èª°ã‚‚æ­»ãªã›ã‚„ã—ãªã„'],
    battleWin:['æ€ªæˆ‘ã¯ãªã„ã‹ï¼Ÿè¦‹ã›ã¦ã¿ã‚','ã‚ˆã—ã€å…¨å“¡ç„¡äº‹ã ãª','å‚·ã®æ‰‹å½“ã¦ã‚’ã™ã‚‹ãã€‚ã“ã£ã¡ã«æ¥ã„'],
    battleHurt:['ãã£...ãƒ’ãƒ¼ãƒ©ãƒ¼ãŒå€’ã‚Œã‚‹ã‚ã‘ã«ã¯ã„ã‹ãªã„ã‚“ã ','å¤§ä¸ˆå¤«...è‡ªåˆ†ã§æ²»ã›ã‚‹','å¿ƒé…ã™ã‚‹ãª...ã“ã®ç¨‹åº¦ã€ã™ãæ²»ã‚‹'],
    restLine:['ã»ã‚‰ã€æ¸©ã‹ã„ã‚¹ãƒ¼ãƒ—ã‚’ä½œã£ãŸã','ã¿ã‚“ãªã®é¡”ã‚’è¦‹ã¦ã‚‹ã¨å®‰å¿ƒã™ã‚‹ã‚ˆ','å­¤å…é™¢ã®å­ä¾›ãŸã¡...å…ƒæ°—ã«ã—ã¦ã‚‹ã‹ãª'],
    trapLine:['å±ãªã„ï¼ä¸‹ãŒã£ã¦ã‚ï¼','æ²»ç™‚ã®æº–å‚™ã¯ã§ãã¦ã‚‹ã€‚æ€ã„åˆ‡ã£ã¦è¡Œã‘'],
  },
  healer_f: {
    name:'ãƒ•ã‚£ã‚ªãƒŠ', trait:'ãŠã£ã¨ã‚Šãƒ»èŠ¯ãŒå¼·ã„', traitShort:'èŠ¯ã®å¼·ã„ãŠã£ã¨ã‚Šç™’ã—æ‰‹', quote:'ã¿ãªã•ã‚“ã®å‚·ã¯ç§ãŒå¼•ãå—ã‘ã¾ã™', tone:'ãŠã£ã¨ã‚Šä¸å¯§èª',
    backstory:'æ£®ã®å¥¥ã®è¨ºç™‚æ‰€ã§åƒã„ã¦ã„ãŸã€‚å†’é™ºè€…ã®æ²»ç™‚ãŒãã£ã‹ã‘ã§æ—…ã«å‡ºãŸã€‚',
    battleCry:['ç—›ã„ã®ç—›ã„ã®ã€é£›ã‚“ã§ã„ã‘...æœ¬å½“ã«é£›ã‚“ã§ã„ãã¾ã—ãŸã­','ã¿ãªã•ã‚“ã®å‚·ã¯ç§ãŒå¼•ãå—ã‘ã¾ã™','å€’ã‚Œãªã„ã§ãã ã•ã„...ãŠé¡˜ã„ã—ã¾ã™','ç™’ã—ã®åŠ›ã‚ˆã€ã¿ã‚“ãªã‚’å®ˆã£ã¦'],
    battleWin:['ã‚ˆã‹ã£ãŸ...ã¿ãªã•ã‚“ã”ç„¡äº‹ã§','ãŠç–²ã‚Œæ§˜ã§ã™ã€‚ã™ãæ²»ç™‚ã—ã¾ã™ã­','ãµã…...å¿ƒè‡“ã«æ‚ªã„ã§ã™'],
    battleHurt:['ã‚ã…...ã§ã‚‚ã€ã¿ãªã•ã‚“ã®æ–¹ãŒå¤§äº‹ã§ã™','ç§ã¯å¤§ä¸ˆå¤«...å¤šåˆ†','ã„ãŸãŸ...ã§ã‚‚ã€æ³£ãã¾ã›ã‚“'],
    restLine:['è–¬è‰ã‚’èª¿åˆã—ã¦ãŠãã¾ã™ã­','ã“ã®è‹”ã€è–¬ã«ãªã‚Šãã†ã§ã™','ã¿ãªã•ã‚“ã«ãŠèŒ¶ã‚’...ã‚ã€ææ–™ãŒãªã„...'],
    trapLine:['ã‚ã£ã€ãã“è¸ã‚“ã˜ã‚ƒãƒ€ãƒ¡ã§ã™ï¼','ãŠè–¬ã®æº–å‚™ã¯ã§ãã¦ã¾ã™ã‹ã‚‰ã€å®‰å¿ƒã—ã¦ãã ã•ã„'],
  },
  thief_m: {
    name:'ã‚«ã‚¤ãƒˆ', trait:'ãƒãƒ£ãƒ©ã„ãŒè…•ã¯ä¸€æµ', traitShort:'ãƒãƒ£ãƒ©ã„ãŒè…•ã¯ä¸€æµ', quote:'éš™ã ã‚‰ã‘ã ãœã€ã‚‚ã‚‰ã£ãŸï¼', tone:'è»½ã„ãƒ»ç •ã‘ãŸå£èª¿',
    backstory:'ã‚¹ãƒ©ãƒ è¡—å‡ºèº«ã€‚ç›—ã¿ã§ç”Ÿãå»¶ã³ã¦ããŸãŒã€ä»²é–“ã‚’å¾—ã¦æ­£é“ã«ã€‚',
    battleCry:['ã¸ã¸ã£ã€ãŠå®ã®åŒ‚ã„ãŒã™ã‚‹ãœ','ç½ ï¼Ÿã“ã‚“ãªã®æœé£¯å‰ã ã£ã¦','éš™ã ã‚‰ã‘ã ãœã€ã‚‚ã‚‰ã£ãŸï¼','ä¿ºã®é€Ÿã•ã«ã¤ã„ã¦ã“ã‚Œã‚‹ã‹ãªï¼Ÿ'],
    battleWin:['æ¥½å‹æ¥½å‹ï¼','æˆ¦åˆ©å“ãƒã‚§ãƒƒã‚¯ã€œã£ã¨','ã„ã„æ±—ã‹ã„ãŸãœ'],
    battleHurt:['ã£ã¨ã€å±ã­ã‡ï¼','ã‚„ã¹ã€æ²¹æ–­ã—ãŸ...','ããã£ã€æœãŒç ´ã‚ŒãŸã˜ã‚ƒã­ãƒ¼ã‹'],
    restLine:['ãªã‚ã€ã“ã®ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ã®å®ã£ã¦èª°ã®ã‚‚ã‚“ã ï¼Ÿ','ã‚¹ãƒ©ãƒ ã®é£¯ã®æ–¹ãŒã¾ã ãƒã‚·ã ã£ãŸãª...','é€€å±ˆã ãªã€‚ãƒˆãƒ©ãƒ³ãƒ—ã§ã‚‚ã‚„ã‚‰ã­ã‡ï¼Ÿ'],
    trapLine:['ãŠã£ã¨ã€ã“ã“ãƒ¤ãƒã„ãªã€‚ä¿ºã«ä»»ã›ãª','ã¸ã¸ã€ã“ã†ã„ã†ã®ã¯å¾—æ„ãªã‚“ã ã‚ˆ'],
  },
  thief_f: {
    name:'ã‚·ãƒ£ãƒ¼ãƒªã‚£', trait:'ã‚¯ãƒ¼ãƒ«ãƒ»å¯¡é»™', traitShort:'å¯¡é»™ãªå…ƒæš—æ®ºè€…', quote:'...ä¸€æ’ƒã§çµ‚ã‚ã‚‰ã›ã‚‹', tone:'æœ€å°é™ã®è¨€è‘‰',
    backstory:'æš—æ®ºè€…ã‚®ãƒ«ãƒ‰å‡ºèº«ã€‚ä¾é ¼ã§æ½œã£ãŸãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ã§ä»²é–“ã¨å‡ºä¼šã„è„±é€€ã€‚',
    battleCry:['...è§£é™¤ã—ãŸ','å…ˆã«è¡Œã£ã¦','...ä¸€æ’ƒã§çµ‚ã‚ã‚‰ã›ã‚‹','é»™ã£ã¦è¦‹ã¦ã¦'],
    battleWin:['...çµ‚ã‚ã‚Š','æ¬¡','...å•é¡Œãªã„'],
    battleHurt:['...ã£','æ ã‚Šå‚·','...å¤§ä¸ˆå¤«'],
    restLine:['...é™ã‹ã§ã„ã„','...ãƒŠã‚¤ãƒ•ã®æ‰‹å…¥ã‚Œä¸­','...èµ·ã“ã•ãªã„ã§'],
    trapLine:['...è¸ã‚€ãª','è§£é™¤ã™ã‚‹ã€‚å¾…ã£ã¦'],
  },
  archer_m: {
    name:'ãƒ­ã‚¤ãƒ‰', trait:'çœŸé¢ç›®ãƒ»åŠªåŠ›å®¶ãƒ»è‡ªä¿¡ãŒãªã„', traitShort:'è‡ªä¿¡ãªãåŠªåŠ›å®¶', quote:'...å½“ãŸã‚Œï¼', tone:'æ§ãˆã‚',
    backstory:'çŒŸå¸«ã®å®¶ç³»ã€‚æ‰èƒ½ã¯ã‚ã‚‹ãŒå¤±æ•—ã‚’æã‚Œã‚‹æ€§æ ¼ã€‚',
    battleCry:['...å½“ãŸã‚Œï¼','å¤–ã—ãŸã‚‰ã©ã†ã—ã‚ˆã†ã¨ã‹è€ƒãˆã¡ã‚ƒãƒ€ãƒ¡ã ã‚ˆãª...','é›†ä¸­...é›†ä¸­...ï¼','ä¸€å°„å…¥é­‚...ï¼'],
    battleWin:['å½“ãŸã£ãŸ...ã‚ˆã‹ã£ãŸ...','å¤–ã•ãªãã¦ã‚ˆã‹ã£ãŸ...','ã‚‚ã£ã¨ä¸Šæ‰‹ããªã‚ŠãŸã„ãª...'],
    battleHurt:['ã†ã£...å¼“ãŒ...ï¼','ç«‹ã¡ä½ç½®ãŒæ‚ªã‹ã£ãŸ...åƒ•ã®ãƒŸã‚¹ã ','ç—›ã„...ã‘ã©ã€ã¾ã å°„ã¦ã‚‹'],
    restLine:['å¼“å¼¦ã®èª¿æ•´ã‚’ã—ã¦ãŠã“ã†...','çˆ¶ã•ã‚“ãªã‚‰ã‚‚ã£ã¨ä¸Šæ‰‹ãã‚„ã‚‹ã‚“ã ã‚ã†ãª','çŸ¢ã®æ®‹ã‚ŠãŒå¿ƒé…ã ãª...'],
    trapLine:['å±ãªã„ï¼ã¿ã‚“ãªæ­¢ã¾ã£ã¦ï¼','ã‚ã€ã‚ãã“æ€ªã—ããªã„ã‹ãª...'],
  },
  archer_f: {
    name:'ã‚¨ãƒ¬ãƒŠ', trait:'æ´»ç™ºãƒ»è² ã‘ãšå«Œã„', traitShort:'å…ƒæ°—ã„ã£ã±ã„è² ã‘ãšå«Œã„', quote:'ã‚ãŸã—ã®å¼“ã‚’èˆã‚ãªã„ã§ã‚ˆï¼', tone:'å…ƒæ°—ãƒ»å‹æ°—',
    backstory:'è¾ºå¢ƒã®æ‘å‡ºèº«ã€‚æ‘ä¸€ç•ªã®å¼“ã®è…•å‰ã‚’å¼•ã£æã’ã¦å†’é™ºè€…ã«ã€‚',
    battleCry:['æ¬¡ã¯çµ¶å¯¾å¤–ã•ãªã„ã‹ã‚‰ï¼','ã‚ãŸã—ã®å¼“ã‚’èˆã‚ãªã„ã§ã‚ˆï¼','ã„ã£ãã‚ˆãƒ¼ï¼','ã©çœŸã‚“ä¸­ã¶ã¡æŠœã„ã¦ã‚„ã‚‹ï¼'],
    battleWin:['ã©ã†ï¼Ÿã‚ãŸã—ã®è…•å‰ï¼','ãµãµã‚“ã€ç™¾ç™ºç™¾ä¸­ã‚ˆï¼','ã¾ã€ã“ã‚“ãªã‚‚ã‚“ã‚ˆã­'],
    battleHurt:['ã„ã£ãŸï¼ã‚‚ã†æ€’ã£ãŸï¼','ãã…...å€ã«ã—ã¦è¿”ã™ã‹ã‚‰ã­ï¼','ã“ã®ã£...èˆã‚ãªã„ã§ã‚ˆï¼'],
    restLine:['ã­ã‡ã­ã‡ã€èª°ãŒä¸€ç•ªå¼·ã„ã¨æ€ã†ï¼Ÿã‚ãŸã—ã§ã—ã‚‡ï¼Ÿ','æ•…éƒ·ã®ã¿ã‚“ãªã€é©šãã‹ãªã','çš„å½“ã¦ã‚²ãƒ¼ãƒ ã—ãªã„ï¼Ÿæš‡ãªã‚“ã ã‘ã©'],
    trapLine:['ã‚ã£ï¼å±ãªã£ï¼','çŸ¢ã§é ãã‹ã‚‰èµ·å‹•ã•ã›ã¡ã‚ƒãŠã†ã‹ï¼Ÿ'],
  },
  priest_m: {
    name:'ã‚»ãƒ‰ãƒªãƒƒã‚¯', trait:'æ¸©åšãƒ»ãŸã¾ã«æ¯’èˆŒ', traitShort:'æ¯’èˆŒã®å…ƒå¸ç¥­', quote:'ç¥ã¯è©¦ç·´ãŒãŠå¥½ãã§...', tone:'ç©ã‚„ã‹ã ãŒæ™‚ã€…è¾›è¾£',
    backstory:'å¤§è–å ‚ã®å…ƒå¸ç¥­ã€‚æ•™ä¼šã®å •è½ã«å¤±æœ›ã—ã€æ°‘ã‚’ç›´æ¥æ•‘ã†æ—…ã«å‡ºãŸã€‚',
    battleCry:['ç¥ã®å°ãã§ã™ã‚ˆ...å¤šåˆ†','ç¥ˆã‚Šã¾ã—ã‚‡ã†ã€‚ãã‚Œã—ã‹ã§ãã¾ã›ã‚“ã—','ç¥ã‚ˆã€ã“ã®è€…ãŸã¡ã«æ…ˆæ‚²ã‚’...ã„ãˆã€ã‚„ã¯ã‚Šå¤©ç½°ã‚’','è–ãªã‚‹åŠ›ã§å®ˆã‚Šã¾ã—ã‚‡ã†...é–“ã«åˆãˆã°ã§ã™ãŒ'],
    battleWin:['ç¥ã®ã”åŠ è­·ãŒã‚ã£ãŸã‚ˆã†ã§ã™ã­','ã¾ã‚ã€å®ŸåŠ›ã§ã™ã‘ã©ã­','ç¥ˆã‚ŠãŒå±Šã„ãŸã‚ˆã†ã§ä½•ã‚ˆã‚Šã§ã™'],
    battleHurt:['ãŠã‚„ã€ç—›ã„ã§ã™ã­...å½“ç„¶ã§ã™ãŒ','ç¥ã¯è©¦ç·´ãŒãŠå¥½ãã§...','ã“ã‚Œã‚‚ä¿®è¡Œã¨æ€ãˆã°...ã„ãˆã€æ™®é€šã«ç—›ã„ã§ã™'],
    restLine:['ãŠç¥ˆã‚Šã®æ™‚é–“ã§ã™ã‚ˆã€‚...å†—è«‡ã§ã™ãŒ','ç¥ã¯è¨€ã£ã¦ã„ã¾ã™ã€‚ã€Œå¯ã‚ã€ã¨','æ•™ä¼šã®é£Ÿäº‹ã‚ˆã‚Šã¯ãƒã‚·ã§ã™ã­...ã‚ã‚Œã¯ç½°ã‚²ãƒ¼ãƒ ã§ã—ãŸã‹ã‚‰'],
    trapLine:['ç¥ã®ãŠå°ãã§å›é¿...ã§ãã‚Œã°ã„ã„ã§ã™ã­','ç½ ã§ã™ã‹ã€‚ç¥ã¯ç½ ãŒå¥½ãã§ã™ã‹ã‚‰ã­'],
  },
  priest_f: {
    name:'ãƒªãƒªã‚¢ãƒ¼ãƒ', trait:'ä¸–è©±ç„¼ããƒ»ãŠå§‰ã•ã‚“æ°—è³ª', traitShort:'ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ã®æ¯', quote:'ã‚ãªãŸãŸã¡ã«ã¯ç§ãŒã„ã‚‹ã§ã—ã‚‡ã†ï¼Ÿ', tone:'åŒ…å®¹åŠ›ã®ã‚ã‚‹å§‰å¾¡è‚Œ',
    backstory:'ç¥æ®¿ã®ã‚·ã‚¹ã‚¿ãƒ¼é•·ã€‚é¢å€’è¦‹ãŒè‰¯ã™ãã¦ã€Œãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ã®æ¯ã€ã¨å‘¼ã°ã‚Œã‚‹ã€‚',
    battleCry:['ã»ã‚‰ã€å‰ã‚’å‘ã„ã¦','ã‚ãªãŸãŸã¡ã«ã¯ç§ãŒã„ã‚‹ã§ã—ã‚‡ã†ï¼Ÿ','å¤§ä¸ˆå¤«ã€ã¿ã‚“ãªã‚’å®ˆã‚‹ã‚','æ€–ãŒã‚‰ãªã„ã§ã€‚ç§ãŒç¥ˆã‚Šã§åŒ…ã‚€ã‹ã‚‰'],
    battleWin:['ã¿ã‚“ãªé ‘å¼µã£ãŸã‚ã­','æ€ªæˆ‘ã¯ï¼Ÿè¦‹ã›ã¦ã”ã‚‰ã‚“','ã•ã‚ã€å…ˆã«é€²ã¿ã¾ã—ã‚‡ã†'],
    battleHurt:['ã‚ã‚‰ã€ã‚„ã‚‹ã˜ã‚ƒãªã„...','ç§ãŒå€’ã‚ŒãŸã‚‰èª°ãŒã¿ã‚“ãªã‚’ä¸–è©±ã™ã‚‹ã®','ç—›ã„...ã‘ã©ã€ã¿ã‚“ãªã®å‰ã§ã¯æ³£ã‹ãªã„ã‚'],
    restLine:['ã¯ã„ã€åŒ…å¸¯æ›¿ãˆã‚‹ã‚ã‚ˆã€‚ã˜ã£ã¨ã—ã¦','ã¿ã‚“ãªã¡ã‚ƒã‚“ã¨é£Ÿã¹ãŸï¼Ÿæ®‹ã—ã¡ã‚ƒãƒ€ãƒ¡ã‚ˆ','æ•…éƒ·ã®å­ä¾›ãŸã¡ã«ãŠåœŸç”£ã‚’è²·ã‚ãªãã‚ƒ'],
    trapLine:['è¶³å…ƒæ°—ã‚’ã¤ã‘ã¦ï¼ã»ã‚‰ã€ã¡ã‚ƒã‚“ã¨å‰ã‚’è¦‹ã‚‹ï¼','ã¿ã‚“ãªç§ã®å¾Œã‚ã«ã€‚...ã„ãˆã€ç§ã®å‰ã«'],
  },
};

// ===== æ›ã‘åˆã„ä¼šè©±ãƒ‡ãƒ¼ã‚¿ =====
const BANTER = {
  // === æ±ç”¨é›‘è«‡ï¼ˆãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼å†…ã€ä»»æ„2äººï¼‰ ===
  generic: [
    {lines:['{a}ã€Œã“ã®å…ˆã€ã¾ã é•·ã„ã®ã‹ãª...ã€','{b}ã€Œå¼±éŸ³ã‚’åããªã€‚...ä¿ºã‚‚å°‘ã—æ€ã£ãŸãŒã€']},
    {lines:['{a}ã€Œè…¹æ¸›ã£ãŸãªã...ã€','{b}ã€Œæˆ‘æ…¢ã—ãªã•ã„ã€‚ã‚‚ã†å°‘ã—ã§ä¼‘æ†©ã§ãã‚‹ã¯ãšã‚ˆã€']},
    {lines:['{a}ã€Œã“ã“ã®å£ã€ãªã‚“ã‹å…‰ã£ã¦ãªã„ï¼Ÿã€','{b}ã€Œè§¦ã‚‹ãªï¼...è§¦ã‚‹ãªã‚ˆï¼Ÿçµ¶å¯¾ã ãï¼Ÿã€','{a}ã€Œè§¦ã£ã¦ã¿ãŸã€','{b}ã€ŒãŠã„ï¼ï¼ã€']},
    {lines:['{a}ã€Œåœ°ä¸Šã«æˆ»ã£ãŸã‚‰ä½•é£Ÿã¹ãŸã„ï¼Ÿã€','{b}ã€Œ...è‚‰ã€','{a}ã€Œå³ç­”ã˜ã‚ƒã‚“ã€']},
    {lines:['{a}ã€Œãªã‚“ã§ã“ã‚“ãªä»•äº‹é¸ã‚“ã ã‚“ã ã‚ã†ãª...ã€','{b}ã€Œä»Šãã‚Œè¨€ã†ï¼Ÿã€','{a}ã€Œã„ã‚„ã€ãµã¨...ã€']},
    {lines:['{a}ã€Œã•ã£ãã®æˆ¦é—˜ã€ã‹ã£ã“ã‚ˆã‹ã£ãŸãã€','{b}ã€Œãˆ...ãã€ãã†ã‹ï¼Ÿã‚ã‚ŠãŒã¨ã†ã€']},
    {lines:['{a}ã€Œã­ã‡ã€ã‚ã®è§’ã®å…ˆã«ä½•ãŒã‚ã‚‹ã¨æ€ã†ï¼Ÿã€','{b}ã€Œ...æ•µã˜ã‚ƒãªã„ã“ã¨ã‚’ç¥ˆã‚‹ã€']},
    {lines:['{a}ã€Œè¶³éŸ³ã‚’ç«‹ã¦ã‚‹ãª...é™ã‹ã«...ã€','{b}ã€ŒãŠå‰ã®å£°ã®æ–¹ãŒã†ã‚‹ã•ã„ã€']},
    {lines:['{a}ã€Œãªã‚“ã‹ä»Šæ—¥ã€ãƒ„ã‚¤ã¦ã‚‹æ°—ãŒã™ã‚‹ã‚“ã ã‚ˆãªã€','{b}ã€Œãƒ•ãƒ©ã‚°ã‚’ç«‹ã¦ã‚‹ã®ã¯ã‚„ã‚ã¦ãã‚Œã€']},
    {lines:['{a}ã€Œå¸°ã£ãŸã‚‰é¢¨å‘‚å…¥ã‚ŠãŸã„...ã€','{b}ã€ŒåŒæ„Ÿã ã€‚ã‚‚ã†3æ—¥å…¥ã£ã¦ãªã„ã€','{a}ã€Œ...è¿‘å¯„ã‚‰ãªã„ã§ã€']},
    {lines:['{a}ã€Œã•ã£ãä½•ã‹å‹•ã‹ãªã‹ã£ãŸï¼Ÿã€','{b}ã€Œ...æ°—ã®ã›ã„ã ã‚ã€','{a}ã€Œ...ã ã‚ˆã­ã€‚ã†ã‚“ã€‚æ°—ã®ã›ã„ã€']},
    {lines:['{a}ã€Œå†’é™ºè€…ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã¨ã‹ã‚ã£ãŸã‚‰ã€ä¿ºã‚‰ä½•ä½ã‹ãªã€','{b}ã€Œç”Ÿãã¦å¸°ã‚ŒãŸã‚‰ãƒ©ãƒ³ã‚­ãƒ³ã‚°å…¥ã‚Šã˜ã‚ƒãªã„ï¼Ÿã€']},
    {lines:['{a}ã€Œãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ã®ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã£ã¦æ™®æ®µä½•ã—ã¦ã‚‹ã‚“ã ã‚ã€','{b}ã€Œ...è€ƒãˆãŸã“ã¨ã‚‚ãªã‹ã£ãŸãªã€']},
    {lines:['{a}ã€Œã“ã®æ¾æ˜ã€ã‚ã¨ã©ã‚Œãã‚‰ã„æŒã¤ã‹ãªã€','{b}ã€Œè€ƒãˆãªã„ã“ã¨ã«ã—ã¦ã‚‹ã€']},
    {lines:['{a}ã€Œå‰ã®ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã¯ã“ã“ã¾ã§æ¥ã‚ŒãŸã®ã‹ãª...ã€','{b}ã€Œ...ã‚ã®éª¨ã‚’è¦‹ã‚‹é™ã‚Šã€æ¥ã‚ŒãŸã‚“ã ã‚ã†ãªã€','{a}ã€Œã‚„ã‚ã¦ã€']},
    {lines:['{a}ã€Œã¡ã‚‡ã£ã¨ä¼‘æ†©ã—ãªã„ï¼Ÿã€','{b}ã€Œæ•µã®å‰ã§è¨€ã†ã‚»ãƒªãƒ•ã˜ã‚ƒãªã„ã§ã—ã‚‡ã€']},
    {lines:['{a}ã€Œãªãã€ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼åæ±ºã‚ã‚ˆã†ãœã€','{b}ã€Œä»Šï¼Ÿã€','{a}ã€Œæš‡ã˜ã‚ƒã‚“ã€']},
    {lines:['{a}ã€Œæ°´ã®éŸ³ãŒã™ã‚‹...æ³‰ã‹ãªã€','{b}ã€Œç½ ã‹ã‚‚ã—ã‚Œãªã„ãã€','{a}ã€Œå¤¢ãŒãªã„ãªãã€']},
    {lines:['{a}ã€Œã“ã“ã€å‰ã«æ¥ãŸã“ã¨ã‚ã‚‹ã‚ˆã†ãª...ã€','{b}ã€Œãƒ‡ã‚¸ãƒ£ãƒ–ã£ã¦ã‚„ã¤ï¼Ÿãã‚Œã¨ã‚‚è¿·ã£ã¦ã‚‹ï¼Ÿã€','{a}ã€Œ...è¿·ã£ã¦ã‚‹ã‹ã‚‚ã€']},
    {lines:['{a}ã€Œã¿ã‚“ãªã®ãŠã‹ã’ã§ã“ã“ã¾ã§æ¥ã‚ŒãŸãªã€','{b}ã€Œæ€¥ã«ã©ã†ã—ãŸã€‚æ­»äº¡ãƒ•ãƒ©ã‚°ã‹ï¼Ÿã€','{a}ã€Œé•ã†ã‚ˆï¼ç´ ç›´ã«æ„Ÿè¬ã—ãŸã‚“ã ã‚ˆï¼ã€']},
  ],

  // === æˆ¦é—˜ä¸­ã®æ›ã‘åˆã„ ===
  battleGeneric: [
    {lines:['{a}ã€Œä»Šã ï¼ã€','{b}ã€Œä»»ã›ã‚ï¼ã€']},
    {lines:['{a}ã€Œæ´è­·ã™ã‚‹ï¼ã€','{b}ã€ŒåŠ©ã‹ã‚‹ï¼ã€']},
    {lines:['{a}ã€Œãƒ¤ãƒã„ã£ã¦ï¼ã€','{b}ã€Œã¾ã ã‚„ã‚Œã‚‹...ï¼ã€']},
    {lines:['{a}ã€Œå³ã‹ã‚‰æ¥ã‚‹ãï¼ã€','{b}ã€Œã‚ã‹ã£ã¦ã‚‹ï¼ã€']},
    {lines:['{a}ã€Œç„¡èŒ¶ã™ã‚‹ãªï¼ã€','{b}ã€Œç„¡èŒ¶ã—ãªã„ã¨æ­»ã¬ã ã‚ï¼ã€']},
    {lines:['{a}ã€Œã“ã£ã¡ã¯ç‰‡ä»˜ã„ãŸï¼ãã£ã¡ã¯ï¼ï¼Ÿã€','{b}ã€Œã‚‚ã†ã¡ã‚‡ã£ã¨...ï¼ã€']},
    {lines:['{a}ã€Œé€£æºã„ããï¼ã€','{b}ã€Œåˆã‚ã›ã‚‹ï¼ã€']},
    {lines:['{a}ã€Œä¸‹ãŒã‚Œï¼äº¤ä»£ã ï¼ã€','{b}ã€Œã¾ã ã‚„ã‚Œ...ã„ã‚„ã€é ¼ã‚€ã€']},
  ],

  // === ä¼‘æ†©ä¸­ã®æ›ã‘åˆã„ ===
  restGeneric: [
    {lines:['{a}ã€Œç„šãç«ãŒã‚ã‚‹ã¨ã»ã£ã¨ã™ã‚‹ãª...ã€','{b}ã€Œã†ã‚“...ä¸€ç¬ã ã‘ã€å†’é™ºã—ã¦ã‚‹ã“ã¨å¿˜ã‚Œã‚‹ã­ã€']},
    {lines:['{a}ã€Œæ•…éƒ·ã€ã©ã‚“ãªã¨ã“ï¼Ÿã€','{b}ã€Œ...æµ·ãŒè¦‹ãˆã‚‹å°ã•ãªæ‘ã€‚å¸°ã‚ŠãŸã„ãªã€ãŸã¾ã«ã€']},
    {lines:['{a}ã€Œå°†æ¥ã®å¤¢ã¨ã‹ã‚ã‚‹ï¼Ÿã€','{b}ã€Œç”Ÿãã¦å¸°ã‚‹ã“ã¨ã€','{a}ã€Œåˆ‡å®Ÿã™ãã‚‹ã€']},
    {lines:['{a}ã€Œä¿å­˜é£Ÿã°ã£ã‹ã§é£½ããŸãª...ã€','{b}ã€Œè´…æ²¢è¨€ã†ãªã€‚é£Ÿãˆã‚‹ã ã‘ãƒã‚·ã ã€']},
    {lines:['{a}ã€Œæ˜ŸãŒè¦‹ãŸã„ãª...ã€','{b}ã€Œåœ°ä¸Šã«å‡ºãŸã‚‰ã€ä¸€ç·’ã«è¦‹ã‚ˆã†ãªã€']},
  ],

  // === ã‚­ãƒ£ãƒ©å›ºæœ‰ãƒšã‚¢æ›ã‘åˆã„ ===
  pair: {
    // ã‚«ã‚¤ãƒˆ Ã— ã‚¬ãƒ¬ã‚¹
    'thief_m:knight_m': [
      {lines:['ã‚«ã‚¤ãƒˆã€Œãªã‚ã€ã“ã®ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ã®å®ã£ã¦èª°ã®ã‚‚ã‚“ã ï¼Ÿã€','ã‚¬ãƒ¬ã‚¹ã€Œ...å‡ç­‰ã«åˆ†é…ã™ã‚‹ã«æ±ºã¾ã£ã¦ã„ã‚‹ã€','ã‚«ã‚¤ãƒˆã€Œã¤ã¾ã‚“ã­ãƒ¼ã®ã€']},
      {lines:['ã‚«ã‚¤ãƒˆã€Œã‚¬ãƒ¬ã‚¹ã£ã¦å …ã™ããªã„ï¼ŸãŸã¾ã«ã¯å†—è«‡è¨€ãˆã‚ˆã€','ã‚¬ãƒ¬ã‚¹ã€Œå†—è«‡ã‹...ã§ã¯ä¸€ã¤ã€‚ãŠå‰ã®æˆ¦ã„æ–¹ã¯å†—è«‡ã¿ãŸã„ã ãªã€','ã‚«ã‚¤ãƒˆã€Œãã‚Œå†—è«‡ã˜ã‚ƒãªãã¦æ‚ªå£ã ã‚ï¼ã€']},
      {lines:['ã‚«ã‚¤ãƒˆã€Œãªãã€ä¿ºãŒãƒ”ãƒ³ãƒã®æ™‚ã¯åŠ©ã‘ã¦ãã‚Œã‚‹ã‚ˆãªï¼Ÿã€','ã‚¬ãƒ¬ã‚¹ã€Œå½“ç„¶ã ã€‚ä»²é–“ã‚’è¦‹æ¨ã¦ã‚‹é¨å£«ãŒã„ã‚‹ã‹ã€','ã‚«ã‚¤ãƒˆã€Œ...ãŠå‰ã€ãŸã¾ã«ã‚«ãƒƒã‚³ã„ã„ã“ã¨è¨€ã†ã‚ˆãªã€']},
      {lines:['ã‚¬ãƒ¬ã‚¹ã€Œã‚«ã‚¤ãƒˆã€åµå¯Ÿã‚’é ¼ã‚€ã€','ã‚«ã‚¤ãƒˆã€Œã¸ã„ã¸ã„ã€‚ä¿ºã¯ãƒ‘ã‚·ãƒªã‹ï¼Ÿã€','ã‚¬ãƒ¬ã‚¹ã€Œæœ€ã‚‚é©ä»»ã ã¨è¨€ã£ã¦ã„ã‚‹ã€','ã‚«ã‚¤ãƒˆã€Œ...è¤’ã‚ã¦ã‚“ã®ã‹è²¶ã—ã¦ã‚“ã®ã‹ã€']},
    ],
    // ã‚¼ãƒãƒ³ Ã— ãƒ«ã‚·ã‚¨ãƒ©
    'mage_m:mage_f': [
      {lines:['ã‚¼ãƒãƒ³ã€Œãƒ«ã‚·ã‚¨ãƒ©ã€ã•ã£ãã®é­”æ³•ã®å±æ€§ã¯ä½•ã ï¼Ÿã€','ãƒ«ã‚·ã‚¨ãƒ©ã€Œãˆãƒ¼ã£ã¨...ãƒ‰ã‚«ãƒ¼ãƒ³ç³»ï¼Ÿã€','ã‚¼ãƒãƒ³ã€Œ...å­¦è¡“çš„ã«é ¼ã‚€ã€']},
      {lines:['ãƒ«ã‚·ã‚¨ãƒ©ã€Œã‚¼ãƒãƒ³ã£ã¦é›£ã—ã„æœ¬ã°ã£ã‹ã‚Šèª­ã‚“ã§ã‚‹ã‚ˆã­ã€','ã‚¼ãƒãƒ³ã€ŒçŸ¥è­˜ã¯åŠ›ã ã€','ãƒ«ã‚·ã‚¨ãƒ©ã€Œã‚ãŸã—ã¯æ„Ÿè¦šæ´¾ã ã‹ã‚‰ãªãã€œã€','ã‚¼ãƒãƒ³ã€Œãã‚Œã§å¤©æ‰ã¨ã„ã†ã®ãŒä¸€ç•ªè…¹ç«‹ã¤ã‚“ã ãŒã€']},
      {lines:['ã‚¼ãƒãƒ³ã€Œãã®æ‰èƒ½ã‚’ç„¡é§„é£ã„ã™ã‚‹ãªã€','ãƒ«ã‚·ã‚¨ãƒ©ã€Œç„¡é§„é£ã„ã—ã¦ãªã„ã‚ˆï¼Ÿã»ã‚‰ã€ã´ã‹ãƒ¼ã€','ã‚¼ãƒãƒ³ã€Œãã‚Œç…§æ˜é­”æ³•ã ã‚ã†ã€‚æˆ¦é—˜ä¸­ã«ä½¿ãˆã€']},
    ],
    // ã‚¨ãƒ«ãƒãƒ¼ Ã— ãƒ•ã‚£ã‚ªãƒŠ
    'healer_m:healer_f': [
      {lines:['ã‚¨ãƒ«ãƒãƒ¼ã€Œãƒ•ã‚£ã‚ªãƒŠã€ç„¡ç†ã—ã¦ãªã„ã‹ï¼Ÿã€','ãƒ•ã‚£ã‚ªãƒŠã€Œã‚¨ãƒ«ãƒãƒ¼ã•ã‚“ã“ã...ã„ã¤ã‚‚äººã®å¿ƒé…ã°ã‹ã‚Šã€','ã‚¨ãƒ«ãƒãƒ¼ã€ŒãŠäº’ã„æ§˜ã ãªã€‚ãƒ’ãƒ¼ãƒ©ãƒ¼ã®æ€§åˆ†ã ã€']},
      {lines:['ãƒ•ã‚£ã‚ªãƒŠã€Œã‚¨ãƒ«ãƒãƒ¼ã•ã‚“ã€ã“ã®è–¬è‰ã®é…åˆè¦‹ã¦ã‚‚ã‚‰ãˆã¾ã™ã‹ï¼Ÿã€','ã‚¨ãƒ«ãƒãƒ¼ã€Œã‚ã‚ã€ã„ã„ãã€‚...ã“ã‚Œã€ãƒ•ã‚£ã‚ªãƒŠã®æ–¹ãŒä¸Šæ‰‹ã„ã ã‚ã€','ãƒ•ã‚£ã‚ªãƒŠã€Œãã‚“ãªã“ã¨ãªã„ã§ã™...ãˆã¸ã¸ã€']},
      {lines:['ã‚¨ãƒ«ãƒãƒ¼ã€Œå›å¾©ã¯ä¿ºã«ä»»ã›ã¦ã€ãƒ•ã‚£ã‚ªãƒŠã¯å°‘ã—ä¼‘ã‚ã€','ãƒ•ã‚£ã‚ªãƒŠã€Œã§ã‚‚...ã€','ã‚¨ãƒ«ãƒãƒ¼ã€Œãƒ’ãƒ¼ãƒ©ãƒ¼ãŒå€’ã‚ŒãŸã‚‰å…ƒã‚‚å­ã‚‚ãªã„ã ã‚ï¼Ÿã€']},
    ],
    // ã‚«ã‚¤ãƒˆ Ã— ã‚·ãƒ£ãƒ¼ãƒªã‚£
    'thief_m:thief_f': [
      {lines:['ã‚«ã‚¤ãƒˆã€Œãªãã‚·ãƒ£ãƒ¼ãƒªã‚£ã€ãŸã¾ã«ã¯ç¬‘ãˆã‚ˆã€','ã‚·ãƒ£ãƒ¼ãƒªã‚£ã€Œ...å¿…è¦ãªã„ã€','ã‚«ã‚¤ãƒˆã€Œã¤ã‚Œãªã„ã­ã‡ã€‚å¯æ„›ã„é¡”ã—ã¦ã‚“ã®ã«ã‚‚ã£ãŸã„ãªã„ã€','ã‚·ãƒ£ãƒ¼ãƒªã‚£ã€Œ...ã†ã‚‹ã•ã„ã€']},
      {lines:['ã‚«ã‚¤ãƒˆã€Œã“ã®ç½ ã€ä¿ºã¨ãŠå‰ã©ã£ã¡ãŒæ—©ãè§£é™¤ã§ãã‚‹ã‹å‹è² ã—ã­ï¼Ÿã€','ã‚·ãƒ£ãƒ¼ãƒªã‚£ã€Œ...ã‚‚ã†è§£é™¤ã—ãŸã€','ã‚«ã‚¤ãƒˆã€Œã¯ï¼Ÿæ—©ã£ï¼ã€']},
      {lines:['ã‚·ãƒ£ãƒ¼ãƒªã‚£ã€Œ...ã‚ã‚“ãŸã®è¶³éŸ³ã€ã†ã‚‹ã•ã„ã€','ã‚«ã‚¤ãƒˆã€Œãˆã£ã€ä¿ºãã‚“ãªã«éŸ³ç«‹ã¦ã¦ã‚‹ï¼Ÿã€','ã‚·ãƒ£ãƒ¼ãƒªã‚£ã€Œç›—è³Šå¤±æ ¼ã€','ã‚«ã‚¤ãƒˆã€Œæ‰‹å³ã—ã„ãªï¼ã€']},
    ],
    // ãƒ­ã‚¤ãƒ‰ Ã— ã‚¨ãƒ¬ãƒŠ
    'archer_m:archer_f': [
      {lines:['ã‚¨ãƒ¬ãƒŠã€Œã­ãˆãƒ­ã‚¤ãƒ‰ã€ã•ã£ãã®å°„æ’ƒã©ã†ã ã£ãŸï¼Ÿã€','ãƒ­ã‚¤ãƒ‰ã€Œã™ã€ã™ã”ã‹ã£ãŸã‚ˆ...åƒ•ã«ã¯ã‚ã‚“ãªé€Ÿå°„ã§ããªã„ã€','ã‚¨ãƒ¬ãƒŠã€Œã§ã—ã‚‡ï¼ã§ã‚‚ãƒ­ã‚¤ãƒ‰ã®ç²¾å¯†å°„æ’ƒã‚‚ã™ã”ã„ã¨æ€ã†ã‚ˆã€','ãƒ­ã‚¤ãƒ‰ã€Œãˆ...ã‚ã‚ŠãŒã¨ã†ã€']},
      {lines:['ãƒ­ã‚¤ãƒ‰ã€Œã‚¨ãƒ¬ãƒŠã€çŸ¢ã®æ®‹ã‚Šå¤§ä¸ˆå¤«ï¼Ÿã€','ã‚¨ãƒ¬ãƒŠã€Œä½™è£•ã‚ˆï¼ãƒ­ã‚¤ãƒ‰ã“ãã€å¼“å¼¦åˆ‡ã‚Œãã†ã˜ã‚ƒãªã„ï¼Ÿã€','ãƒ­ã‚¤ãƒ‰ã€Œã‚ã£...æœ¬å½“ã ã€‚ã‚ã‚ŠãŒã¨ã†ã€æ°—ã¥ã‹ãªã‹ã£ãŸã€']},
      {lines:['ã‚¨ãƒ¬ãƒŠã€Œã‚ãŸã—ã¨ã©ã£ã¡ãŒä¸Šæ‰‹ã„ã‹ã€æ±ºç€ã¤ã‘ã‚ˆã†ã‚ˆï¼ã€','ãƒ­ã‚¤ãƒ‰ã€Œãˆã€é æ…®ã—ã¨ã...çµ¶å¯¾ã‚¨ãƒ¬ãƒŠã®æ–¹ãŒä¸Šæ‰‹ã„ã—...ã€','ã‚¨ãƒ¬ãƒŠã€Œã‚‚ã†ï¼ãã†ã„ã†ã¨ã“ï¼è‡ªä¿¡æŒã¡ãªã‚ˆï¼ã€']},
    ],
    // ã‚»ãƒ‰ãƒªãƒƒã‚¯ Ã— ãƒªãƒªã‚¢ãƒ¼ãƒ
    'priest_m:priest_f': [
      {lines:['ã‚»ãƒ‰ãƒªãƒƒã‚¯ã€Œãƒªãƒªã‚¢ãƒ¼ãƒæ®¿ã¯ç›¸å¤‰ã‚ã‚‰ãšä¸–è©±ç„¼ãã§ã™ã­ã€','ãƒªãƒªã‚¢ãƒ¼ãƒã€Œã‚ãªãŸã¯ç›¸å¤‰ã‚ã‚‰ãšæ¯’èˆŒã­ã€ã‚»ãƒ‰ãƒªãƒƒã‚¯ã€','ã‚»ãƒ‰ãƒªãƒƒã‚¯ã€Œã“ã‚Œã§ã‚‚æŠ‘ãˆã¦ã‚‹ã‚“ã§ã™ã‚ˆã€','ãƒªãƒªã‚¢ãƒ¼ãƒã€Œ...ã‚‚ã£ã¨æŠ‘ãˆã¦ï¼Ÿã€']},
      {lines:['ãƒªãƒªã‚¢ãƒ¼ãƒã€Œã‚»ãƒ‰ãƒªãƒƒã‚¯ã€ã¡ã‚ƒã‚“ã¨é£Ÿã¹ãŸï¼Ÿã€','ã‚»ãƒ‰ãƒªãƒƒã‚¯ã€Œã¯ã„ã¯ã„ã€æ¯ä¸Šã€','ãƒªãƒªã‚¢ãƒ¼ãƒã€Œæ¯ä¸Šã£ã¦è¨€ã‚ãªã„ã§ï¼ãŠå§‰ã•ã‚“ã‚ˆï¼ã€']},
      {lines:['ã‚»ãƒ‰ãƒªãƒƒã‚¯ã€Œç¥ã¯äºŒäººã‚‚åƒ§ä¾¶ã‚’é€ã£ã¦ã©ã†ã™ã‚‹ã¤ã‚‚ã‚Šã§ã™ã‹ã­ã€','ãƒªãƒªã‚¢ãƒ¼ãƒã€ŒäºŒäººã„ãŸæ–¹ãŒå®‰å¿ƒã§ã—ã‚‡ã†ï¼Ÿã€','ã‚»ãƒ‰ãƒªãƒƒã‚¯ã€Œã¾ã‚...å¦å®šã¯ã—ã¾ã›ã‚“ã€']},
    ],
    // ã‚¬ãƒ¬ã‚¹ Ã— ãƒ•ã‚£ã‚ªãƒŠï¼ˆæ‹æ„›ãƒšã‚¢ï¼‰
    'knight_m:healer_f': [
      {lines:['ã‚¬ãƒ¬ã‚¹ã€Œãƒ•ã‚£ã‚ªãƒŠã€å¾Œã‚ã«ä¸‹ãŒã£ã¦ã„ã‚ã€','ãƒ•ã‚£ã‚ªãƒŠã€Œã§ã‚‚ã€ã‚¬ãƒ¬ã‚¹ã•ã‚“ã®å‚·ãŒ...ã€','ã‚¬ãƒ¬ã‚¹ã€Œã“ã®ç¨‹åº¦...æ°—ã«ã™ã‚‹ãªã€','ãƒ•ã‚£ã‚ªãƒŠã€Œæ°—ã«ã—ã¾ã™ï¼ã˜ã£ã¨ã—ã¦ãã ã•ã„ï¼ã€']},
      {lines:['ãƒ•ã‚£ã‚ªãƒŠã€Œã‚¬ãƒ¬ã‚¹ã•ã‚“ã€ã„ã¤ã‚‚ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€','ã‚¬ãƒ¬ã‚¹ã€Œ...ç¤¼ã‚’è¨€ã†ã®ã¯ä¿ºã®æ–¹ã ã€‚ãŠå‰ã®å›å¾©ãŒãªã‘ã‚Œã°...ã€','ãƒ•ã‚£ã‚ªãƒŠã€Œãµãµã€ãŠäº’ã„æ§˜ã§ã™ã­ã€']},
      {lines:['ã‚¬ãƒ¬ã‚¹ã€Œ...ãã‚Œã„ã ãªã€','ãƒ•ã‚£ã‚ªãƒŠã€Œãˆï¼Ÿã€','ã‚¬ãƒ¬ã‚¹ã€Œã„ã€ã„ã‚„ï¼ã“ã®...è‹”ãŒï¼è‹”ãŒç™ºå…‰ã—ã¦ãã‚Œã„ã ãªã¨ï¼ã€','ãƒ•ã‚£ã‚ªãƒŠã€Œ...ãµãµã€ãã†ã§ã™ã­ã€']},
    ],
    // ã‚¼ãƒãƒ³ Ã— ã‚¨ãƒ¬ãƒŠï¼ˆæ‹æ„›ãƒšã‚¢ï¼‰
    'mage_m:archer_f': [
      {lines:['ã‚¨ãƒ¬ãƒŠã€Œã‚¼ãƒãƒ³ã€ã¾ãŸé›£ã—ã„é¡”ã—ã¦ã‚‹ï¼ã€','ã‚¼ãƒãƒ³ã€Œè€ƒãˆäº‹ã‚’ã—ã¦ã„ã‚‹ã€‚é™ã‹ã«ã—ã¦ãã‚Œã€','ã‚¨ãƒ¬ãƒŠã€Œãˆãƒ¼ã€ã¤ã¾ã‚“ãªã„ï¼ã­ã‡è©±ãã†ã‚ˆï¼ã€','ã‚¼ãƒãƒ³ã€Œ...ã‚„ã‚Œã‚„ã‚Œã€']},
      {lines:['ã‚¼ãƒãƒ³ã€Œãã®å°„æ’ƒç²¾åº¦...èˆˆå‘³æ·±ã„ãªã€‚ç­‹åŠ›ã¨é¢¨ã®è¨ˆç®—ã¯ï¼Ÿã€','ã‚¨ãƒ¬ãƒŠã€Œè¨ˆç®—ï¼Ÿå‹˜ã‚ˆå‹˜ï¼ã€','ã‚¼ãƒãƒ³ã€Œ...å¤©æ‰ã‹é¦¬é¹¿ã‹åˆ¤æ–­ã«å›°ã‚‹ã€','ã‚¨ãƒ¬ãƒŠã€Œè¤’ã‚è¨€è‘‰ã¨ã—ã¦å—ã‘å–ã£ã¨ãï¼ã€']},
      {lines:['ã‚¨ãƒ¬ãƒŠã€Œã‚¼ãƒãƒ³ã£ã¦æ„å¤–ã¨å„ªã—ã„ã‚ˆã­ã€','ã‚¼ãƒãƒ³ã€Œ...æ ¹æ‹ ã¯ï¼Ÿã€','ã‚¨ãƒ¬ãƒŠã€Œã•ã£ãã€ã‚ãŸã—ãŒè»¢ã³ãã†ã«ãªã£ãŸæ™‚æ”¯ãˆã¦ãã‚ŒãŸã˜ã‚ƒã‚“ã€','ã‚¼ãƒãƒ³ã€Œ...åå°„ã ã€‚ãƒ‡ãƒ¼ã‚¿çš„ã«è»¢å€’ã¯éåŠ¹ç‡ã ã‹ã‚‰ãªã€']},
    ],
    // ã‚«ã‚¤ãƒˆ Ã— ãƒ«ã‚·ã‚¨ãƒ©ï¼ˆæ‹æ„›ãƒšã‚¢ï¼‰
    'thief_m:mage_f': [
      {lines:['ã‚«ã‚¤ãƒˆã€Œãƒ«ã‚·ã‚¨ãƒ©ã£ã¦è¦‹ã¦ã¦é£½ããªã„ã‚ˆãªã€','ãƒ«ã‚·ã‚¨ãƒ©ã€Œãˆï¼Ÿãªã«ãªã«ï¼Ÿã€','ã‚«ã‚¤ãƒˆã€Œã„ã‚„ã€æ¬¡ä½•ã‚„ã‚‰ã‹ã™ã‹äºˆæ¸¬ã§ããªãã¦ã€','ãƒ«ã‚·ã‚¨ãƒ©ã€Œã‚„ã‚‰ã‹ã™ã£ã¦ä½•ï¼ï¼Ÿã€']},
      {lines:['ãƒ«ã‚·ã‚¨ãƒ©ã€Œã‚«ã‚¤ãƒˆã€ã“ã®å®çŸ³ãã‚Œã„ã ã­ã€œã€','ã‚«ã‚¤ãƒˆã€ŒãŠã€è¦‹ã‚‹ç›®ã‚ã‚‹ã˜ã‚ƒã‚“ã€‚ã“ã‚Œçµæ§‹ãªå€¤æ‰“ã¡ã ãœã€','ãƒ«ã‚·ã‚¨ãƒ©ã€Œã‚ãŸã—æŒã£ã¦ã¦ã„ã„ï¼Ÿã€','ã‚«ã‚¤ãƒˆã€Œ...ã¾ã‚ã€ã„ã„ã‘ã©ã‚ˆã€']},
      {lines:['ã‚«ã‚¤ãƒˆã€ŒãŠå‰ã•ã€ã‚‚ã†ã¡ã‚‡ã„å‘¨ã‚Šè¦‹ã¦é­”æ³•æ’ƒã¦ã‚ˆã€‚å·»ãè¾¼ã¾ã‚Œã‚‹ã ã‚ã€','ãƒ«ã‚·ã‚¨ãƒ©ã€Œã”ã‚ã‚“ã­ã€œã€‚ã§ã‚‚ã‚«ã‚¤ãƒˆãªã‚‰é¿ã‘ã‚‰ã‚Œã‚‹ã§ã—ã‚‡ï¼Ÿã€','ã‚«ã‚¤ãƒˆã€Œä¿¡é ¼ã•ã‚Œã¦ã‚“ã®ã‹é›‘ã«æ‰±ã‚ã‚Œã¦ã‚“ã®ã‹...ã€']},
    ],
    // ãƒ­ã‚¤ãƒ‰ Ã— ãƒªãƒªã‚¢ãƒ¼ãƒï¼ˆæ‹æ„›ãƒšã‚¢ï¼‰
    'archer_m:priest_f': [
      {lines:['ãƒªãƒªã‚¢ãƒ¼ãƒã€Œãƒ­ã‚¤ãƒ‰ã€ã•ã£ãã®å°„æ’ƒã™ã”ã‹ã£ãŸã‚ã‚ˆã€','ãƒ­ã‚¤ãƒ‰ã€Œãˆ...æœ¬å½“ã§ã™ã‹ï¼ŸãŸã¾ãŸã¾ã§ã™...ã€','ãƒªãƒªã‚¢ãƒ¼ãƒã€Œã‚‚ã†ã€ç´ ç›´ã«å–œã³ãªã•ã„ã€','ãƒ­ã‚¤ãƒ‰ã€Œã¯ã€ã¯ã„...ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€']},
      {lines:['ãƒ­ã‚¤ãƒ‰ã€Œãƒªãƒªã‚¢ãƒ¼ãƒã•ã‚“ã€ã„ã¤ã‚‚æ°—ã«ã‹ã‘ã¦ãã‚Œã¦...ã€','ãƒªãƒªã‚¢ãƒ¼ãƒã€Œå½“ç„¶ã‚ˆã€‚ã‚ãªãŸã¯ç§ã®å¤§äº‹ãªä»²é–“ãªã‚“ã ã‹ã‚‰ã€','ãƒ­ã‚¤ãƒ‰ã€Œï¼ˆå¤§äº‹...ï¼‰...ã¯ã€ã¯ã„ï¼ã€']},
      {lines:['ãƒªãƒªã‚¢ãƒ¼ãƒã€Œã»ã‚‰ã€è‚©å‡ã£ã¦ã‚‹ã§ã—ã‚‡ï¼Ÿå¼“ä½¿ã„ã¯è‚©ãŒå‘½ã‚ˆã€','ãƒ­ã‚¤ãƒ‰ã€Œãˆã€ã‚ã€å¤§ä¸ˆå¤«ã§...ã„ãŸãŸãŸï¼ã€','ãƒªãƒªã‚¢ãƒ¼ãƒã€Œã»ã‚‰ã­ã€‚ã˜ã£ã¨ã—ã¦ã€']},
    ],
    // ã‚»ãƒ‰ãƒªãƒƒã‚¯ Ã— ã‚·ãƒ£ãƒ¼ãƒªã‚£ï¼ˆæ‹æ„›ãƒšã‚¢ï¼‰
    'priest_m:thief_f': [
      {lines:['ã‚»ãƒ‰ãƒªãƒƒã‚¯ã€Œã‚·ãƒ£ãƒ¼ãƒªã‚£æ®¿ã¯å¯¡é»™ã§ã™ã­ã€‚å«Œã„ã˜ã‚ƒãªã„ã§ã™ã‚ˆã€','ã‚·ãƒ£ãƒ¼ãƒªã‚£ã€Œ...ãã†ã€','ã‚»ãƒ‰ãƒªãƒƒã‚¯ã€Œã“ã†ã„ã†åå¿œã‚‚å«ã‚ã¦ã­ã€']},
      {lines:['ã‚·ãƒ£ãƒ¼ãƒªã‚£ã€Œ...ã‚ã‚“ãŸã€åƒ§ä¾¶ã®ãã›ã«æ¯’èˆŒã€','ã‚»ãƒ‰ãƒªãƒƒã‚¯ã€ŒãŠã‚„ã€çã—ãè©±ã—ã‹ã‘ã¦ãã‚Œã¾ã—ãŸã­ã€','ã‚·ãƒ£ãƒ¼ãƒªã‚£ã€Œ...å¾Œæ‚”ã—ãŸã€','ã‚»ãƒ‰ãƒªãƒƒã‚¯ã€Œã²ã©ã„ã€']},
      {lines:['ã‚»ãƒ‰ãƒªãƒƒã‚¯ã€Œæ€ªæˆ‘ã—ã¦ã„ã¾ã™ã­ã€‚è¦‹ã›ã¦ãã ã•ã„ã€','ã‚·ãƒ£ãƒ¼ãƒªã‚£ã€Œ...å¹³æ°—ã€','ã‚»ãƒ‰ãƒªãƒƒã‚¯ã€Œå¹³æ°—ãªé¡”ã—ã¦è¡€ãŒå‡ºã¦ã¾ã™ã‚ˆã€‚ã¯ã„ã€æ‰‹ã€','ã‚·ãƒ£ãƒ¼ãƒªã‚£ã€Œ............ã©ã†ã‚‚ã€']},
    ],
    // ã‚¢ãƒ‡ãƒ©ã‚¤ãƒ³ Ã— ã‚¨ãƒ«ãƒãƒ¼
    'knight_f:healer_m': [
      {lines:['ã‚¢ãƒ‡ãƒ©ã‚¤ãƒ³ã€Œã‚¨ãƒ«ãƒãƒ¼ã€ã‚ãŸãã—ã®é§ã«å‚·ãŒ...ç›´ã›ã¾ã™ã‹ï¼Ÿã€','ã‚¨ãƒ«ãƒãƒ¼ã€Œå‚·ã¯æ²»ã›ã‚‹ãŒé§ã¯å°‚é–€å¤–ã ãª...ã€','ã‚¢ãƒ‡ãƒ©ã‚¤ãƒ³ã€Œã¾ã‚...å†—è«‡ã§ã™ã‚ã€‚ãµãµã€']},
      {lines:['ã‚¨ãƒ«ãƒãƒ¼ã€Œã‚¢ãƒ‡ãƒ©ã‚¤ãƒ³ã€ç„¡èŒ¶ãªçªæ’ƒã¯ã‚„ã‚ã¦ãã‚Œã€‚å¿ƒè‡“ã«æ‚ªã„ã€','ã‚¢ãƒ‡ãƒ©ã‚¤ãƒ³ã€Œã‚ã‚‰ã€å¿ƒé…ã—ã¦ãã ã•ã‚‹ã®ï¼Ÿå¬‰ã—ã„ã§ã™ã‚ã€','ã‚¨ãƒ«ãƒãƒ¼ã€Œå…¨å“¡ã«è¨€ã£ã¦ã‚‹ã‚“ã ãŒ...ã€']},
    ],
    // ã‚¬ãƒ¬ã‚¹ Ã— ã‚¢ãƒ‡ãƒ©ã‚¤ãƒ³ï¼ˆåŒè·ï¼‰
    'knight_m:knight_f': [
      {lines:['ã‚¢ãƒ‡ãƒ©ã‚¤ãƒ³ã€Œã‚ãŸãã—ã®æ–¹ãŒä¸Šæ‰‹ãã‚„ã‚Œã¾ã™ã‚ã€','ã‚¬ãƒ¬ã‚¹ã€Œã»ã†ã€ã‚„ã£ã¦ã¿ã‚‹ãŒã„ã„ã€','ã‚¢ãƒ‡ãƒ©ã‚¤ãƒ³ã€Œæœ›ã‚€ã¨ã“ã‚ã§ã™ã‚ï¼ã€']},
      {lines:['ã‚¬ãƒ¬ã‚¹ã€Œã‚¢ãƒ‡ãƒ©ã‚¤ãƒ³ã€ãƒ•ã‚©ãƒ¼ãƒ ãŒç”˜ã„ã€','ã‚¢ãƒ‡ãƒ©ã‚¤ãƒ³ã€Œã‚ãªãŸã«è¨€ã‚ã‚ŒãŸãã‚ã‚Šã¾ã›ã‚“ã‚ã€‚åŠ›ä»»ã›ã®å‰£æŠ€ã®ãã›ã«ã€','ã‚¬ãƒ¬ã‚¹ã€Œ...ãã£ã€']},
      {lines:['ã‚¢ãƒ‡ãƒ©ã‚¤ãƒ³ã€ŒåŒã˜é¨å£«ã¨ã—ã¦ã€è² ã‘ãŸãã‚ã‚Šã¾ã›ã‚“ã®ã€','ã‚¬ãƒ¬ã‚¹ã€Œ...ä¿ºã‚‚ã ã€‚åˆ‡ç£‹ç¢ç£¨ã—ã‚ˆã†ã€','ã‚¢ãƒ‡ãƒ©ã‚¤ãƒ³ã€Œã¾ã‚...æ„å¤–ã¨ç´ ç›´ã§ã™ã®ã­ã€']},
    ],
  },

  // === æ‹æ„›æ®µéšåˆ¥æ›ã‘åˆã„ ===
  loveStage: {
    1: [ // æ°—ã«ãªã‚Šå§‹ã‚
      {lines:['{a}ã€Œ...ã•ã£ãã®æˆ¦é—˜ã€å¤§ä¸ˆå¤«ã ã£ãŸï¼Ÿã€','{b}ã€Œãˆï¼Ÿã†ã‚“...ã‚ã‚ŠãŒã¨ã†ã€æ°—ã«ã‹ã‘ã¦ãã‚Œã¦ã€']},
      {lines:['{a}ã€Œï¼ˆ...ãªã‚“ã‹æ°—ã«ãªã‚‹ãªã€ã‚ã„ã¤ã®ã“ã¨ï¼‰ã€','{b}ã€Œã©ã†ã—ãŸã®ï¼Ÿã¼ãƒ¼ã£ã¨ã—ã¦ã€','{a}ã€Œãªã€ãªã‚“ã§ã‚‚ãªã„ï¼ã€']},
      {lines:['{a}ã€Œã¯ã„ã€æ°´ã€‚å–‰ä¹¾ã„ãŸã§ã—ã‚‡ã€','{b}ã€Œ...ã‚ã‚ŠãŒã¨ã†ã€‚å„ªã—ã„ã­ã€','{a}ã€Œã¹ã€åˆ¥ã«æ™®é€šã ã‚ã€']},
    ],
    2: [ // æ„è­˜ã—ã¦ã„ã‚‹
      {lines:['{a}ã€Œãªã‚“ã‹æœ€è¿‘ã€{b}ã®ã“ã¨ç›®ã§è¿½ã£ã¡ã‚ƒã†ã‚“ã ã‚ˆãª...ã€','ä»–ãƒ¡ãƒ³ãƒãƒ¼ã€ŒçŸ¥ã£ã¦ã‚‹ã€','{a}ã€Œãˆ!?ã€']},
      {lines:['{a}ã€Œ{b}ã®éš£ã€ã„ã„ï¼Ÿã€','{b}ã€Œã‚‚ã¡ã‚ã‚“ã€‚...æœ€è¿‘ã„ã¤ã‚‚éš£ã ã­ã€','{a}ã€Œ...ãã†ã‹ãªã€']},
      {lines:['{b}ã€Œã‚ã®...{a}ã£ã¦ã€å¥½ããªäººã¨ã‹ã„ã‚‹ã®ï¼Ÿã€','{a}ã€Œãˆ...ï¼Ÿã„ããªã‚Šä½•...ã€','{b}ã€Œãªã€ãªã‚“ã§ã‚‚ãªã„ï¼å¿˜ã‚Œã¦ï¼ã€']},
    ],
    3: [ // æ‹ã«è½ã¡ãŸ
      {lines:['{a}ã€Œ{b}...å¥½ãã ã€','{b}ã€Œ...ã†ã‚“ã€‚çŸ¥ã£ã¦ãŸã€','ä»–ãƒ¡ãƒ³ãƒãƒ¼ã€ŒãŠå‰ã‚‰...ã„ã¡ã‚ƒã¤ããªã€']},
      {lines:['{a}ã€Œ{b}ã‚’å®ˆã‚‹ãŸã‚ãªã‚‰ä½•ã§ã‚‚ã™ã‚‹ã€','{b}ã€Œãƒã‚«...ä¸€ç·’ã«ç”Ÿãæ®‹ã‚‹ã®ã€','ä»–ãƒ¡ãƒ³ãƒãƒ¼ã€Œèã„ã¦ã‚‹ã“ã£ã¡ãŒæ¥ãšã‹ã—ã„ã‚“ã ã‘ã©ã€']},
    ],
  },

  // === åŒè·ãƒ©ã‚¤ãƒãƒ«æ›ã‘åˆã„ ===
  rivalry: {
    knight: [
      {lines:['{a}ã€Œé¨å£«ã®èª‡ã‚Šã«ã‹ã‘ã¦ã€ãŠå‰ã«ã¯è² ã‘ã‚“ã€','{b}ã€Œæœ›ã‚€ã¨ã“ã‚ã§ã™ã‚ã€‚ã“ã®å‰£ã«ã‹ã‘ã¦ã€']},
      {lines:['{a}ã€Œå‰è¡›ã¯ä¿ºãŒå®ˆã‚‹ã€','{b}ã€Œã„ã„ãˆã€ã‚ãŸãã—ãŒã€','{a}ã€Œ...äºŒäººã§å®ˆã‚Œã°ã„ã„ã ã‚ã†ã€','{b}ã€Œ...ãã‚Œã‚‚ãã†ã§ã™ã‚ã­ã€']},
    ],
    mage: [
      {lines:['{a}ã€Œé­”åŠ›åˆ¶å¾¡ã®ç²¾åº¦ã§ã¯è² ã‘ã‚“ãã€','{b}ã€Œãˆãƒ¼ã€ã§ã‚‚ã‚ãŸã—ã®æ–¹ãŒå¨åŠ›ã‚ã‚‹ã‚ˆï¼Ÿã€','{a}ã€Œå¨åŠ›ã ã‘ãŒé­”æ³•ã§ã¯ãªã„ã€']},
      {lines:['{a}ã€Œãƒ«ã‚·ã‚¨ãƒ©ã€è© å”±ã‚’ã¡ã‚ƒã‚“ã¨è¦šãˆã‚ã€','{b}ã€Œè¦šãˆã¦ã‚‹ã‚ˆï¼ãˆãƒ¼ã£ã¨...ã‚ã‚Œï¼Ÿã€','{a}ã€Œã»ã‚‰è¦‹ã‚ã€']},
    ],
    healer: [
      {lines:['{a}ã€Œå›å¾©é€Ÿåº¦ãªã‚‰ä¿ºã®æ–¹ãŒä¸Šã ã€','{b}ã€Œã§ã‚‚è–¬è‰ã®èª¿åˆã¯ã‚ãŸã—ã®æ–¹ãŒ...ã€','{a}ã€Œ...èªã‚ã‚‹ã€‚æ•™ãˆã¦ãã‚Œã€']},
      {lines:['{a}ã€Œãƒ•ã‚£ã‚ªãƒŠã€å°‘ã—ä¼‘ã‚ã€‚å›å¾©ã¯ä¿ºãŒã‚„ã‚‹ã€','{b}ã€Œã‚¨ãƒ«ãƒãƒ¼ã•ã‚“ã“ã...ãŠäº’ã„é ‘å›ºã§ã™ã­ã€']},
    ],
    thief: [
      {lines:['{a}ã€Œéµé–‹ã‘ã€ä¿ºã®æ–¹ãŒé€Ÿã„ãœã€','{b}ã€Œ...3ç§’ã€','{a}ã€Œã¯ï¼Ÿ3ç§’ã£ã¦...ãƒã‚¸ã‹ã‚ˆã€']},
      {lines:['{a}ã€Œã‚·ãƒ£ãƒ¼ãƒªã‚£ã€ãŸã¾ã«ã¯çµ„ã¾ã­ï¼Ÿé€£æºç›—è³Šã£ã¦ã‚„ã¤ã€','{b}ã€Œ...ä¸€äººã®æ–¹ãŒæ—©ã„ã€','{a}ã€Œãã•ã£ã€']},
    ],
    archer: [
      {lines:['{a}ã€Œã‚ã®çš„...ã„ã‚„ã€ã‚ã®æ•µã«å½“ã¦ã‚‰ã‚Œã‚‹ï¼Ÿã€','{b}ã€Œå½“ç„¶ï¼ã‚ãŸã—ã‚’èª°ã ã¨æ€ã£ã¦ã‚“ã®ï¼ã€','{a}ã€Œã˜ã‚ƒã‚åƒ•ã‚‚...å¤–ã•ãªã„ã€']},
      {lines:['{a}ã€Œã‚¨ãƒ¬ãƒŠã®é€Ÿå°„ã€ã™ã”ã„ã¨æ€ã†...ã€','{b}ã€Œãƒ­ã‚¤ãƒ‰ã®ç²¾å¯†ã•ã«ã¯ã‹ãªã‚ãªã„ã‚ã‚ˆã€‚ç´ ç›´ã«èªã‚ã‚‹ã€']},
    ],
    priest: [
      {lines:['{a}ã€Œç¥ˆã‚Šã®æ·±ã•ã§ã¯ç§ãŒä¸Šã§ã™ã‚ˆã€','{b}ã€Œã§ã‚‚ä¿¡è€…ã®æ•°ã§ã¯ç§ã®æ–¹ãŒå¤šã„ã‚ã‚ˆï¼Ÿã€','{a}ã€Œæ•°ã˜ã‚ƒãªã„ã‚“ã§ã™ã‘ã©ã­...ã€']},
      {lines:['{a}ã€Œãƒªãƒªã‚¢ãƒ¼ãƒæ®¿ã®ä¸–è©±ç„¼ãã€å¸ƒæ•™æ´»å‹•ã§ã™ã‹ï¼Ÿã€','{b}ã€Œã‚ãªãŸã®æ¯’èˆŒã“ãã€ä¿¡è€…æ¸›ã‚‰ã—ã¦ãªã„ï¼Ÿã€','{a}ã€Œ...ç—›ã„ã¨ã“ã‚ã‚’ã€']},
    ],
  },
};


// 12ã‚­ãƒ£ãƒ©ç”Ÿæˆ
const characters = [];
CLASSES.forEach(c => {
  GENDERS.forEach(g => {
    characters.push({
      uid: c.id+'_'+g.id,
      classId: c.id,
      className: c.name,
      icon: c.icon,
      gender: g.id,
      genderLabel: g.label,
      name: NAMES[c.id][g.id],
      baseHp: c.hp, atk: c.atk, def: c.def, spd: c.spd,
      desc: c.desc,
      personality: PERSONALITIES[c.id+'_'+g.id] || {},
    });
  });
});

// ===== éš ã—ç›¸æ€§ã‚·ã‚¹ãƒ†ãƒ  =====
// æ‹æ„›ãƒšã‚¢ï¼ˆç”·,å¥³ï¼‰â†’æ‹ã«è½ã¡ã‚„ã™ã„çµ„ã¿åˆã‚ã›
const LOVE_PAIRS = [
  ['knight_m','healer_f', 0.95],   // ã‚¬ãƒ¬ã‚¹Ã—ãƒ•ã‚£ã‚ªãƒŠï¼šã»ã¼ç¢ºå®š
  ['mage_m','archer_f', 0.9],     // ã‚¼ãƒãƒ³Ã—ã‚¨ãƒ¬ãƒŠ
  ['thief_m','mage_f', 0.85],     // ã‚«ã‚¤ãƒˆÃ—ãƒ«ã‚·ã‚¨ãƒ©
  ['archer_m','priest_f', 0.85],   // ãƒ­ã‚¤ãƒ‰Ã—ãƒªãƒªã‚¢ãƒ¼ãƒ
  ['priest_m','thief_f', 0.8],    // ã‚»ãƒ‰ãƒªãƒƒã‚¯Ã—ã‚·ãƒ£ãƒ¼ãƒªã‚£
  ['knight_f','healer_m', 0.75],  // ã‚¢ãƒ‡ãƒ©ã‚¤ãƒ³Ã—ã‚¨ãƒ«ãƒãƒ¼
  ['knight_m','mage_f', 0.6],     // ã‚¬ãƒ¬ã‚¹Ã—ãƒ«ã‚·ã‚¨ãƒ©
  ['knight_m','archer_f', 0.5],   // ã‚¬ãƒ¬ã‚¹Ã—ã‚¨ãƒ¬ãƒŠ
  ['thief_m','healer_f', 0.5],    // ã‚«ã‚¤ãƒˆÃ—ãƒ•ã‚£ã‚ªãƒŠ
  ['mage_m','thief_f', 0.45],     // ã‚¼ãƒãƒ³Ã—ã‚·ãƒ£ãƒ¼ãƒªã‚£
  ['archer_m','healer_f', 0.4],   // ãƒ­ã‚¤ãƒ‰Ã—ãƒ•ã‚£ã‚ªãƒŠ
];

// ã‚·ãƒŠã‚¸ãƒ¼ãƒœãƒ¼ãƒŠã‚¹
const SYNERGIES = [
  {members:['knight','healer'], name:'é‰„å£ã®å®ˆè­·', effect:'defUp', value:15, msg:'ã®é˜²å¾¡ãŒé€£æºã§å¼·åŒ–ã•ã‚ŒãŸï¼'},
  {members:['mage','priest'], name:'é­”åŠ›å¢—å¹…', effect:'atkUp', value:20, msg:'ã®é­”åŠ›ãŒå…±é³´ã—ã¦å¢—å¹…ã•ã‚ŒãŸï¼'},
  {members:['thief','archer'], name:'ç–¾é¢¨ã®é€£æ’ƒ', effect:'spdUp', value:10, msg:'ã®é€£æºæ”»æ’ƒãŒç‚¸è£‚ï¼'},
  {members:['knight','priest'], name:'è–ãªã‚‹ç›¾', effect:'defUp', value:10, msg:'ã«è–ãªã‚‹åŠ è­·ãŒå®¿ã£ãŸï¼'},
  {members:['healer','priest'], name:'ç¥ç¦ã®äºŒé‡å¥', effect:'healUp', value:1.5, msg:'ã®å›å¾©åŠ›ãŒå€å¢—ã—ãŸï¼'},
];

// ===== ãƒ†ã‚­ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ =====
function pick(arr) { return arr[Math.floor(Math.random()*arr.length)]; }

const TEXTS = {
  // === æ•µå‡ºç¾ ===
  monsterAppear: {
    'ã‚´ãƒ–ãƒªãƒ³ã®ç¾¤ã‚Œ': [
      'è–„æš—ã„é€šè·¯ã‹ã‚‰ã‚´ãƒ–ãƒªãƒ³ã®ç¾¤ã‚ŒãŒé£›ã³å‡ºã—ã¦ããŸï¼',
      'ã‚²ãƒ©ã‚²ãƒ©ã¨ä¸‹å“ãªç¬‘ã„å£°ãŒéŸ¿ãã€‚ã‚´ãƒ–ãƒªãƒ³ã®ç¾¤ã‚Œã ï¼',
      'è¶³å…ƒã®ã‚´ãƒŸã‚’æ¼ã£ã¦ã„ãŸã‚´ãƒ–ãƒªãƒ³ãŸã¡ãŒã“ã¡ã‚‰ã«æ°—ã¥ã„ãŸï¼',
      'ã„ãŸã‚‹ã¨ã“ã‚ã‹ã‚‰ã‚´ãƒ–ãƒªãƒ³ãŒæ¹§ã„ã¦å‡ºãŸï¼å›²ã¾ã‚Œã¦ã„ã‚‹ï¼',
      'ã€Œã‚®ã‚®ã‚®ãƒƒï¼ã€ã‚´ãƒ–ãƒªãƒ³ã®ç¾¤ã‚ŒãŒæ­¦å™¨ã‚’æ§‹ãˆã¦ç¾ã‚ŒãŸï¼',
      'è…ã£ãŸé£Ÿã¹ç‰©ã®è‡­ã„ã¨ã¨ã‚‚ã«ã‚´ãƒ–ãƒªãƒ³ã®ç¾¤ã‚ŒãŒç¾ã‚ŒãŸï¼',
    ],
    'ã‚¹ã‚±ãƒ«ãƒˆãƒ³æˆ¦å£«': [
      'éª¨ã®è»‹ã‚€éŸ³ã¨ã¨ã‚‚ã«ã‚¹ã‚±ãƒ«ãƒˆãƒ³æˆ¦å£«ãŒç«‹ã¡ä¸ŠãŒã£ãŸï¼',
      'å£ã«å¯„ã‚Šã‹ã‹ã£ã¦ã„ãŸéª¸éª¨ãŒçªç„¶å‹•ãå‡ºã—ãŸï¼',
      'å¤ã³ãŸé§ã‚’ã¾ã¨ã£ãŸã‚¹ã‚±ãƒ«ãƒˆãƒ³æˆ¦å£«ãŒå‰£ã‚’æŠœã„ãŸï¼',
      'åœ°é¢ã®éª¨ãŒé›†ã¾ã‚Šã€ã‚¹ã‚±ãƒ«ãƒˆãƒ³æˆ¦å£«ãŒå½¢ã‚’æˆã—ãŸï¼',
      'ã€Œã‚«ã‚¿ã‚«ã‚¿ã‚«ã‚¿...ã€ä¸æ°—å‘³ãªéŸ³ã‚’ç«‹ã¦ã¦ã‚¹ã‚±ãƒ«ãƒˆãƒ³æˆ¦å£«ãŒè¿‘ã¥ã„ã¦ãã‚‹ï¼',
      'ã‹ã¤ã¦ã®å†’é™ºè€…ã ã£ãŸã®ã‹ã€ã‚¹ã‚±ãƒ«ãƒˆãƒ³æˆ¦å£«ãŒè¡Œãæ‰‹ã‚’é˜»ã‚€ï¼',
    ],
    'ã‚ªãƒ¼ã‚¯': [
      'å·¨å¤§ãªã‚ªãƒ¼ã‚¯ãŒé›„å«ã³ã‚’ä¸Šã’ã¦çªé€²ã—ã¦ããŸï¼',
      'ãƒ‰ã‚¹ãƒ³ãƒ‰ã‚¹ãƒ³ã¨åœ°éŸ¿ããŒï¼ã‚ªãƒ¼ã‚¯ã ï¼',
      'ã€Œã‚°ã‚ªã‚ªã‚©ã‚©ï¼ã€ç­‹éª¨éš†ã€…ã®ã‚ªãƒ¼ã‚¯ãŒæ£æ£’ã‚’æŒ¯ã‚Šå›ã—ã¦ã„ã‚‹ï¼',
      'é£Ÿäº‹ä¸­ã ã£ãŸã‚ªãƒ¼ã‚¯ãŒã“ã¡ã‚‰ã«æ°—ã¥ãã€æ€’ã‚Šã®å½¢ç›¸ã§ç«‹ã¡ä¸ŠãŒã£ãŸï¼',
      'å£ã®é™°ã‹ã‚‰å·¨ä½“ã®ã‚ªãƒ¼ã‚¯ãŒã¬ã£ã¨ç¾ã‚ŒãŸï¼',
      'ã‚ªãƒ¼ã‚¯ãŒé¼»ã‚’ã²ãã²ãã•ã›ãªãŒã‚‰è¿‘ã¥ã„ã¦ãã‚‹ã€‚ç²ç‰©ã‚’è¦‹ã¤ã‘ãŸã‚ˆã†ã ï¼',
    ],
    'ãƒ€ãƒ¼ã‚¯ã‚¨ãƒ«ãƒ•': [
      'é—‡ã®ä¸­ã‹ã‚‰å¦–ã—ãå…‰ã‚‹ç³ã€‚ãƒ€ãƒ¼ã‚¯ã‚¨ãƒ«ãƒ•ã ï¼',
      'å£ã¨ä¸€ä½“åŒ–ã—ã¦ã„ãŸãƒ€ãƒ¼ã‚¯ã‚¨ãƒ«ãƒ•ãŒå§¿ã‚’ç¾ã—ãŸï¼',
      'å˜²ç¬‘ã†ã‚ˆã†ã«ãƒ€ãƒ¼ã‚¯ã‚¨ãƒ«ãƒ•ãŒçŸ­å‰£ã‚’æ§‹ãˆã¦ã„ã‚‹ï¼',
      'ã€Œæ„šã‹ãªåœ°ä¸Šã®è€…ã‚...ã€ãƒ€ãƒ¼ã‚¯ã‚¨ãƒ«ãƒ•ãŒå†·ãŸãç¬‘ã£ãŸï¼',
      'å¤©äº•ã‹ã‚‰éŸ³ã‚‚ãªããƒ€ãƒ¼ã‚¯ã‚¨ãƒ«ãƒ•ãŒé™ã‚Šç«‹ã£ãŸï¼',
      'é­”æ³•ã®æ°—é…ã¨ã¨ã‚‚ã«ãƒ€ãƒ¼ã‚¯ã‚¨ãƒ«ãƒ•ãŒé—‡ã‹ã‚‰æµ®ã‹ã³ä¸ŠãŒã£ãŸï¼',
    ],
    'ãƒŸãƒã‚¿ã‚¦ãƒ­ã‚¹': [
      'å·¨å¤§ãªãƒŸãƒã‚¿ã‚¦ãƒ­ã‚¹ãŒé€šè·¯ã‚’å¡ã„ã§ã„ã‚‹ï¼',
      'è¹„ã®éŸ³ãŒè¿‘ã¥ã„ã¦ãã‚‹...ãƒŸãƒã‚¿ã‚¦ãƒ­ã‚¹ã ï¼é€ƒã’å ´ã¯ãªã„ï¼',
      'ã€Œãƒ–ãƒ¢ã‚ªã‚ªã‚ªï¼ã€ãƒŸãƒã‚¿ã‚¦ãƒ­ã‚¹ã®å’†å“®ãŒæ´çªŸã«éŸ¿ãæ¸¡ã£ãŸï¼',
      'è¡€ã¾ã¿ã‚Œã®å¤§æ–§ã‚’æŒã£ãŸãƒŸãƒã‚¿ã‚¦ãƒ­ã‚¹ãŒå¾…ã¡æ§‹ãˆã¦ã„ãŸï¼',
      'è§’ã‚’å…‰ã‚‰ã›ãŸãƒŸãƒã‚¿ã‚¦ãƒ­ã‚¹ãŒã“ã¡ã‚‰ã‚’ç¨ã¿ã¤ã‘ã¦ã„ã‚‹ï¼',
    ],
    'ãƒ¯ã‚¤ãƒãƒ¼ãƒ³': [
      'ç¿¼ã‚’åºƒã’ãŸãƒ¯ã‚¤ãƒãƒ¼ãƒ³ãŒä¸Šç©ºã‹ã‚‰æ€¥é™ä¸‹ã—ã¦ããŸï¼',
      'ã€Œã‚®ãƒ£ã‚¢ã‚¢ã‚¢ï¼ã€ãƒ¯ã‚¤ãƒãƒ¼ãƒ³ã®ç”²é«˜ã„å«ã³ãŒé¼“è†œã‚’çªãï¼',
      'å¤©äº•ã®å¤§ç©´ã‹ã‚‰ãƒ¯ã‚¤ãƒãƒ¼ãƒ³ãŒé£›æ¥ã—ãŸï¼',
      'æ¯’ã®æ»´ã‚‹å°¾ã‚’æŒ¯ã‚Šå›ã™ãƒ¯ã‚¤ãƒãƒ¼ãƒ³ãŒè¡Œãæ‰‹ã‚’é®ã‚‹ï¼',
      'å·£ã‚’è’ã‚‰ã•ã‚ŒãŸã¨æ€ã£ãŸã®ã‹ã€ãƒ¯ã‚¤ãƒãƒ¼ãƒ³ãŒæ€’ã‚Šã«ç‡ƒãˆã¦ã„ã‚‹ï¼',
    ],
    'ãƒªãƒƒãƒ': [
      'ç©ºæ°—ãŒå‡ã‚Šã¤ãã€‚ãƒªãƒƒãƒã®ç¦ã€…ã—ã„ã‚ªãƒ¼ãƒ©ãŒå……æº€ã—ã¦ã„ã‚‹ï¼',
      'ã€Œç”Ÿè€…ã‚ˆ...æ°¸é ã®çœ ã‚Šã‚’æˆã‘ã‚ˆã†ã€ãƒªãƒƒãƒãŒæ–ã‚’æ²ã’ãŸï¼',
      'æœ½ã¡ãŸç‹å† ã‚’è¢«ã£ãŸãƒªãƒƒãƒãŒè™šã‚ãªç›®ã§ã“ã¡ã‚‰ã‚’è¦‹ã¦ã„ã‚‹ï¼',
      'é­”åŠ›ã®å¥”æµã¨ã¨ã‚‚ã«ãƒªãƒƒãƒãŒç©ºé–“ã‚’æ­ªã‚ã¦ç¾ã‚ŒãŸï¼',
      'æ­»ã®æ°—é…ãŒæ¿ƒããªã‚‹...ãƒªãƒƒãƒã ï¼ç”Ÿå‘½åŠ›ãŒå¸ã„å–ã‚‰ã‚Œãã†ã ï¼',
    ],
    'ãƒ‰ãƒ©ã‚´ãƒ³': [
      'ã€Œã‚°ã‚ªã‚ªã‚ªã‚ªï¼ã€æ´çªŸå…¨ä½“ãŒæºã‚Œã‚‹ã€‚ãƒ‰ãƒ©ã‚´ãƒ³ã ï¼ï¼',
      'ç¼ç†±ã®æ¯å¹ãŒé€šè·¯ã‚’ç„¦ãŒã™ã€‚ãƒ‰ãƒ©ã‚´ãƒ³ãŒç¾ã‚ŒãŸï¼',
      'ä¼èª¬ã®å¤ç«œãŒé»„é‡‘ã®ç³ã§ã“ã¡ã‚‰ã‚’è¦‹æ®ãˆã¦ã„ã‚‹ï¼',
      'åœ§å€’çš„ãªå­˜åœ¨æ„Ÿã€‚ãƒ‰ãƒ©ã‚´ãƒ³ãŒç¿¼ã‚’åºƒã’ã¦å¨åš‡ã—ã¦ã„ã‚‹ï¼',
      'å…¨èº«ã‚’è¦†ã†é‹¼ã®ã‚ˆã†ãªé±—ã€‚ãƒ‰ãƒ©ã‚´ãƒ³ã¨ã®æ­»é—˜ãŒå§‹ã¾ã‚‹ï¼',
    ],
    'ãƒ‡ãƒ¼ãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ‰': [
      'åœ°ç„ã®è£‚ã‘ç›®ã‹ã‚‰ãƒ‡ãƒ¼ãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ‰ãŒé™è‡¨ã—ãŸï¼',
      'ã€Œãƒãƒãƒãƒ...é¢ç™½ã„ç©å…·ãŒæ¥ãŸã‚‚ã®ã ã€ãƒ‡ãƒ¼ãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ‰ãŒå—¤ã†ï¼',
      'ç¦ã€…ã—ã„ã‚ªãƒ¼ãƒ©ã«å…¨èº«ãŒéœ‡ãˆã‚‹ã€‚ãƒ‡ãƒ¼ãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ‰ã ï¼',
      'é—‡ã®ç‚ã‚’çºã£ãŸãƒ‡ãƒ¼ãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ‰ãŒç‰åº§ã‹ã‚‰ç«‹ã¡ä¸ŠãŒã£ãŸï¼',
      'ç©ºé–“ãŒæ­ªã¿ã€ç•°ç•Œã‹ã‚‰ãƒ‡ãƒ¼ãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ‰ãŒå¬å–šã•ã‚ŒãŸï¼',
    ],
    'æ·±æ·µã®ä½¿å¾’': [
      'å­˜åœ¨ãã®ã‚‚ã®ãŒæ­ªã‚“ã§ã„ã‚‹...æ·±æ·µã®ä½¿å¾’ã ï¼æ­£æ°—ã‚’ä¿ã¦ï¼',
      'ã€Œæˆ‘ã¯è™šç„¡ãªã‚Šã€æ·±æ·µã®ä½¿å¾’ã®å£°ãŒç›´æ¥é ­ã«éŸ¿ãï¼',
      'ç¾å®ŸãŒå´©å£Šã—ã¦ã„ãæ„Ÿè¦š...æ·±æ·µã®ä½¿å¾’ãŒé¡•ç¾ã—ãŸï¼',
      'è¦‹ã¦ã¯ã„ã‘ãªã„ã‚‚ã®ã‚’è¦‹ã¦ã—ã¾ã£ãŸã€‚æ·±æ·µã®ä½¿å¾’ãŒãã“ã«ã„ã‚‹ï¼',
      'ä¸–ç•Œã®è£å´ã‹ã‚‰é€™ã„å‡ºã‚‹ã‚ˆã†ã«ã€æ·±æ·µã®ä½¿å¾’ãŒå§¿ã‚’ç¾ã—ãŸï¼',
    ],
    _default: [
      'å‰æ–¹ã«æ•µã®æ°—é…ï¼{name}ãŒç¾ã‚ŒãŸï¼',
      '{name}ã ï¼æ­¦å™¨ã‚’æ§‹ãˆã‚ï¼',
      '{name}ãŒè¡Œãæ‰‹ã‚’é˜»ã‚“ã§ã„ã‚‹ï¼',
      'é€šè·¯ã®å…ˆã«{name}ã®å§¿ãŒï¼æˆ¦é—˜é–‹å§‹ï¼',
      'ä¸æ„æ‰“ã¡ã ï¼{name}ãŒè¥²ã„ã‹ã‹ã£ã¦ããŸï¼',
    ],
  },

  // === æ”»æ’ƒãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆè·æ¥­åˆ¥ï¼‰ ===
  attack: {
    knight: [
      '{name}ãŒå¤§å‰£ã‚’åŠ›å¼·ãæŒ¯ã‚Šä¸‹ã‚ã—ãŸï¼',
      '{name}ãŒç›¾ã§æŠ¼ã—è¾¼ã¿ã€è¿”ã™åˆ€ã§æ–¬ã‚Šã¤ã‘ãŸï¼',
      '{name}ãŒæ¸¾èº«ã®çªãã‚’æ”¾ã£ãŸï¼',
      '{name}ãŒé§ã”ã¨ä½“å½“ãŸã‚Šã§å¹ãé£›ã°ã—ãŸï¼',
      '{name}ãŒéš™ã‚’è¦‹ã¦å…œå‰²ã‚Šã‚’å©ãè¾¼ã‚“ã ï¼',
      '{name}ãŒç›¾ã§å—ã‘æ­¢ã‚ã¦ã‹ã‚‰ã®ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ï¼',
      '{name}ãŒé›„å«ã³ã¨ã¨ã‚‚ã«é€£ç¶šæ–¬ã‚Šã‚’æµ´ã³ã›ãŸï¼',
      '{name}ãŒå‰£ã‚’å›è»¢ã•ã›ã€è–™ãæ‰•ã£ãŸï¼',
    ],
    mage: [
      '{name}ãŒç‚ã®é­”æ³•ã‚’æ”¾ã£ãŸï¼è½ŸéŸ³ã¨ã¨ã‚‚ã«çˆ†ç™ºï¼',
      '{name}ãŒæ°·ã®æ§ã‚’ç”Ÿæˆã—ã¦æ’ƒã¡å‡ºã—ãŸï¼',
      '{name}ãŒé›·æ’ƒã‚’å‘¼ã³å¯„ã›ãŸï¼ç¨²å¦»ãŒèµ°ã‚‹ï¼',
      '{name}ãŒé—‡ã®å¥”æµã‚’è§£ãæ”¾ã£ãŸï¼',
      '{name}ãŒé­”åŠ›ã‚’å‡ç¸®ã—ãŸå…‰å¼¾ã‚’é€£å°„ã—ãŸï¼',
      '{name}ãŒæŒ‡å…ˆã‹ã‚‰ç¼ç†±ã®ç«ç·šã‚’æ”¾ã£ãŸï¼',
      '{name}ãŒé‡åŠ›é­”æ³•ã§æ•µã‚’åœ°é¢ã«å©ãã¤ã‘ãŸï¼',
      '{name}ãŒç©ºé–“ã‚’åˆ‡ã‚Šè£‚ãé­”æ³•ã‚’å”±ãˆãŸï¼',
    ],
    healer: [
      '{name}ãŒè–ãªã‚‹å…‰ã§æ”»æ’ƒã—ãŸï¼',
      '{name}ãŒæµ„åŒ–ã®å…‰ã‚’æ”¾ã£ãŸï¼é—‡ã®å­˜åœ¨ã«åŠ¹æœæŠœç¾¤ï¼',
      '{name}ãŒè–æ–ã§æ€ã„åˆ‡ã‚Šæ®´ã£ãŸï¼æ„å¤–ã¨ç—›ã„ï¼',
      '{name}ãŒç¥ˆã‚Šã®åŠ›ã‚’æ”»æ’ƒã«å¤‰ãˆã¦æ”¾ã£ãŸï¼',
      '{name}ãŒè–æ°´ã‚’æŠ•ã’ã¤ã‘ãŸï¼ã‚¸ãƒ¥ã‚¦ãƒƒã¨éŸ³ãŒã™ã‚‹ï¼',
      '{name}ãŒç™’ã—ã®åŠ›ã‚’é€†è»¢ã•ã›ã¦è‹¦ç—›ã®æ³¢å‹•ã‚’æ”¾ã£ãŸï¼',
    ],
    thief: [
      '{name}ãŒèƒŒå¾Œã«å›ã‚Šè¾¼ã¿æ€¥æ‰€ã‚’çªã„ãŸï¼',
      '{name}ãŒç´ æ—©ã„é€£æ’ƒã‚’å©ãè¾¼ã‚“ã ï¼',
      '{name}ãŒå½±ã‹ã‚‰é£›ã³å‡ºã—ã€ä¸€é–ƒï¼',
      '{name}ãŒæ¯’ã‚’å¡—ã£ãŸçŸ­å‰£ã§æ–¬ã‚Šã¤ã‘ãŸï¼',
      '{name}ãŒç›®ã«ã‚‚æ­¢ã¾ã‚‰ã¬é€Ÿã•ã§ä¸‰é€£æ’ƒï¼',
      '{name}ãŒæ•µã®è¶³å…ƒã‚’æ¬ã„ã€ã‚ˆã‚ã‚ã„ãŸéš™ã«ä¸€çªãï¼',
      '{name}ãŒç…™å¹•ã‚’æŠ•ã’ã¦ã‹ã‚‰ã®å¥‡è¥²æ”»æ’ƒï¼',
      '{name}ãŒäºŒåˆ€æµã§é«˜é€Ÿã®ä¹±èˆã‚’ç¹°ã‚Šå‡ºã—ãŸï¼',
    ],
    archer: [
      '{name}ãŒæ­£ç¢ºãªä¸€çŸ¢ã‚’æ”¾ã£ãŸï¼æ€¥æ‰€ã«å‘½ä¸­ï¼',
      '{name}ãŒçŸ¢ã®é›¨ã‚’é™ã‚‰ã›ãŸï¼é€ƒã’å ´ã¯ãªã„ï¼',
      '{name}ãŒé¢¨ã‚’èª­ã¿ã€å®Œç’§ãªä¸€å°„ã‚’æ”¾ã£ãŸï¼',
      '{name}ãŒç«çŸ¢ã‚’æ”¾ã£ãŸï¼æ•µãŒç‡ƒãˆä¸ŠãŒã‚‹ï¼',
      '{name}ãŒè·³å¼¾ã™ã‚‹é­”æ³•ã®çŸ¢ã‚’æ”¾ã£ãŸï¼',
      '{name}ãŒä¸‰æœ¬åŒæ™‚ã«çŸ¢ã‚’ã¤ãŒãˆã¦å°„ã£ãŸï¼',
      '{name}ãŒè‡³è¿‘è·é›¢ã‹ã‚‰çŸ¢ã‚’æ”¾ã£ãŸï¼è²«é€šã—ãŸï¼',
      '{name}ãŒå¼±ç‚¹ã‚’è¦‹æŠœãã€ç²¾å¯†å°„æ’ƒã‚’å©ãè¾¼ã‚“ã ï¼',
    ],
    priest: [
      '{name}ãŒè–ãªã‚‹è£ãã‚’ä¸‹ã—ãŸï¼å…‰ãŒæ•µã‚’åŒ…ã‚€ï¼',
      '{name}ãŒçµŒå…¸ã‚’å”±ãˆã€æµ„åŒ–ã®æ³¢å‹•ã‚’æ”¾ã£ãŸï¼',
      '{name}ãŒè–å°ã‚’åˆ»ã‚“ã éŒ«æ–ã§æ‰“ã¡æ®ãˆãŸï¼',
      '{name}ãŒå¤©ç½°ã®é›·ã‚’é™ã‚Šæ³¨ãŒã›ãŸï¼',
      '{name}ãŒé­”ã‚’ç¥“ã†çµç•Œã§æ•µã‚’ç· ã‚ä¸Šã’ãŸï¼',
      '{name}ãŒç¥ç¦ã‚’åè»¢ã•ã›ã€å‘ªã„ã®è¨€è‘‰ã‚’æ”¾ã£ãŸï¼',
    ],
  },

  // === å‹åˆ© ===
  victory: [
    'ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã®å‹åˆ©ï¼{name}ã‚’æ‰“ã¡å€’ã—ãŸï¼',
    '{name}ã¯å¡µã¨ãªã£ã¦æ¶ˆãˆãŸã€‚å‹åˆ©ã ï¼',
    'è¦‹äº‹ï¼{name}ã‚’æ’ƒç ´ã—ãŸï¼',
    '{name}ã‚’é€€ã‘ãŸï¼ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã®é€£æºãŒå…‰ã‚‹ï¼',
    '{name}ã¯æ–­æœ«é­”ã‚’ä¸Šã’ã¦å´©ã‚Œè½ã¡ãŸï¼',
    'æ¿€ã—ã„æˆ¦ã„ã®æœ«ã€{name}ã‚’è¨ä¼ã—ãŸï¼',
    '{name}ã¯åŠ›å°½ãã€é—‡ã«æº¶ã‘ã¦ã„ã£ãŸ...',
    'è¾›ãã‚‚å‹åˆ©ï¼{name}ã‚’å€’ã—ãŸï¼',
  ],

  // === æ•µã®åæ’ƒ ===
  counterattack: [
    '{name}ã®å‡¶æ‚ªãªåæ’ƒï¼',
    '{name}ãŒæ€’ã‚Šã«ä»»ã›ã¦æš´ã‚Œå›ã‚‹ï¼',
    '{name}ãŒéš™ã‚’çªã„ã¦è¥²ã„ã‹ã‹ã£ã¦ããŸï¼',
    '{name}ã®çŒ›æ”»ãŒæ­¢ã¾ã‚‰ãªã„ï¼',
    '{name}ãŒç‰™ã‚’å‰¥ã„ãŸï¼',
    'æ²¹æ–­ã™ã‚‹ãªï¼{name}ãŒã¾ã å‹•ã„ã¦ã„ã‚‹ï¼',
  ],

  // === è¢«ãƒ€ãƒ¡ãƒ¼ã‚¸ ===
  takeDamage: [
    '{name}ã«{dmg}ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼ç—›æ¨ã®ä¸€æ’ƒï¼',
    '{name}ãŒ{dmg}ã®ãƒ€ãƒ¡ãƒ¼ã‚¸ã‚’å—ã‘ãŸï¼',
    '{name}ã«{dmg}ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼æ­¯ã‚’é£Ÿã„ã—ã°ã£ã¦è€ãˆã‚‹ï¼',
    '{name}ãŒå¹ãé£›ã°ã•ã‚ŒãŸï¼{dmg}ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼',
    '{name}ã«{dmg}ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼é§ãŒè»‹ã‚€éŸ³ãŒã™ã‚‹ï¼',
    '{name}ãŒ{dmg}ã®ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼ã¾ã ç«‹ã£ã¦ã„ã‚‹ï¼',
    '{name}ã«ç›´æ’ƒï¼{dmg}ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼',
    '{name}ãŒè‹¦ç—›ã«é¡”ã‚’æ­ªã‚ãŸã€‚{dmg}ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼',
  ],

  // === æ•µé€ƒèµ° ===
  monsterFlee: [
    '{name}ã¯å½¢å‹¢ä¸åˆ©ã¨è¦‹ã¦é€ƒã’å»ã£ãŸ',
    '{name}ã¯é—‡ã®ä¸­ã«å§¿ã‚’æ¶ˆã—ãŸ...',
    '{name}ã¯é€™ã†é€™ã†ã®ä½“ã§é€ƒã’ã¦ã„ã£ãŸ',
    'å‚·ã ã‚‰ã‘ã®{name}ã¯æ’¤é€€ã—ã¦ã„ã£ãŸ',
    '{name}ã¯æ¨ã¦å°è©ã‚’åã„ã¦é€ƒèµ°ã—ãŸ',
  ],

  // === å›å¾© ===
  heal: [
    '{healer}ãŒ{target}ã«ç™’ã—ã®å…‰ã‚’æ³¨ã„ã ï¼{val}å›å¾©ï¼',
    '{healer}ã®æ¸©ã‹ãªé­”æ³•ãŒ{target}ã‚’åŒ…ã‚€ã€‚{val}å›å¾©ï¼',
    '{healer}ãŒ{target}ã®å‚·ã«æ‰‹ã‚’ã‹ã–ã—ãŸã€‚{val}å›å¾©ï¼',
    'ã€Œã¾ã å€’ã‚Œãªã„ã§ï¼ã€{healer}ãŒ{target}ã‚’{val}å›å¾©ã—ãŸï¼',
    '{healer}ã®ç¥ˆã‚ŠãŒ{target}ã«å±Šã„ãŸã€‚{val}å›å¾©ï¼',
    '{healer}ãŒå›å¾©é­”æ³•ã‚’å”±ãˆãŸï¼{target}ã®HPãŒ{val}å›å¾©ï¼',
    'æŸ”ã‚‰ã‹ãªç·‘ã®å…‰ãŒ{target}ã‚’ç™’ã™ã€‚{healer}ã®å›å¾©ã§{val}å›å¾©ï¼',
    'ã€Œå¤§ä¸ˆå¤«ã€ç§ãŒã¤ã„ã¦ã‚‹ã€{healer}ãŒ{target}ã‚’{val}å›å¾©ã•ã›ãŸï¼',
  ],

  // === åƒ§ä¾¶ãƒãƒ• ===
  priestBuff: [
    '{priest}ãŒ{target}ã«å®ˆè­·ã®ç¥ˆã‚Šã‚’æ§ã’ãŸï¼é˜²å¾¡+{val}ï¼',
    '{priest}ã®è–ãªã‚‹è© å”±ãŒ{target}ã‚’å¼·åŒ–ã—ãŸï¼é˜²å¾¡+{val}ï¼',
    '{priest}ãŒ{target}ã«åŠ è­·ã®ç´‹ç« ã‚’åˆ»ã‚“ã ï¼é˜²å¾¡+{val}ï¼',
    'ã€Œç¥ã‚ˆã€ã“ã®è€…ã‚’ãŠå®ˆã‚Šãã ã•ã„ã€{priest}ã®ç¥ç¦ã§{target}ã®é˜²å¾¡+{val}ï¼',
    '{priest}ãŒ{target}ã®é§ã«è–åˆ¥ã®å„€å¼ã‚’æ–½ã—ãŸï¼é˜²å¾¡+{val}ï¼',
    '{priest}ãŒè–æ°´ã‚’æŒ¯ã‚Šã‹ã‘ã€{target}ã®é˜²å¾¡åŠ›ã‚’+{val}é«˜ã‚ãŸï¼',
    'ã€Œæ±ã«é‰„å£ã®å®ˆã‚Šã‚’ã€{priest}ã®è© å”±ã§{target}ã®é˜²å¾¡+{val}ï¼',
    '{priest}ãŒå…‰ã®éšœå£ã‚’{target}ã®å‘¨å›²ã«å±•é–‹ã—ãŸï¼é˜²å¾¡+{val}ï¼',
  ],

  // === ç½ ç™ºè¦‹ ===
  trapFound: [
    'ç½ ã ï¼{trap}ã‚’ç™ºè¦‹ï¼{thief}ãŒé®®ã‚„ã‹ãªæ‰‹ã¤ãã§è§£é™¤ã—ãŸï¼',
    '{thief}ãŒ{trap}ã«ã„ã¡æ—©ãæ°—ã¥ã„ãŸï¼ã€Œä»»ã›ã¦ï¼ã€è¯éº—ã«è§£é™¤ï¼',
    '{thief}ã®é‹­ã„ç›®ãŒ{trap}ã‚’è¦‹æŠœã„ãŸã€‚æ…£ã‚ŒãŸæ‰‹ã¤ãã§è§£é™¤å®Œäº†ï¼',
    'ã€Œå±ãªã„ï¼ã€{thief}ãŒãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã‚’æ­¢ã‚ãŸã€‚{trap}ã ï¼å³åº§ã«è§£é™¤ï¼',
    '{thief}ãŒåœ°é¢ã®å¾®å¦™ãªé•å’Œæ„Ÿã«æ°—ã¥ã„ãŸã€‚{trap}ã‚’è¦‹äº‹ã«è§£é™¤ï¼',
    'ã€Œã“ã†ã„ã†ã®ã¯å¾—æ„ãªã‚“ã ã€{thief}ãŒ{trap}ã‚’ã‚ã£ã•ã‚Šè§£é™¤ã—ãŸï¼',
    '{thief}ãŒé“å…·ã‚’å–ã‚Šå‡ºã—ã€{trap}ã‚’æ‰‹éš›ã‚ˆãç„¡åŠ›åŒ–ã—ãŸï¼',
    'ã€Œãµãµã‚“ã€ã“ã‚“ãªã®æœé£¯å‰ã€{thief}ãŒ{trap}ã‚’è§£é™¤ã—ã¦ãƒ‰ãƒ¤é¡”ï¼',
  ],

  // === ç½ ç™ºå‹• ===
  trapTriggered: [
    'ğŸ’¥ {trap}ãŒä½œå‹•ã—ãŸï¼é€ƒã’ã‚ï¼',
    'ğŸ’¥ ã‚«ãƒãƒƒ...ã¾ãšã„ï¼{trap}ã ï¼',
    'ğŸ’¥ ã€Œã—ã¾ã£ãŸï¼ã€{trap}ã«å¼•ã£ã‹ã‹ã£ãŸï¼',
    'ğŸ’¥ åœ°é¢ãŒå…‰ã£ãŸç¬é–“ã€{trap}ãŒç™ºå‹•ï¼',
    'ğŸ’¥ èª°ã‹ãŒè¸ã‚“ã§ã—ã¾ã£ãŸï¼{trap}ãŒèµ·å‹•ï¼',
    'ğŸ’¥ å£ã‹ã‚‰{trap}ãŒé£›ã³å‡ºã—ãŸï¼',
    'ğŸ’¥ å¤©äº•ã«ä»•æ›ã‘ã‚‰ã‚Œã¦ã„ãŸ{trap}ãŒä½œå‹•ã—ãŸï¼',
  ],

  // === ç½ ãƒ€ãƒ¡ãƒ¼ã‚¸ ===
  trapDamage: [
    '{name}ãŒå·»ãè¾¼ã¾ã‚ŒãŸï¼{dmg}ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼',
    '{name}ã«{trap}ã®ç›´æ’ƒï¼{dmg}ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼',
    'é€ƒã’é…ã‚ŒãŸ{name}ã«{dmg}ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼',
    '{name}ãŒ{dmg}ã®ãƒ€ãƒ¡ãƒ¼ã‚¸ã‚’å—ã‘ãŸï¼ç—›ãã†ã ï¼',
    '{name}ã‚’ã‹ã™ã‚ã¦{dmg}ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼',
  ],

  // === ä¼‘æ†© ===
  restScene: [
    'ğŸ• å®‰å…¨ãªåºƒé–“ã‚’è¦‹ã¤ã‘ãŸã€‚ç„šãç«ã‚’å›²ã‚“ã§ä¸€æ¯ã¤ã...',
    'ğŸ• æ¸…ã‚‰ã‹ãªæ³‰ã‚’ç™ºè¦‹ï¼ç–²ã‚ŒãŸä½“ã‚’ç™’ã™...',
    'ğŸ• å¤ã„ç¥­å£‡ã®ã‚ã‚‹éƒ¨å±‹ã ã€‚ä¸æ€è­°ã¨å®‰å¿ƒæ„ŸãŒã‚ã‚‹...',
    'ğŸ• è‹”ã‚€ã—ãŸçŸ³å®¤ã«æ¸©ã‹ãªå…‰ãŒå·®ã—è¾¼ã‚“ã§ã„ã‚‹ã€‚å°‘ã—ä¼‘ã‚‚ã†...',
    'ğŸ• å†’é™ºè€…ã®æ®‹ã—ãŸã‚­ãƒ£ãƒ³ãƒ—è·¡ã‚’ç™ºè¦‹ã€‚ã¾ã ä½¿ãˆãã†ã ...',
    'ğŸ• é­”æ³•ã®ç¯ã‚ŠãŒç¯ã‚‹å®‰å…¨åœ°å¸¯ã€‚ã“ã“ã§ä¼‘æ†©ã—ã‚ˆã†...',
    'ğŸ• åœ°ä¸‹æ°´è„ˆã®éŸ³ãŒå¿ƒåœ°ã‚ˆã„ã€‚ã“ã“ãªã‚‰å®‰å…¨ã«ä¼‘ã‚ã‚‹...',
    'ğŸ• é¢¨é€šã—ã®è‰¯ã„éƒ¨å±‹ã‚’è¦‹ã¤ã‘ãŸã€‚æ–°é®®ãªç©ºæ°—ã§æ°—åˆ†ãŒå›å¾©ã™ã‚‹...',
    'ğŸ• ä¸æ€è­°ãªã‚­ãƒã‚³ãŒç™ºå…‰ã™ã‚‹ç¾ã—ã„æ´ç©´ã€‚æŸã®é–“ã®ä¼‘æ¯...',
    'ğŸ• æ—…ã®å•†äººãŒæ®‹ã—ãŸç‰©è³‡ã‚’ç™ºè¦‹ã€‚ã‚ã‚ŠãŒãŸãä½¿ã‚ã›ã¦ã‚‚ã‚‰ãŠã†...',
  ],
  restRecover: [
    'ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼å…¨å“¡ãŒè‹±æ°—ã‚’é¤Šã£ãŸ',
    'å‚·ãŒå°‘ã—ç™’ãˆã€ä½“åŠ›ãŒå›å¾©ã—ãŸ',
    'æ¸©ã‹ã„é£Ÿäº‹ã§å…¨å“¡ã®é¡”è‰²ãŒè‰¯ããªã£ãŸ',
    'ã—ã°ã—ã®ä¼‘æ¯ã§ç–²åŠ´ãŒå’Œã‚‰ã„ã ',
    'æ°´ã‚’é£²ã¿ã€ä½“åŠ›ã‚’å–ã‚Šæˆ»ã—ãŸ',
    'ç›®ã‚’é–‰ã˜ã¦ç²¾ç¥ã‚’é›†ä¸­ã•ã›ãŸã€‚å›å¾©ã—ãŸ',
    'äº’ã„ã®å‚·ã‚’æ‰‹å½“ã¦ã—åˆã„ã€å°‘ã—æ¥½ã«ãªã£ãŸ',
  ],

  // === å®ç®± ===
  treasureFind: [
    'ğŸ’ æœ½ã¡ãŸæ‰‰ã®å¥¥ã«å®ç®±ã‚’ç™ºè¦‹ï¼',
    'ğŸ’ è¼ãå®ç®±ãŒæš—é—˜ã«ä½‡ã‚“ã§ã„ãŸï¼',
    'ğŸ’ éš ã—éƒ¨å±‹ã«å®ç®±ãŒã‚ã£ãŸï¼ç½ ã§ã¯ãªã•ãã†ã ...',
    'ğŸ’ å€’ã—ãŸé­”ç‰©ã®å·£ã®ä¸­ã«å®ç®±ã‚’è¦‹ã¤ã‘ãŸï¼',
    'ğŸ’ å£ã®éš™é–“ã‹ã‚‰è¦—ã„ã¦ã„ãŸã®ã¯...å®ç®±ã ï¼',
    'ğŸ’ å¤ä»£ã®å°å°ãŒè§£ã‘ã€å®ç®±ãŒç¾ã‚ŒãŸï¼',
    'ğŸ’ åœ°é¢ã«åŠåˆ†åŸ‹ã¾ã£ãŸå®ç®±ã‚’æ˜ã‚Šå‡ºã—ãŸï¼',
  ],
  treasureGet: [
    'ã€{item}ã€‘ã‚’æ‰‹ã«å…¥ã‚ŒãŸï¼{target}ãŒè£…å‚™ã—ãŸï¼',
    'ç´ æ™´ã‚‰ã—ã„ï¼ã€{item}ã€‘ã ï¼{target}ã®ã‚‚ã®ã«ãªã£ãŸï¼',
    'ã€{item}ã€‘ã‚’ç™ºè¦‹ï¼{target}ãŒå¤§äº‹ãã†ã«å—ã‘å–ã£ãŸï¼',
    'ä¸­ã‹ã‚‰ã€{item}ã€‘ãŒï¼{target}ãŒç›®ã‚’è¼ã‹ã›ã¦ã„ã‚‹ï¼',
    'ã€{item}ã€‘ã‚²ãƒƒãƒˆï¼{target}ã®åŠ›ãŒå¢—ã—ãŸï¼',
  ],
  treasureStatUp: {
    hp: ['{target}ã®ç”Ÿå‘½åŠ›ãŒã¿ãªãã‚‹ï¼æœ€å¤§HPãŒä¸Šæ˜‡ï¼', '{target}ãŒåŠ›å¼·ã•ã‚’å¾—ãŸï¼æœ€å¤§HPå¢—åŠ ï¼'],
    atk: ['{target}ã®æ”»æ’ƒåŠ›ãŒä¸ŠãŒã£ãŸï¼', '{target}ãŒæ–°ãŸãªåŠ›ã‚’æ‰‹ã«ã—ãŸï¼æ”»æ’ƒåŠ›ä¸Šæ˜‡ï¼'],
    def: ['{target}ã®å®ˆã‚ŠãŒå›ºããªã£ãŸï¼é˜²å¾¡åŠ›ä¸Šæ˜‡ï¼', '{target}ã®é˜²å¾¡åŠ›ãŒå¼·åŒ–ã•ã‚ŒãŸï¼'],
    spd: ['{target}ã®è¶³å–ã‚ŠãŒè»½ããªã£ãŸï¼ç´ æ—©ã•ä¸Šæ˜‡ï¼', '{target}ãŒé¢¨ã®ã‚ˆã†ã«é€Ÿããªã£ãŸï¼ç´ æ—©ã•å¢—åŠ ï¼'],
  },

  // === ãƒ•ãƒ­ã‚¢åˆ°é” ===
  floorMilestone: {
    5:  ['â” åœ°ä¸‹5éšã€‚ç©ºæ°—ãŒå†·ãŸããªã£ã¦ããŸ...', 'â” B5Fã€‚ã“ã®è¾ºã‚Šã‹ã‚‰æœ¬å½“ã®ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ãŒå§‹ã¾ã‚‹', 'â” 5éšåˆ°é”ã€‚å£ã«ä¸æ°—å‘³ãªæ¨¡æ§˜ãŒæã‹ã‚Œã¦ã„ã‚‹...'],
    10: ['â” åœ°ä¸‹10éšï¼å¥‡å¦™ãªå”¸ã‚Šå£°ãŒé ãã‹ã‚‰èã“ãˆã‚‹...', 'â” B10Fåˆ°é”ï¼ã“ã“ã¾ã§æ¥ãŸå†’é™ºè€…ã¯å¤šããªã„ã ã‚ã†', 'â” 10éšã€‚é­”åŠ›ã®æ¿ƒåº¦ãŒæ˜ã‚‰ã‹ã«ä¸ŠãŒã£ã¦ã„ã‚‹...'],
    15: ['â” åœ°ä¸‹15éšã€‚å…‰æºãªã—ã§ã¯ä¸€å¯¸å…ˆã‚‚è¦‹ãˆãªã„é—‡...', 'â” B15Fï¼å£ãŒè„ˆå‹•ã—ã¦ã„ã‚‹ã‚ˆã†ã«è¦‹ãˆã‚‹...æ°—ã®ã›ã„ã‹ï¼Ÿ', 'â” 15éšåˆ°é”ã€‚ã“ã“ã‹ã‚‰å…ˆã¯æœªçŸ¥ã®é ˜åŸŸã ...'],
    20: ['â” åœ°ä¸‹20éšï¼ç©ºæ°—ãŒé‡ã„ã€‚æ·±æ·µã®æ¯å¹ã‚’æ„Ÿã˜ã‚‹...', 'â” B20Fåˆ°é”ï¼ä¼èª¬ã®é ˜åŸŸã«è¶³ã‚’è¸ã¿å…¥ã‚ŒãŸï¼', 'â” 20éšã€‚åœ°ä¸Šã®å…‰ã¯ã‚‚ã¯ã‚„é ã„è¨˜æ†¶ã®å½¼æ–¹...'],
    25: ['â” åœ°ä¸‹25éšï¼ç¾å®ŸãŒæ­ªã¿å§‹ã‚ã¦ã„ã‚‹...', 'â” B25Fï¼ã“ã“ã¯äººã®æ¥ã‚‹å ´æ‰€ã§ã¯ãªã„...', 'â” 25éšåˆ°é”ã€‚ç©ºé–“ãã®ã‚‚ã®ãŒæ•µæ„ã‚’æŒã£ã¦ã„ã‚‹...'],
    30: ['â” åœ°ä¸‹30éšï¼æ·±æ·µã®æ ¸å¿ƒã«è¿‘ã¥ã„ã¦ã„ã‚‹ï¼', 'â” B30Fåˆ°é”ï¼ã“ã®éšå±¤ã‚’è¦‹ãŸè€…ã¯ã»ã¨ã‚“ã©ã„ãªã„ï¼'],
  },
  floorAmbience: [
    'å£ã‚’ä¼ã†æ°´æ»´ã®éŸ³ã ã‘ãŒéŸ¿ã„ã¦ã„ã‚‹...',
    'æ¾æ˜ã®ç‚ãŒä¸è‡ªç„¶ã«æºã‚ŒãŸ...',
    'ã©ã“ã‹ã‚‰ã‹å†·ãŸã„é¢¨ãŒå¹ã„ã¦ãã‚‹...',
    'é ãã§ä½•ã‹ãŒå´©ã‚Œã‚‹éŸ³ãŒã—ãŸ...',
    'è¶³å…ƒã«å‰ã®å†’é™ºè€…ã®ã‚‚ã®ã‚‰ã—ãéª¨ãŒæ•£ã‚‰ã°ã£ã¦ã„ã‚‹...',
    'å£ã«è‹”ãŒç”Ÿãˆã€ã˜ã£ã¨ã‚Šã¨ã—ãŸæ¹¿æ°—ãŒæ¼‚ã†...',
    'å¤©äº•ã‹ã‚‰æ­£ä½“ä¸æ˜ã®æ¶²ä½“ãŒæ»´ã‚Šè½ã¡ã¦ã„ã‚‹...',
    'å¥‡å¦™ãªç´‹æ§˜ãŒæ·¡ãå…‰ã‚’æ”¾ã£ã¦ã„ã‚‹...',
    'ç©ºæ°—ãŒæ¾±ã¿ã€æ¯è‹¦ã—ã•ã‚’æ„Ÿã˜ã‚‹...',
    'ã‹ã™ã‹ã«ç”˜ã„åŒ‚ã„ãŒã™ã‚‹...ç½ ã‹ã‚‚ã—ã‚Œãªã„...',
  ],

  // === æ‹æ„›ã‚¤ãƒ™ãƒ³ãƒˆ ===
  loveStage1: [
    '{a}ãŒ{b}ã‚’ã¡ã‚‰ã¡ã‚‰ã¨æ°—ã«ã—ã¦ã„ã‚‹...',
    '{a}ã®è¦–ç·šãŒ{b}ã«å‘ã„ã¦ã„ã‚‹ã“ã¨ãŒå¤šã„...',
    '{b}ãŒè»¢ã³ãã†ã«ãªã£ãŸæ™‚ã€{a}ãŒã•ã£ã¨æ‰‹ã‚’å·®ã—å‡ºã—ãŸ',
    'æˆ¦é—˜å¾Œã€{a}ãŒçœŸã£å…ˆã«{b}ã®ç„¡äº‹ã‚’ç¢ºèªã—ã¦ã„ãŸ',
    '{a}ãŒ{b}ã®éš£ã‚’ã‚­ãƒ¼ãƒ—ã—ã¦ã„ã‚‹ã€‚ç„¡æ„è­˜ï¼Ÿ',
    '{b}ãŒè©±ã—ã‹ã‘ã‚‹ã¨{a}ãŒã¡ã‚‡ã£ã¨ãã“ã¡ãªããªã‚‹...',
    '{a}ãŒ{b}ã®å¥½ããªé£Ÿã¹ç‰©ã‚’è¦šãˆã¦ã„ãŸã€‚...å¶ç„¶ï¼Ÿ',
    'ä¼‘æ†©ä¸­ã€{a}ãŒ{b}ã«æ°´ç­’ã‚’å·®ã—å‡ºã—ãŸã€‚å„ªã—ã„...',
  ],
  loveStage2: [
    '{a}ã¨{b}ãŒæ¥½ã—ãã†ã«è©±ã—ã¦ã„ã‚‹ã€‚è·é›¢ãŒè¿‘ã„...',
    '{a}ã¨{b}ãŒã‚ˆãäºŒäººãã‚Šã«ãªã£ã¦ã„ã‚‹æ°—ãŒã™ã‚‹...',
    'æˆ¦é—˜ä¸­ã€{a}ãŒ{b}ã‚’åº‡ã†ã‚ˆã†ãªå‹•ãã‚’è¦‹ã›ãŸ',
    'ä¼‘æ†©ä¸­ã€{a}ã¨{b}ãŒç„šãç«ã®å‰ã§è‚©ã‚’å¯„ã›åˆã£ã¦ã„ãŸ',
    'ã€Œ{b}ã®ã“ã¨...ã€{a}ãŒã¼ã‚“ã‚„ã‚Šå‘Ÿã„ãŸã€‚èã“ãˆã¦ã‚‹ã',
    '{a}ãŒ{b}ã«ã ã‘ç‰¹åˆ¥ã«å„ªã—ã„ã€‚ä»–ã®ãƒ¡ãƒ³ãƒãƒ¼ãŒã‚¸ãƒˆç›®ã§è¦‹ã¦ã„ã‚‹',
    '{a}ã¨{b}ãŒåŒæ™‚ã«åŒã˜ã“ã¨ã‚’è¨€ã£ãŸã€‚è¦‹ã¤ã‚åˆã£ã¦ç…§ã‚Œã¦ã„ã‚‹',
    '{b}ãŒæ€ªæˆ‘ã‚’ã—ãŸæ™‚ã€{a}ãŒå–ã‚Šä¹±ã—ã¦ã„ãŸ',
  ],
  loveStage3: [
    'ğŸ’• {a}ã¨{b}ã¯æ‹ã«è½ã¡ãŸã‚ˆã†ã ï¼æˆ¦é—˜ã«å…¨ãé›†ä¸­ã§ãã¦ã„ãªã„ï¼',
    'ğŸ’• {a}ã¨{b}ã®é–“ã«ãƒ”ãƒ³ã‚¯ã®ã‚ªãƒ¼ãƒ©ãŒ...ï¼å®Œå…¨ã«æ‹ã—ã¦ã‚‹ï¼',
    'ğŸ’• {a}ãŒ{b}ã«èŠ±ã‚’æ‘˜ã‚“ã§æ¸¡ã—ãŸã€‚ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ã®ä¸­ã§ä½•ã—ã¦ã‚‹ã‚“ã ...',
    'ğŸ’• {a}ã¨{b}ãŒæ‰‹ã‚’ç¹‹ã„ã§æ­©ã„ã¦ã„ã‚‹ã€‚æˆ¦ã†æ°—ã‚ã‚‹ã®ã‹...ï¼Ÿ',
    'ğŸ’• ã€Œ{b}ã‚’å®ˆã‚Œã‚‹ãªã‚‰å‘½ã‚‚ã„ã‚‰ãªã„ã€{a}ãŒçœŸé¡”ã§è¨€ã£ãŸã€‚ãŠã„ãŠã„...',
    'ğŸ’• {a}ã¨{b}ãŒã‚¤ãƒãƒ£ã‚¤ãƒãƒ£ã—ã¦ã„ã‚‹ã€‚ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã®ç©ºæ°—ãŒå¾®å¦™ã«...',
    'ğŸ’• ã€ŒäºŒäººã®ä¸–ç•Œã€ã«å…¥ã£ãŸ{a}ã¨{b}ã€‚å‘¼ã³ã‹ã‘ã¦ã‚‚èã“ãˆã¦ã„ãªã„...',
  ],
  loveStage4: [
    'ğŸ’” {a}ã¨{b}ã¯ã‚‚ã†æˆ¦ã„ã©ã“ã‚ã§ã¯ãªã„ã€‚äº’ã„ã—ã‹è¦‹ãˆã¦ã„ãªã„...',
    'ğŸ’” ã€Œã‚‚ã†ã“ã‚“ãªå±é™ºãªå ´æ‰€ã«ã„ã‚‰ã‚Œãªã„ã€{a}ãŒ{b}ã®æ‰‹ã‚’å–ã£ãŸ',
    'ğŸ’” {a}ã¨{b}ã¯æ­¦å™¨ã‚’ç½®ã„ãŸã€‚äºŒäººã§ç”Ÿãã‚‹é“ã‚’é¸ã‚“ã ã®ã ...',
    'ğŸ’” ã€Œå†’é™ºã‚ˆã‚Šå¤§åˆ‡ãªã‚‚ã®ã‚’è¦‹ã¤ã‘ãŸã€{a}ãŒå¾®ç¬‘ã‚“ã ã€‚{b}ã‚‚é ·ã„ãŸ',
    'ğŸ’” {a}ã¨{b}ã¯æŠ±ãåˆã£ã¦é›¢ã‚Œãªã„ã€‚ã‚‚ã†å†’é™ºè€…ã§ã¯ã„ã‚‰ã‚Œãªã„...',
  ],
  loveLeave: [
    '{a}ã¨{b}ã¯æ‰‹ã‚’å–ã‚Šåˆã£ã¦ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ã‚’å»ã£ãŸ...',
    '{a}ã¨{b}ã¯å¹¸ã›ãã†ã«å»ã£ã¦ã„ã£ãŸã€‚ãŠå¹¸ã›ã«...',
    'ã€Œã¿ã‚“ãªã€ã”ã‚ã‚“ã­ã€{a}ã¨{b}ã¯æŒ¯ã‚Šè¿”ã‚‹ã“ã¨ãªãå»ã£ãŸ...',
    '{a}ã¨{b}ã¯æ—…ç«‹ã£ãŸã€‚å½¼ã‚‰ã®å†’é™ºã¯ã€åˆ¥ã®å½¢ã§ç¶šãã®ã ã‚ã†...',
    'æ®‹ã•ã‚ŒãŸãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã¯ã€äºŒäººã®èƒŒä¸­ã‚’è¤‡é›‘ãªæ€ã„ã§è¦‹é€ã£ãŸ...',
  ],

  // === æ‹äººã®æ­» â†’ ç™ºç‹‚ ===
  loverDeath: [
    'ğŸ”¥ {a}ã€Œ{b}ãƒƒï¼ï¼å˜˜ã ã‚...å˜˜ã ã¨è¨€ã£ã¦ãã‚Œ...ï¼ï¼ã€',
    'ğŸ”¥ {a}ã€Œ{b}...{b}...ãªã‚“ã§...ãªã‚“ã§ã ã‚ˆï¼ï¼ã€',
    'ğŸ”¥ {a}ã¯{b}ã®äº¡éª¸ã«ã™ãŒã‚Šã¤ãã€çµ¶å«ã—ãŸ...ï¼',
    'ğŸ”¥ {a}ã€Œè¿”ã›...{b}ã‚’è¿”ã›ã‡ã‡ã‡ï¼ï¼ã€{a}ã®ç›®ãŒæš—ã„ç‚ã‚’å®¿ã—ãŸ',
    'ğŸ”¥ {a}ã®ç³ã‹ã‚‰å…‰ãŒæ¶ˆãˆ...ä»£ã‚ã‚Šã«ç‹‚æ°—ã®ç‚ãŒç¯ã£ãŸ',
  ],
  berserk: [
    'ğŸ’¢ {a}ã¯æ€’ã‚Šã«æˆ‘ã‚’å¿˜ã‚ŒãŸï¼æ”»æ’ƒåŠ›ãŒæš´èµ°çš„ã«ä¸Šæ˜‡ï¼',
    'ğŸ’¢ {a}ã€Œã‚‚ã†å¤±ã†ã‚‚ã®ã¯ä½•ã‚‚ãªã„...å…¨éƒ¨å£Šã—ã¦ã‚„ã‚‹ï¼ã€',
    'ğŸ’¢ {a}ã¯{b}ã®åˆ†ã¾ã§æˆ¦ã†ã¨å«ã³ã€æš´èµ°ã‚’å§‹ã‚ãŸï¼',
    'ğŸ’¢ {a}ã®èº«ä½“ã‹ã‚‰ç¦ã€…ã—ã„ã‚ªãƒ¼ãƒ©ãŒæº¢ã‚Œå‡ºã™ã€‚ä»²é–“ã®åˆ¶æ­¢ã‚‚èã“ãˆãªã„',
    'ğŸ’¢ {a}ã¯æ³£ããªãŒã‚‰å‰£ã‚’æŒ¯ã‚‹ã†ã€‚ã‚‚ã¯ã‚„æ­£æ°—ã§ã¯ãªã„...',
  ],
  berserkAttack: [
    '{name}ãŒç‹‚ã£ãŸã‚ˆã†ã«æ–¬ã‚Šã‹ã‹ã‚‹ï¼',
    '{name}ãŒçµ¶å«ã—ãªãŒã‚‰æ”»æ’ƒï¼',
    '{name}ã®æ¸¾èº«ã®ä¸€æ’ƒï¼{b}ã®ä»‡ãƒƒï¼',
    '{name}ãŒæ¶™ã‚’æµã—ãªãŒã‚‰æ­¦å™¨ã‚’æŒ¯ã‚Šä¸‹ã‚ã™ï¼',
  ],
  berserkSelfDamage: [
    'ğŸ’¢ {a}ã¯è‡ªåˆ†ã®èº«ä½“ã™ã‚‰çœã¿ãªã„ç„¡è¬€ãªæ”»æ’ƒã§è‡ªèº«ã‚‚å‚·ã¤ã„ãŸï¼',
    'ğŸ’¢ {a}ã®èº«ä½“ãŒæ‚²é³´ã‚’ä¸Šã’ã¦ã„ã‚‹...ã—ã‹ã—æ­¢ã¾ã‚‰ãªã„',
    'ğŸ’¢ åå‹•ã§{a}ã«ã‚‚ãƒ€ãƒ¡ãƒ¼ã‚¸ãŒï¼ãã‚Œã§ã‚‚æ­¢ã¾ã‚Œãªã„...ï¼',
  ],
  berserkEnd: [
    '...{a}ã¯åŠ›å°½ãã€{b}ã®åã‚’å‘ŸããªãŒã‚‰å€’ã‚ŒãŸã€‚äºŒäººã¯å†ã³ä¸€ç·’ã«ãªã‚Œã‚‹ã ã‚ã†ã‹...',
    '...{a}ã¯{b}ã®éš£ã«å´©ã‚Œè½ã¡ãŸã€‚ã€Œã‚„ã£ã¨...è¿½ã„ã¤ã‘ãŸ...ã€',
    '...{a}ã¯é™ã‹ã«ç›®ã‚’é–‰ã˜ãŸã€‚ãã®é¡”ã¯ã€ç©ã‚„ã‹ã ã£ãŸã€‚{b}ã®å…ƒã¸è¡Œã‘ã‚‹ã®ã ã‚ã†',
  ],

  // === æ„›ã®åŠ› ===
  lovePower: [
    'âœ¨ {a}ã€Œ{b}ãŒã„ã‚‹ã‹ã‚‰...ä¿ºã¯è² ã‘ãªã„ï¼ã€æ„›ã®åŠ›ã§æ”»æ’ƒåŠ›ãŒä¸Šæ˜‡ï¼',
    'âœ¨ {b}ã€Œ{a}ã‚’å®ˆã‚ŠãŸã„...ï¼ã€äºŒäººã®çµ†ãŒåŠ›ã«å¤‰ã‚ã£ãŸï¼',
    'âœ¨ {a}ã¨{b}ã®æƒ³ã„ãŒã‚·ãƒ³ã‚¯ãƒ­ã—ãŸï¼åˆä½“æ”»æ’ƒãŒç™ºå‹•ï¼',
    'âœ¨ ã€Œ{b}ã®éš£ã«ã„ã‚‹ãŸã‚ã«ï¼ã€{a}ã®ä¸€æ’ƒã«æ„›ã®åŠ›ãŒå®¿ã‚‹ï¼',
    'âœ¨ {a}ãŒ{b}ã‚’åº‡ã£ã¦å‰ã«å‡ºãŸï¼æ„›ãŒç›¾ã¨ãªã‚‹ï¼é˜²å¾¡åŠ›å¤§å¹…UPï¼',
  ],
  lovePowerCombo: [
    'ğŸ’« {a}ã¨{b}ã®é€£æºæ”»æ’ƒï¼ï¼æ¯ã®åˆã£ãŸäºŒäººã®ä¸€æ’ƒãŒæ•µã‚’è²«ãï¼',
    'ğŸ’« ã€Œã€Œã„ãã‚ˆï¼ã€ã€{a}ã¨{b}ãŒåŒæ™‚ã«å«ã³ã€æ¸¾èº«ã®åˆä½“æ”»æ’ƒï¼',
    'ğŸ’« {a}ãŒåˆ‡ã‚Šé–‹ã„ãŸéš™ã«{b}ãŒå¿…æ®ºã®ä¸€æ’ƒï¼å®Œç’§ãªé€£æºã ï¼',
  ],

  // === å–§å˜© ===
  quarrel: [
    'ğŸ˜  {a}ã¨{b}ãŒè¨€ã„äº‰ã„ã‚’å§‹ã‚ãŸï¼ã€ŒãŠå‰ã®ã›ã„ã ã‚ï¼ã€ã€Œã¯ã!?ã€',
    'ğŸ˜  {a}ãŒ{b}ã«æ´ã¿ã‹ã‹ã£ãŸï¼ã€Œã„ã„åŠ æ¸›ã«ã—ã‚ï¼ã€ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ãŒé¨’ç„¶...',
    'ğŸ˜  {a}ã€Œã‚‚ã†ãŠå‰ã¨ã¯ã‚„ã£ã¦ã„ã‘ãªã„ï¼ã€{b}ã€Œã“ã£ã¡ã®ã‚»ãƒªãƒ•ã ï¼ã€',
    'ğŸ˜  {a}ã¨{b}ã®é–“ã«é™ºæ‚ªãªç©ºæ°—ãŒ...è¨€è‘‰ã®å¿œé…¬ãŒã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ãƒˆï¼',
    'ğŸ˜  {a}ãŒ{b}ã‚’æ®´ã£ãŸï¼{b}ã€Œ...æ®´ã£ãŸãªï¼Ÿæ®´ã‚Šè¿”ã™ï¼ã€å¤§å–§å˜©å‹ƒç™ºï¼',
    'ğŸ˜  {a}ã€Œè¶³ã‚’å¼•ã£å¼µã‚‹ãªã‚‰å‡ºã¦ã„ã‘ï¼ã€{b}ã€Œãã‚Œã¯ã“ã£ã¡ã®ã‚»ãƒªãƒ•ã ï¼ã€',
  ],
  quarrelPenalty: [
    'é€£æºãŒå®Œå…¨ã«å´©å£Šï¼{a}ã¨{b}ã®æ”»æ’ƒåŠ›ãƒ»é˜²å¾¡åŠ›ãŒå¤§å¹…ä½ä¸‹ï¼',
    '{a}ã¨{b}ã¯ãŠäº’ã„èƒŒã‚’å‘ã‘ã¦ã„ã‚‹ã€‚é€£æºãªã‚“ã¦ä¸å¯èƒ½ãªçŠ¶æ…‹ã ',
    'ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã®å£«æ°—ãŒæœ€ä½ãƒ¬ãƒ™ãƒ«ã«...ã“ã®ã¾ã¾ã§ã¯å±é™ºã ',
  ],
  makeUp: [
    'ğŸ¤ {a}ã€Œ...ã•ã£ãã¯æ‚ªã‹ã£ãŸã€{b}ã€Œ...ä¿ºã‚‚ã ã€ãã“ã¡ãªãæ¡æ‰‹',
    'ğŸ¤ ã€ŒãŠå‰ãŒã„ãªã„ã¨å›°ã‚‹ã‚“ã ã‚ˆ...ã€{a}ãŒã½ã¤ã‚Šã¨å‘Ÿã„ãŸã€‚{b}ãŒå¾®ç¬‘ã‚“ã ',
    'ğŸ¤ æˆ¦é—˜ä¸­ã€{a}ãŒ{b}ã‚’åº‡ã£ãŸã€‚ã€Œ...ã¾ã æ€’ã£ã¦ã‚‹ã‘ã©ã€æ­»ãªã‚ŒãŸã‚‰å›°ã‚‹ã€',
    'ğŸ¤ {b}ã€ŒèƒŒä¸­ã¯é ã‘ã‚‹ã‚ˆã€{a}ã€Œ...ã‚ã‚ã€ä»»ã›ã‚ã€å’Œè§£ã®ç¬é–“',
    'ğŸ¤ å±æ©Ÿã‚’ä¹—ã‚Šè¶ŠãˆãŸ{a}ã¨{b}ã€‚ã€ŒãŠå‰ãŒã„ã¦ã‚ˆã‹ã£ãŸ...ã€ã€Œ...ã†ã‚“ã€',
  ],
  makeUpBonus: [
    'çµ†ãŒæ·±ã¾ã£ãŸï¼{a}ã¨{b}ã®èƒ½åŠ›ãŒå–§å˜©å‰ã‚ˆã‚Šä¸Šæ˜‡ï¼',
    'å›°é›£ã‚’ä¹—ã‚Šè¶ŠãˆãŸäºŒäººã®çµ†ã¯ã€ä»¥å‰ã‚ˆã‚Šå¼·ããªã£ãŸï¼',
  ],

  // === å«‰å¦¬ï¼ˆä¸‰è§’é–¢ä¿‚ï¼‰ ===
  jealousLove: [
    'ğŸ˜¤ğŸ’” {c}ã¯{a}ã¨{b}ã®ã‚¤ãƒãƒ£ã¤ãã‚’è¦‹ã¦æ‹³ã‚’æ¡ã‚Šã—ã‚ãŸ...ã€Œä¿ºã ã£ã¦...ã€',
    'ğŸ˜¤ğŸ’” {c}ã€Œã‚ã„ã¤ã‚‰è¦‹ã¦ã‚‹ã¨ã‚¤ãƒ©ã‚¤ãƒ©ã™ã‚‹...ã€{a}ã¨{b}ã¸ã®è¤‡é›‘ãªæ„Ÿæƒ…',
    'ğŸ˜¤ğŸ’” {c}ã¯{a}ã®ã“ã¨ãŒæ°—ã«ãªã£ã¦ã„ãŸã®ã«...{b}ã«å–ã‚‰ã‚ŒãŸã€‚ã‚„ã‘é…’ã—ãŸã„æ°—åˆ†ã ',
  ],

  // === åŒè·å«‰å¦¬ ===
  jealousy: [
    'ğŸ˜¤ {names}ã®é–“ã«ãƒ”ãƒªãƒƒã¨ã—ãŸç©ºæ°—ãŒ...ï¼ˆèƒ½åŠ›ä½ä¸‹ï¼‰',
    'ğŸ˜¤ {a}ãŒ{b}ã®è£…å‚™ã‚’ã‚¸ãƒ­ã‚¸ãƒ­è¦‹ã¦ã„ã‚‹...ã€Œãªã‚“ã§ã‚¢ã‚¤ãƒ„ã®ã»ã†ãŒè‰¯ã„ã‚“ã ã€ï¼ˆèƒ½åŠ›ä½ä¸‹ï¼‰',
    'ğŸ˜¤ {a}ã¨{b}ãŒãŠäº’ã„ã®æˆ¦ã„æ–¹ã«ãƒ€ãƒ¡å‡ºã—ã—åˆã£ã¦ã„ã‚‹ï¼ˆèƒ½åŠ›ä½ä¸‹ï¼‰',
    'ğŸ˜¤ ã€Œç§ã®ã»ã†ãŒä¸Šæ‰‹ãã‚„ã‚Œã‚‹ã€{a}ã¨{b}ãŒç«èŠ±ã‚’æ•£ã‚‰ã—ã¦ã„ã‚‹ï¼ˆèƒ½åŠ›ä½ä¸‹ï¼‰',
    'ğŸ˜¤ {a}ãŒ{b}ã®æ´»èºã‚’è¦‹ã¦èˆŒæ‰“ã¡ã—ãŸã€‚å¤§äººã’ãªã„...ï¼ˆèƒ½åŠ›ä½ä¸‹ï¼‰',
    'ğŸ˜¤ åŒã˜{cls}ã¨ã—ã¦{a}ã¨{b}ã®ãƒ—ãƒ©ã‚¤ãƒ‰ãŒã¶ã¤ã‹ã‚‹ï¼ï¼ˆèƒ½åŠ›ä½ä¸‹ï¼‰',
    'ğŸ˜¤ {a}ã€Œãã®ç¨‹åº¦ã§{cls}ã‚’åä¹—ã‚‹ãªã€{b}ã€Œã¯ï¼Ÿã€é™ºæ‚ªãƒ ãƒ¼ãƒ‰ï¼ˆèƒ½åŠ›ä½ä¸‹ï¼‰',
    'ğŸ˜¤ {a}ã¨{b}ãŒ{cls}ã¨ã—ã¦ã®å®ŸåŠ›ã‚’ç«¶ã„åˆã„ã€é€£æºãŒå´©ã‚Œã¦ã„ã‚‹ï¼ˆèƒ½åŠ›ä½ä¸‹ï¼‰',
  ],

  // === æ­»äº¡ ===
  death: [
    'ğŸ’€ {name}ã¯åŠ›å°½ããŸ...',
    'ğŸ’€ {name}ãŒå€’ã‚ŒãŸï¼ã‚‚ã†å‹•ã‹ãªã„...',
    'ğŸ’€ {name}ã®ç³ã‹ã‚‰å…‰ãŒæ¶ˆãˆãŸ...',
    'ğŸ’€ ã€Œã¿ã‚“ãª...å…ˆã«...ã€{name}ã¯é™ã‹ã«ç›®ã‚’é–‰ã˜ãŸ...',
    'ğŸ’€ {name}ã¯ä»²é–“ã‚’åº‡ã†ã‚ˆã†ã«ã—ã¦å´©ã‚Œè½ã¡ãŸ...',
    'ğŸ’€ {name}ã®å†’é™ºã¯ã“ã“ã§çµ‚ã‚ã£ãŸ...',
    'ğŸ’€ {name}ã¯æœ€å¾Œã®åŠ›ã§å¾®ç¬‘ã¿ã€å€’ã‚ŒãŸ...',
  ],

  // === å…¨æ»… ===
  wipe: [
    'ï¼ï¼ï¼ å…¨æ»…...é—‡ãŒå…¨ã¦ã‚’é£²ã¿è¾¼ã‚“ã  ï¼ï¼ï¼',
    'ï¼ï¼ï¼ ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã¯å£Šæ»…ã—ãŸ...èª°ã‚‚ç”Ÿãæ®‹ã‚Œãªã‹ã£ãŸ ï¼ï¼ï¼',
    'ï¼ï¼ï¼ ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ã«é™å¯‚ãŒæˆ»ã£ãŸã€‚å†’é™ºè€…ãŸã¡ã®å§¿ã¯ã‚‚ã†ãªã„... ï¼ï¼ï¼',
    'ï¼ï¼ï¼ å…¨æ»…ã€‚å½¼ã‚‰ã®å‹‡å§¿ã¯èªã‚Šç¶™ãŒã‚Œã‚‹ã ã‚ã†... ï¼ï¼ï¼',
    'ï¼ï¼ï¼ æ·±æ·µã«æŒ‘ã‚“ã è€…ãŸã¡ã¯ã€æ·±æ·µã«å‘‘ã¾ã‚ŒãŸ... ï¼ï¼ï¼',
  ],

  // === æ¢ç´¢é–‹å§‹ ===
  startMsg: [
    'ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ãŒæš—é—‡ã®å…¥å£ã«ç«‹ã£ãŸ...',
    'å†·ãŸã„é¢¨ãŒãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ã®å¥¥ã‹ã‚‰å¹ãä»˜ã‘ã‚‹...',
    'æ¾æ˜ã«ç«ã‚’ç¯ã—ã€ä¸€æ­©ã‚’è¸ã¿å‡ºã—ãŸ...',
    'é‡ã„é‰„æ‰‰ãŒè»‹ã¿ãªãŒã‚‰é–‹ã„ãŸã€‚å†’é™ºãŒå§‹ã¾ã‚‹...',
    'å…¨å“¡ãŒé ·ãåˆã„ã€é—‡ã®ä¸­ã¸è¶³ã‚’è¸ã¿å…¥ã‚ŒãŸ...',
  ],

  // === ãƒ’ãƒ¼ãƒ©ãƒ¼ãƒ»ç›—è³Šä¸åœ¨è­¦å‘Š ===
  noHealer: [
    'âš  ãƒ’ãƒ¼ãƒ©ãƒ¼ãŒã„ãªã„...å›å¾©æ‰‹æ®µãŒé™ã‚‰ã‚Œã‚‹ã ã‚ã†',
    'âš  å›å¾©å½¹ä¸åœ¨ï¼ç„¡èŒ¶ã¯ç¦ç‰©ã ...',
    'âš  ãƒ’ãƒ¼ãƒ©ãƒ¼ãªã—ã‹...å‚·è–¬ã ã‘ã§æŒã¤ã ã‚ã†ã‹',
  ],
  noThief: [
    'âš  ç›—è³ŠãŒã„ãªã„...ç½ ã®è§£é™¤ãŒã§ããªã„ã‹ã‚‚ã—ã‚Œãªã„',
    'âš  ç›—è³Šä¸åœ¨ï¼ç½ ã«ã¯ååˆ†æ³¨æ„ã—ã‚...',
    'âš  ç½ ã®å°‚é–€å®¶ãŒã„ãªã„...æ…é‡ã«é€²ã‚€ã—ã‹ãªã„',
  ],

  // === åŒè·å…¥ã‚Š ===
  dupClass: [
    '{cls}ãŒ2äºº...äº’ã„ã‚’æ„è­˜ã—ã¦ãã“ã¡ãªã„ç©ºæ°—ãŒæµã‚Œã‚‹',
    '{cls}ãŒ2äººã‚‚ã„ã‚‹ã€‚ã€Œä¿ºã®æ–¹ãŒä¸Šã ã€ã¨è¨€ã‚ã‚“ã°ã‹ã‚Šã®è¦–ç·š...',
    'åŒã˜{cls}åŒå£«ã€è¤‡é›‘ãªç©ºæ°—ãŒæ¼‚ã£ã¦ã„ã‚‹...',
  ],
};

// ===== ã‚²ãƒ¼ãƒ çŠ¶æ…‹ =====
let selected = [];
let party = [];
let floor = 0;
let running = false;
let speedMs = [3000, 1800, 800];
let currentSpeed = 1;
let deathLog = [];
let loveStates = {}; // uid pair -> stage (0-4)
let mvpDamage = {};
let intervalId = null;

// ===== UI: é¸æŠç”»é¢ =====
const STAT_MAX = {hp:200, atk:60, def:30, spd:30};

function makeStatBar(label, val, max, cls) {
  const pct = Math.min(100, val/max*100);
  return `<div class="stat-row"><span class="stat-label">${label}</span><div class="stat-bar-bg"><div class="stat-bar-fill ${cls}" style="width:${pct}%"></div></div><span class="stat-val">${val}</span></div>`;
}

function renderSelect() {
  const grid = document.getElementById('char-grid');
  grid.innerHTML = '';
  characters.forEach(c => {
    const p = c.personality || {};
    const genderCls = c.gender==='m'?'gender-m':'gender-f';
    const div = document.createElement('div');
    div.className = 'char-card' + (selected.includes(c.uid)?' selected':'') +
      (selected.length>=4 && !selected.includes(c.uid)?' disabled':'');
    div.innerHTML = `<div class="char-icon">${c.icon}</div>
      <div class="char-name"><span class="${genderCls}">${c.genderLabel}</span> ${c.name}</div>
      <div class="char-class">${c.className}</div>
      <div class="char-trait">${p.traitShort||p.trait||''}</div>
      <div class="char-quote">ã€Œ${p.quote||'...'}ã€</div>
      <div class="char-stats-bars">
        ${makeStatBar('HP',c.baseHp,STAT_MAX.hp,'hp')}
        ${makeStatBar('ATK',c.atk,STAT_MAX.atk,'atk')}
        ${makeStatBar('DEF',c.def,STAT_MAX.def,'def')}
        ${makeStatBar('SPD',c.spd,STAT_MAX.spd,'spd')}
      </div>`;
    // ã‚¿ãƒƒãƒå¯¾å¿œï¼šã‚¿ãƒƒãƒ—ã§é¸æŠã€é•·æŠ¼ã—ã§è©³ç´°
    let pressTimer = null;
    let didLongPress = false;
    div.addEventListener('pointerdown', (e) => {
      didLongPress = false;
      pressTimer = setTimeout(() => { didLongPress = true; showDetail(c.uid); }, 500);
    });
    div.addEventListener('pointerup', (e) => {
      clearTimeout(pressTimer);
      // é•·æŠ¼ã—ã§ãªã‘ã‚Œã°é¸æŠãƒˆã‚°ãƒ«
      if (!didLongPress) {
        e.stopPropagation();
        toggleSelect(c.uid);
      }
    });
    div.addEventListener('pointerleave', () => clearTimeout(pressTimer));
    div.addEventListener('pointermove', (e) => {
      // æŒ‡ãŒå¤§ããå‹•ã„ãŸã‚‰ã‚­ãƒ£ãƒ³ã‚»ãƒ«
      if (pressTimer && (Math.abs(e.movementX) > 5 || Math.abs(e.movementY) > 5)) {
        clearTimeout(pressTimer);
      }
    });
    // clickæŠ‘åˆ¶ï¼ˆpointerupã§å‡¦ç†ã™ã‚‹ãŸã‚ï¼‰
    div.addEventListener('click', (e) => { e.preventDefault(); e.stopPropagation(); });
    // PC: ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã§è©³ç´°
    div.addEventListener('dblclick', (e) => { e.preventDefault(); showDetail(c.uid); });
    grid.appendChild(div);
  });
  document.getElementById('party-info').textContent = `${selected.length} / 4 äººé¸æŠä¸­`;
  document.getElementById('start-btn').disabled = selected.length !== 4;
  renderPartyPreview();
}

function toggleSelect(uid) {
  const i = selected.indexOf(uid);
  if (i >= 0) selected.splice(i, 1);
  else if (selected.length < 4) selected.push(uid);
  renderSelect();
}

// ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
const PARTY_HINTS = [
  'çµ„ã¿åˆã‚ã›ã‚’å·¥å¤«ã—ã¦ã€ã‚ˆã‚Šæ·±ã„éšå±¤ã‚’ç›®æŒ‡ãã†ï¼',
  'ãƒ’ãƒ¼ãƒ©ãƒ¼ãŒã„ã‚‹ã¨å®‰å®šæ„ŸãŒå¢—ã™ã‹ã‚‚...',
  'ç›—è³ŠãŒã„ãªã„ã¨ç½ ã«è‹¦åŠ´ã™ã‚‹ã‹ã‚‚...',
  'åŒã˜è·æ¥­ãŒ2äººã„ã‚‹ã¨ã€ä½•ã‹èµ·ã“ã‚Šãã†...',
];
const PAIR_HINTS = {
  'knight_m:healer_f': 'ã“ã®äºŒäººã€ãªã‚“ã ã‹è¦–ç·šãŒåˆã£ã¦ã‚‹æ°—ãŒã™ã‚‹...',
  'mage_m:archer_f': 'æ­£åå¯¾ã®æ€§æ ¼ã ã‘ã©...ä½•ã‹èµ·ããã†ãªäºˆæ„Ÿ',
  'thief_m:mage_f': 'ã‚«ã‚ªã‚¹ãªçµ„ã¿åˆã‚ã›...ç›®ãŒé›¢ã›ãªã„',
  'archer_m:priest_f': 'åˆã€…ã—ã„ç©ºæ°—ãŒæ¼‚ã£ã¦ã„ã‚‹...',
  'priest_m:thief_f': 'é™ã¨é™...ã§ã‚‚ä½•ã‹é€šã˜åˆã†ã‚‚ã®ãŒï¼Ÿ',
  'knight_m:knight_f': 'é¨å£«ãŒäºŒäºº...ãƒ—ãƒ©ã‚¤ãƒ‰ãŒã¶ã¤ã‹ã‚Šãã†',
  'mage_m:mage_f': 'å¤©æ‰åŒå£«...ç«èŠ±ãŒæ•£ã‚Šãã†',
  'healer_m:healer_f': 'ç™’ã—æ‰‹ãŒäºŒäºº...ãŠäº’ã„æ°—é£ã„ã™ãï¼Ÿ',
  'thief_m:thief_f': 'å½±ã®è€…åŒå£«...å¦™ãªç·Šå¼µæ„ŸãŒã‚ã‚‹',
  'archer_m:archer_f': 'å¼“ä½¿ã„åŒå£«ã®ãƒ©ã‚¤ãƒãƒ«æ„è­˜ãŒèŠ½ç”Ÿãˆãã†...',
  'priest_m:priest_f': 'è–è·è€…ã‚³ãƒ³ãƒ“...æ¯’èˆŒã¨ä¸–è©±ç„¼ãã®ç›¸æ€§ã¯ï¼Ÿ',
};
function renderPartyPreview() {
  const preview = document.getElementById('party-preview');
  const members = document.getElementById('party-preview-members');
  const hint = document.getElementById('party-hint');
  preview.classList.add('show');
  let html = '';
  for (let i=0; i<4; i++) {
    if (i < selected.length) {
      const c = characters.find(x=>x.uid===selected[i]);
      html += `<div class="party-preview-member"><span class="pp-icon">${c.icon}</span><div class="pp-info"><div class="pp-name">${c.name}</div><div class="pp-class">${c.className}</div></div></div>`;
    } else {
      html += `<div class="party-preview-empty">?</div>`;
    }
  }
  members.innerHTML = html;
  // ç›¸æ€§ãƒ’ãƒ³ãƒˆ
  let hintText = '';
  if (selected.length >= 2) {
    for (let i=0;i<selected.length;i++) {
      for (let j=i+1;j<selected.length;j++) {
        const k1 = selected[i]+':'+selected[j];
        const k2 = selected[j]+':'+selected[i];
        if (PAIR_HINTS[k1]) { hintText = PAIR_HINTS[k1]; break; }
        if (PAIR_HINTS[k2]) { hintText = PAIR_HINTS[k2]; break; }
      }
      if (hintText) break;
    }
  }
  if (!hintText && selected.length >= 2) {
    // åŒè·ãƒã‚§ãƒƒã‚¯
    const classes = selected.map(uid => characters.find(x=>x.uid===uid).classId);
    const dupes = classes.filter((c,i)=>classes.indexOf(c)!==i);
    if (dupes.length > 0) {
      const cls = CLASSES.find(x=>x.id===dupes[0]).name;
      hintText = `${cls}ãŒäºŒäºº...ç«¶ã„åˆã†ã‹ã€è¶³ã‚’å¼•ã£å¼µã‚‹ã‹...`;
    }
  }
  if (!hintText && selected.length < 4) hintText = PARTY_HINTS[selected.length % PARTY_HINTS.length];
  hint.textContent = hintText ? `ğŸ’­ ${hintText}` : '';
}

// ã‚­ãƒ£ãƒ©è©³ç´°ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—
function showDetail(uid) {
  const c = characters.find(x=>x.uid===uid);
  const p = c.personality || {};
  const genderCls = c.gender==='m'?'gender-m':'gender-f';
  const content = document.getElementById('card-detail-content');
  content.innerHTML = `
    <h3>${c.icon} <span class="${genderCls}">${c.genderLabel}</span> ${c.name}</h3>
    <div style="text-align:center;color:#aaa;font-size:.85em">${c.className}ã€€|ã€€${p.traitShort||p.trait||''}</div>
    <div class="detail-section">
      <h4>ğŸ“– ãƒãƒƒã‚¯ã‚¹ãƒˆãƒ¼ãƒªãƒ¼</h4>
      <p>${p.backstory||'ä¸æ˜'}</p>
    </div>
    <div class="detail-section detail-stats">
      <h4>ğŸ“Š ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</h4>
      ${makeStatBar('HP',c.baseHp,STAT_MAX.hp,'hp')}
      ${makeStatBar('ATK',c.atk,STAT_MAX.atk,'atk')}
      ${makeStatBar('DEF',c.def,STAT_MAX.def,'def')}
      ${makeStatBar('SPD',c.spd,STAT_MAX.spd,'spd')}
    </div>
    <div class="detail-section">
      <h4>ğŸ’¬ æ€§æ ¼ãƒ»å£èª¿</h4>
      <p>${p.trait||''}ï¼ˆ${p.tone||''}ï¼‰</p>
    </div>
    <div class="detail-section">
      <h4>âš” æˆ¦é—˜ã‚¹ã‚¿ã‚¤ãƒ«</h4>
      <p>${c.desc}</p>
    </div>
    <div class="detail-section">
      <h4>ğŸ—£ ä»£è¡¨ã‚»ãƒªãƒ•</h4>
      <p style="font-style:italic;color:#7ecfcf">ã€Œ${p.quote||'...'}ã€</p>
    </div>
  `;
  document.getElementById('card-detail-overlay').classList.add('show');
}
function closeDetail() {
  document.getElementById('card-detail-overlay').classList.remove('show');
}
document.getElementById('card-detail-overlay').addEventListener('click', (e) => {
  if (e.target === document.getElementById('card-detail-overlay')) closeDetail();
});

// ===== ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³é–‹å§‹ =====
function startDungeon() {
  party = selected.map(uid => {
    const c = characters.find(x=>x.uid===uid);
    return {...c, hp: c.baseHp, maxHp: c.baseHp, alive: true, buffs: {}, loveTarget: null, loveStage: 0, berserk: false, berserkTarget: null, quarrelWith: null, quarrelTimer: 0, lovePowerUsed: false};
  });
  floor = 0; deathLog = []; loveStates = {}; mvpDamage = {};
  party.forEach(p => mvpDamage[p.uid] = 0);

  // æ‹æ„›ãƒšã‚¢ãƒã‚§ãƒƒã‚¯
  initLovePairs();

  document.getElementById('party-preview').classList.remove('show');
  showScreen('dungeon-screen');
  renderHP();
  clearLog();
  addLog('ï¼ï¼ï¼ ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³æ¢ç´¢é–‹å§‹ ï¼ï¼ï¼', 'system');
  addLog(pick(TEXTS.startMsg), 'system');

  // ã‚·ãƒŠã‚¸ãƒ¼ç™ºå‹•ãƒã‚§ãƒƒã‚¯
  checkSynergies();

  // ãƒ’ãƒ¼ãƒ©ãƒ¼ä¸åœ¨è­¦å‘Š
  if (!party.some(p=>p.classId==='healer')) {
    addLog(pick(TEXTS.noHealer), 'system');
  }
  if (!party.some(p=>p.classId==='thief')) {
    addLog(pick(TEXTS.noThief), 'system');
  }

  // åŒè·ãƒã‚§ãƒƒã‚¯
  const classCount = {};
  party.forEach(p => classCount[p.classId] = (classCount[p.classId]||0)+1);
  Object.entries(classCount).forEach(([cid,cnt]) => {
    if (cnt >= 2) {
      const cls = CLASSES.find(c=>c.id===cid).name;
      addLog(pick(TEXTS.dupClass).replace(/{cls}/g, cls), 'system');
    }
  });

  running = true;

  // å†’é™ºãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åˆæœŸåŒ–
  initAdventureField();

  scheduleNextFloor();
}

function initLovePairs() {
  const uids = party.map(p=>p.uid);
  LOVE_PAIRS.forEach(([a,b,prob]) => {
    if (uids.includes(a) && uids.includes(b)) {
      if (Math.random() < prob) {
        const key = a + ':' + b;
        loveStates[key] = {a, b, stage: 0, timer: 3 + Math.floor(Math.random()*3)};
      }
    }
  });
}

function checkSynergies() {
  const classIds = party.map(p=>p.classId);
  SYNERGIES.forEach(s => {
    if (s.members.every(m => classIds.includes(m))) {
      addLog(`âœ¨ã€${s.name}ã€‘ç™ºå‹•ï¼`, 'synergy');
      party.forEach(p => {
        if (s.members.includes(p.classId)) {
          if (s.effect === 'defUp') p.def += s.value;
          if (s.effect === 'atkUp') p.atk += s.value;
          if (s.effect === 'spdUp') p.spd += s.value;
          if (s.effect === 'healUp') p.buffs.healMult = s.value;
        }
      });
    }
  });
}

// ===== ãƒ•ãƒ­ã‚¢é€²è¡Œ =====
function scheduleNextFloor() {
  if (!running) return;
  intervalId = setTimeout(async () => await processFloor(), speedMs[currentSpeed]);
}

// ===== æ›ã‘åˆã„ç™ºç”Ÿã‚·ã‚¹ãƒ†ãƒ  =====
function triggerBanter(context) {
  // context: 'explore' | 'battle' | 'rest'
  const alive = party.filter(p=>p.alive);
  if (alive.length < 2) return;

  // ç¢ºç‡ãƒã‚§ãƒƒã‚¯ï¼ˆ20-30%ï¼‰
  if (Math.random() > 0.25) return;

  let lines = null;

  // 1. ã‚­ãƒ£ãƒ©å›ºæœ‰ãƒšã‚¢ã‚’å„ªå…ˆãƒã‚§ãƒƒã‚¯
  if (context === 'explore' || context === 'rest') {
    const pairKeys = [];
    for (let i=0;i<alive.length;i++) {
      for (let j=i+1;j<alive.length;j++) {
        pairKeys.push(alive[i].uid+':'+alive[j].uid);
        pairKeys.push(alive[j].uid+':'+alive[i].uid);
      }
    }
    const matchedPairs = pairKeys.filter(k => BANTER.pair[k]);
    if (matchedPairs.length > 0 && Math.random() < 0.5) {
      const key = pick(matchedPairs);
      lines = pick(BANTER.pair[key]).lines;
    }
  }

  // 2. æ‹æ„›æ®µéšåˆ¥
  if (!lines && (context === 'explore' || context === 'rest')) {
    for (const [key, state] of Object.entries(loveStates)) {
      const pa = party.find(p=>p.uid===state.a);
      const pb = party.find(p=>p.uid===state.b);
      if (pa && pb && pa.alive && pb.alive && state.stage >= 1 && state.stage <= 3) {
        if (BANTER.loveStage[state.stage] && Math.random() < 0.3) {
          const template = pick(BANTER.loveStage[state.stage]);
          const otherMembers = alive.filter(p=>p.uid!==pa.uid && p.uid!==pb.uid);
          const other = otherMembers.length > 0 ? pick(otherMembers).name : 'ã¿ã‚“ãª';
          lines = template.lines.map(l => l.replace(/{a}/g, pa.name).replace(/{b}/g, pb.name).replace(/ä»–ãƒ¡ãƒ³ãƒãƒ¼/g, other));
          break;
        }
      }
    }
  }

  // 3. åŒè·ãƒ©ã‚¤ãƒãƒ«
  if (!lines && context === 'explore') {
    const classCount = {};
    alive.forEach(p => {
      if (!classCount[p.classId]) classCount[p.classId] = [];
      classCount[p.classId].push(p);
    });
    for (const [cid, members] of Object.entries(classCount)) {
      if (members.length >= 2 && BANTER.rivalry[cid] && Math.random() < 0.3) {
        const template = pick(BANTER.rivalry[cid]);
        lines = template.lines.map(l => l.replace(/{a}/g, members[0].name).replace(/{b}/g, members[1].name));
        break;
      }
    }
  }

  // 4. æˆ¦é—˜ä¸­ã®æ±ç”¨
  if (!lines && context === 'battle') {
    const a = pick(alive), b = pick(alive.filter(p=>p.uid!==a.uid));
    if (b) {
      const template = pick(BANTER.battleGeneric);
      lines = template.lines.map(l => l.replace(/{a}/g, a.name).replace(/{b}/g, b.name));
    }
  }

  // 5. ä¼‘æ†©ä¸­ã®æ±ç”¨
  if (!lines && context === 'rest') {
    const a = pick(alive), b = pick(alive.filter(p=>p.uid!==a.uid));
    if (b) {
      const template = pick(BANTER.restGeneric);
      lines = template.lines.map(l => l.replace(/{a}/g, a.name).replace(/{b}/g, b.name));
    }
  }

  // 6. æ±ç”¨é›‘è«‡
  if (!lines && context === 'explore') {
    const a = pick(alive), b = pick(alive.filter(p=>p.uid!==a.uid));
    if (b) {
      const template = pick(BANTER.generic);
      lines = template.lines.map(l => l.replace(/{a}/g, a.name).replace(/{b}/g, b.name));
    }
  }

  // è¡¨ç¤º
  if (lines) {
    addLog('ğŸ’¬', 'talk');
    lines.forEach(l => addLog(`  ${l}`, 'talk'));
  }
}

// triggerBanterã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è¡¨ç¤ºç”¨ãƒ˜ãƒ«ãƒ‘ãƒ¼ï¼ˆaddLogå†…ã§å‡¦ç†ï¼‰

// ===== ã‚­ãƒ£ãƒ©å›ºæœ‰ã‚»ãƒªãƒ•æŒ¿å…¥ =====
function getCharBattleCry(p) {
  if (p.personality && p.personality.battleCry && Math.random() < 0.25) {
    return `${p.name}ã€Œ${pick(p.personality.battleCry)}ã€`;
  }
  return null;
}

async function processFloor() {
  if (!running) return;
  floor++;
  document.getElementById('floor-display').textContent = `B${floor}F`;
  addLog(`\nâ”â”â” B${floor}F â”â”â”`, 'floor');

  // ãƒ•ãƒ­ã‚¢ç¯€ç›®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
  if (TEXTS.floorMilestone[floor]) {
    addLog(pick(TEXTS.floorMilestone[floor]), 'floor');
  } else if (Math.random() < 0.3) {
    addLog(pick(TEXTS.floorAmbience), 'system');
  }

  // åŒè·ãƒšãƒŠãƒ«ãƒ†ã‚£
  applyJealousy();

  // æ‹æ„›é€²è¡Œ
  advanceLove();

  // å–§å˜©ãƒã‚§ãƒƒã‚¯
  tryQuarrel();
  processQuarrels();

  // ãƒãƒ¼ã‚µãƒ¼ã‚¯è‡ªå‚·å‡¦ç†
  processBerserk();

  // ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰çŠ¶æ…‹æ›´æ–°
  updateAdventureField();

  // æ›ã‘åˆã„ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆæ¢ç´¢ä¸­ï¼‰
  triggerBanter('explore');

  // ã‚¤ãƒ™ãƒ³ãƒˆæ±ºå®š
  const r = Math.random();
  const alive = party.filter(p=>p.alive);
  if (alive.length === 0) { endGame(); return; }
  
  // åŸºæœ¬çš„ã«ã¯æ¢ç´¢ãƒ¢ãƒ¼ãƒ‰
  setExploringMode();

  if (r < 0.55) {
    await battleEvent();
  } else if (r < 0.75) {
    setEnvEffect('trap-env');
    updateEventStatus('âš  ç½ ï¼');
    showEventMessage('ç½ ã‚’ç™ºè¦‹ï¼');
    trapEvent();
  } else if (r < 0.90) {
    setEnvEffect('rest-env');
    updateEventStatus('ğŸ• ä¼‘æ†©');
    showEventMessage('å®‰å…¨ãªå ´æ‰€ã‚’è¦‹ã¤ã‘ãŸ');
    restEvent();
  } else {
    setEnvEffect('treasure-env');
    updateEventStatus('ğŸ’ å®ç®±ï¼');
    showEventMessage('å®ç®±ã‚’ç™ºè¦‹ï¼');
    treasureEvent();
  }

  // ç”Ÿå­˜ãƒã‚§ãƒƒã‚¯ + ãƒ”ãƒ³ãƒæ™‚ã‚»ãƒªãƒ•
  party.forEach(p => {
    if (p.hp <= 0 && p.alive) {
      p.alive = false; p.hp = 0;
      addLog(pick(TEXTS.death).replace(/{name}/g, p.name), 'death');
      deathLog.push({name:p.name, floor, cause:'æˆ¦é—˜ä¸èƒ½'});
    } else if (p.alive && p.hp > 0 && p.hp < p.maxHp * 0.25 && p.personality && p.personality.battleHurt && Math.random() < 0.4) {
      addLog(`  ğŸ’¬ ${p.name}ã€Œ${pick(p.personality.battleHurt)}ã€`, 'talk');
    }
  });

  renderHP();

  if (party.filter(p=>p.alive).length === 0) {
    endGame(); return;
  }

  scheduleNextFloor();
}

// ===== ã‚¹ãƒ—ãƒ©ã‚¤ãƒˆç§»å‹•ã‚·ã‚¹ãƒ†ãƒ ï¼ˆã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚²ãƒ¼ãƒ é¢¨ï¼‰ =====
const spriteSystem = {
  chars: [],     // {x, y, targetX, targetY, state, bobPhase, facing, el}
  enemy: { x: 78, y: 52, targetX: 78, targetY: 52, state: 'idle', visible: false },
  mode: 'idle',  // 'explore','battle','rest','idle'
  lastTime: 0,
  walkCycle: 0,
  particles: [],
  campfire: null,
  animId: null,
  initialized: false,
};

// ãƒ•ã‚©ãƒ¼ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®šç¾©ï¼ˆ%åº§æ¨™ï¼‰
const FORMATIONS = {
  explore: [
    { x: 55, y: 58 },  // ãƒªãƒ¼ãƒ€ãƒ¼ï¼ˆå‰æ–¹ï¼‰
    { x: 40, y: 48 },  // 2ç•ªæ‰‹ï¼ˆä¸Šæ®µå¾Œæ–¹ï¼‰
    { x: 40, y: 68 },  // 3ç•ªæ‰‹ï¼ˆä¸‹æ®µå¾Œæ–¹ï¼‰
    { x: 25, y: 58 },  // 4ç•ªæ‰‹ï¼ˆæœ€å¾Œå°¾ï¼‰
  ],
  battle: [
    { x: 28, y: 45 },
    { x: 18, y: 55 },
    { x: 28, y: 65 },
    { x: 12, y: 52 },
  ],
  rest: [
    { x: 38, y: 52 },
    { x: 55, y: 48 },
    { x: 38, y: 64 },
    { x: 55, y: 62 },
  ],
};

const MELEE_CLASSES = ['knight', 'thief'];
const RANGED_CLASSES = ['archer', 'mage', 'healer', 'priest'];

// ç’°å¢ƒæƒ…å ±ãƒ‡ãƒ¼ã‚¿
const FLOOR_ENVIRONMENTS = [
  {desc:'å†·ãŸã„çŸ³ã®å£ã«å›²ã¾ã‚ŒãŸé€šè·¯', icon:'ğŸŒ‘'},
  {desc:'è‹”ã‚€ã—ãŸå›å»ŠãŒç¶šã„ã¦ã„ã‚‹', icon:'ğŸŒ¿'},
  {desc:'å£ã‹ã‚‰æ°´ãŒæ»²ã¿å‡ºã—ã¦ã„ã‚‹', icon:'ğŸ’§'},
  {desc:'å¤ã„ç´‹æ§˜ãŒåˆ»ã¾ã‚ŒãŸé€šè·¯', icon:'ğŸ”®'},
  {desc:'ä¸æ°—å‘³ãªé¢¨ãŒå¹ãæŠœã‘ã‚‹', icon:'ğŸŒ¬ï¸'},
  {desc:'æ¾æ˜ã®ç«ãŒæºã‚Œã‚‹æš—ã„é€šè·¯', icon:'ğŸ”¥'},
  {desc:'å´©ã‚Œã‹ã‘ãŸçŸ³æ©‹ãŒè¦‹ãˆã‚‹', icon:'ğŸŒ‰'},
  {desc:'åœ°ä¸‹æ°´è„ˆã®éŸ³ãŒè¿‘ãã§èã“ãˆã‚‹', icon:'ğŸŒŠ'},
  {desc:'å¤©äº•ã‹ã‚‰å…‰ã‚‹ã‚­ãƒã‚³ãŒå‚ã‚Œã¦ã„ã‚‹', icon:'ğŸ„'},
  {desc:'å£ã«å‰ã®å†’é™ºè€…ã®è½æ›¸ããŒã‚ã‚‹', icon:'ğŸ“'},
];

const monsterIcons = {
  'ã‚´ãƒ–ãƒªãƒ³ã®ç¾¤ã‚Œ': 'ğŸ‘¹', 'ã‚¹ã‚±ãƒ«ãƒˆãƒ³æˆ¦å£«': 'ğŸ’€', 'ã‚ªãƒ¼ã‚¯': 'ğŸ‘º',
  'ãƒ€ãƒ¼ã‚¯ã‚¨ãƒ«ãƒ•': 'ğŸ§â€â™€ï¸', 'ãƒŸãƒã‚¿ã‚¦ãƒ­ã‚¹': 'ğŸ‚', 'ãƒ¯ã‚¤ãƒãƒ¼ãƒ³': 'ğŸ‰',
  'ãƒªãƒƒãƒ': 'â˜ ï¸', 'ãƒ‰ãƒ©ã‚´ãƒ³': 'ğŸ²', 'ãƒ‡ãƒ¼ãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ‰': 'ğŸ‘¹', 'æ·±æ·µã®ä½¿å¾’': 'ğŸŒ‘',
};

function initSpriteSystem() {
  spriteSystem.chars = [];
  for (let i = 0; i < 4; i++) {
    const f = FORMATIONS.explore[i];
    spriteSystem.chars.push({
      x: f.x, y: f.y, targetX: f.x, targetY: f.y,
      state: 'idle', bobPhase: i * 1.2, facing: 1, el: null,
    });
  }
  spriteSystem.enemy = { x: 78, y: 52, targetX: 78, targetY: 52, state: 'idle', visible: false };
  spriteSystem.mode = 'idle';
  spriteSystem.walkCycle = 0;
  spriteSystem.initialized = true;
  createParticles();
  if (!spriteSystem.animId) startGameLoop();
}

function createParticles() {
  const container = document.getElementById('stageParticles');
  if (!container) return;
  container.innerHTML = '';
  for (let i = 0; i < 20; i++) {
    const p = document.createElement('div');
    p.className = 'stage-particle';
    p.style.left = `${Math.random() * 120}%`;
    p.style.top = `${10 + Math.random() * 75}%`;
    p.style.animationDuration = `${4 + Math.random() * 8}s`;
    p.style.animationDelay = `${-Math.random() * 10}s`;
    p.style.opacity = 0.05 + Math.random() * 0.15;
    p.style.width = p.style.height = `${1 + Math.random() * 2}px`;
    container.appendChild(p);
  }
}

function startGameLoop() {
  spriteSystem.lastTime = performance.now();
  function loop(timestamp) {
    const dt = Math.min((timestamp - spriteSystem.lastTime) / 1000, 0.05);
    spriteSystem.lastTime = timestamp;
    updateSpritePositions(dt, timestamp);
    renderSpritePositions(timestamp);
    spriteSystem.animId = requestAnimationFrame(loop);
  }
  spriteSystem.animId = requestAnimationFrame(loop);
}

function updateSpritePositions(dt, timestamp) {
  const sys = spriteSystem;
  const mode = sys.mode;

  // æ¢ç´¢ä¸­ï¼šã‚†ã‚‰ã‚†ã‚‰ãƒ•ã‚©ãƒ¼ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ç§»å‹•
  if (mode === 'explore') {
    sys.walkCycle += dt;
    const sway = Math.sin(sys.walkCycle * 0.8) * 3;
    FORMATIONS.explore.forEach((base, i) => {
      if (!party[i] || !party[i].alive) return;
      sys.chars[i].targetX = base.x + sway + Math.sin(sys.walkCycle * 1.2 + i * 1.5) * 2;
      sys.chars[i].targetY = base.y + Math.sin(sys.walkCycle * 0.9 + i * 2) * 2;
      sys.chars[i].facing = 1; // å³å‘ã
    });
  }

  // ä¼‘æ†©ä¸­ï¼šé›†ã¾ã£ã¦ã‚†ã£ãã‚Š
  if (mode === 'rest') {
    FORMATIONS.rest.forEach((base, i) => {
      if (!party[i] || !party[i].alive) return;
      sys.chars[i].targetX = base.x + Math.sin(timestamp / 2000 + i) * 1.5;
      sys.chars[i].targetY = base.y + Math.sin(timestamp / 2500 + i * 1.3) * 1;
    });
  }

  // ä½ç½®è£œé–“
  sys.chars.forEach((sprite, i) => {
    if (!party[i] || !party[i].alive) {
      sprite.state = 'dead';
      return;
    }
    const lerpSpeed = sprite.state === 'dashing' ? 12 : (mode === 'rest' ? 2 : 4);
    sprite.x += (sprite.targetX - sprite.x) * lerpSpeed * dt;
    sprite.y += (sprite.targetY - sprite.y) * lerpSpeed * dt;
    sprite.bobPhase += dt * (mode === 'explore' ? 6 : mode === 'rest' ? 2 : 3);
  });

  // æ•µä½ç½®è£œé–“
  if (sys.enemy.visible) {
    const e = sys.enemy;
    e.x += (e.targetX - e.x) * 4 * dt;
    e.y += (e.targetY - e.y) * 4 * dt;
  }
}

function renderSpritePositions(timestamp) {
  const sys = spriteSystem;
  const field = document.getElementById('adventureField');
  if (!field) return;

  sys.chars.forEach((sprite, i) => {
    const el = document.getElementById(`stageChar${i}`);
    if (!el) return;
    const body = el.querySelector('.character-sprite');

    // æ­»äº¡å‡¦ç†
    if (!party[i] || !party[i].alive) {
      el.classList.add('dead-char');
      el.style.transform = `translate(${sprite.x}%, ${sprite.y}%)`;
      if (body) body.style.transform = 'rotate(90deg) scale(0.8)';
      return;
    }
    el.classList.remove('dead-char');

    // ä½ç½®è¨­å®š
    el.style.transform = `translate(${sprite.x}%, ${sprite.y}%)`;
    // transform ã§ã¯ãƒ‘ãƒ¼ã‚»ãƒ³ãƒ†ãƒ¼ã‚¸ãŒè‡ªèº«ã®å¤§ãã•åŸºæº–ãªã®ã§ã€left/topä½¿ç”¨ã«å¤‰æ›´
    el.style.left = `${sprite.x}%`;
    el.style.top = `${sprite.y}%`;
    el.style.transform = 'translate(-50%, -50%)';

    // ãƒãƒ¼ã‚µãƒ¼ã‚¯ãƒ»å–§å˜©ãƒ»æ‹æ„›ã®è¦–è¦šã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
    const p = party[i];
    if (p.berserk) {
      body.style.borderColor = '#ff0000';
      body.style.boxShadow = `0 0 ${12 + Math.sin(timestamp/100)*8}px rgba(255,0,0,0.7)`;
      body.style.filter = `hue-rotate(${Math.sin(timestamp/200)*20}deg) brightness(1.2)`;
    } else if (p.quarrelWith) {
      body.style.borderColor = '#ff8800';
      body.style.boxShadow = '0 0 8px rgba(255,136,0,0.4)';
      body.style.filter = '';
    } else if (p.loveStage >= 3) {
      body.style.borderColor = '#ff69b4';
      body.style.boxShadow = `0 0 ${8 + Math.sin(timestamp/300)*5}px rgba(255,105,180,0.4)`;
      body.style.filter = '';
    } else if (p.loveStage >= 1) {
      body.style.borderColor = '#ff8ec4';
      body.style.boxShadow = '';
      body.style.filter = '';
    } else {
      body.style.borderColor = '';
      body.style.boxShadow = '';
      body.style.filter = '';
    }

    // ãƒœãƒ–ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
    if (body && sprite.state !== 'dashing') {
      const berserkShake = p.berserk ? Math.sin(timestamp/50) * 2 : 0;
      const bobAmount = p.berserk ? 8 : sys.mode === 'explore' ? 5 : sys.mode === 'rest' ? 2 : 3;
      const bobY = Math.sin(sprite.bobPhase) * bobAmount;
      const tiltDeg = p.berserk ? Math.sin(sprite.bobPhase * 2) * 5 : sys.mode === 'explore' ? Math.sin(sprite.bobPhase) * 3 : 0;
      body.style.transform = `translateY(${-Math.abs(bobY)}px) translateX(${berserkShake}px) rotate(${tiltDeg}deg) scaleX(${sprite.facing})`;
    }
  });

  // æ•µãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
  const enemyEl = document.getElementById('stageEnemy');
  if (enemyEl) {
    if (sys.enemy.visible) {
      enemyEl.style.display = 'flex';
      enemyEl.style.left = `${sys.enemy.x}%`;
      enemyEl.style.top = `${sys.enemy.y}%`;
      enemyEl.style.transform = 'translate(-50%, -50%)';
      const enemyBody = enemyEl.querySelector('.enemy-sprite');
      if (enemyBody) {
        const breathe = 1 + Math.sin(timestamp / 600) * 0.03;
        if (sys.enemy.state === 'idle') {
          enemyBody.style.transform = `scale(${breathe})`;
        }
      }
    } else {
      enemyEl.style.display = 'none';
    }
  }
}

// ===== å†’é™ºãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰æ©Ÿèƒ½ =====
function updateAdventureField() {
  party.forEach((member, index) => {
    const sprite = document.getElementById(`char${index}`);
    const el = document.getElementById(`stageChar${index}`);
    const nameEl = el?.querySelector('.char-name-mini');
    const hpFill = document.getElementById(`charHp${index}`);
    const hpText = document.getElementById(`charHpText${index}`);

    if (sprite) {
      sprite.textContent = member.icon;
      if (!member.alive) sprite.classList.add('dead');
      else sprite.classList.remove('dead');
      if (nameEl) nameEl.textContent = member.name;
      if (hpFill && hpText) {
        const hpPercent = Math.max(0, member.hp / member.maxHp * 100);
        hpFill.style.width = `${hpPercent}%`;
        hpText.textContent = `${Math.max(0,member.hp)}/${member.maxHp}`;
        hpFill.className = 'hp-fill';
        if (hpPercent <= 25) hpFill.classList.add('low');
        else if (hpPercent <= 50) hpFill.classList.add('mid');
      }
    }
  });
  const floorDisplay = document.getElementById('fieldFloorDisplay');
  if (floorDisplay) floorDisplay.textContent = `B${floor}F`;
}

function showEnemy(monsterName, currentHp, maxHp) {
  const stageEnemy = document.getElementById('stageEnemy');
  const enemySprite = document.getElementById('currentEnemy');
  const enemyNameEl = document.getElementById('enemyName');

  if (stageEnemy) stageEnemy.style.display = 'flex';
  if (enemySprite) enemySprite.textContent = monsterIcons[monsterName] || 'ğŸ‘¿';
  if (enemyNameEl) enemyNameEl.textContent = monsterName;

  spriteSystem.enemy.visible = true;
  spriteSystem.enemy.x = 90;
  spriteSystem.enemy.targetX = 75;
  spriteSystem.enemy.y = 52;
  spriteSystem.enemy.targetY = 52;
  spriteSystem.enemy.state = 'idle';

  updateEnemyHP(currentHp, maxHp);
}

function hideEnemy() {
  const stageEnemy = document.getElementById('stageEnemy');
  if (stageEnemy) stageEnemy.style.display = 'none';
  spriteSystem.enemy.visible = false;
}

function updateEnemyHP(currentHp, maxHp) {
  const enemyHpFill = document.getElementById('enemyHpFill');
  const enemyHpText = document.getElementById('enemyHpText');
  if (enemyHpFill && enemyHpText) {
    const hpPercent = Math.max(0, currentHp / maxHp * 100);
    enemyHpFill.style.width = `${hpPercent}%`;
    enemyHpText.textContent = `${Math.max(0, currentHp)}/${maxHp}`;
  }
}

function showEventMessage(message, type = 'normal') {
  const actionDesc = document.getElementById('actionDesc');
  if (actionDesc) {
    actionDesc.textContent = message;
    actionDesc.style.display = 'block';
    actionDesc.className = 'stage-center-event';
    // 3ç§’å¾Œã«ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¢ã‚¦ãƒˆ
    clearTimeout(actionDesc._hideTimer);
    actionDesc._hideTimer = setTimeout(() => {
      actionDesc.style.display = 'none';
    }, 3000);
  }
}

function showSpeechBubble(character, text) {
  const member = party.find(p => p.name === character);
  addFieldDialogue(character, member ? member.icon : 'ğŸ’¬', text);
}

function updateEventStatus(status) {
  const eventStatus = document.getElementById('eventStatus');
  if (eventStatus) eventStatus.textContent = status;
}

function showDamageNumber(targetElement, damage, type = 'damage') {
  const damageContainer = targetElement?.querySelector('.damage-numbers');
  if (!damageContainer) return;
  const popup = document.createElement('div');
  popup.className = `damage-popup ${type}`;
  if (type === 'damage') popup.textContent = `-${damage}`;
  else if (type === 'heal') popup.textContent = `+${damage}`;
  else if (type === 'miss') popup.textContent = 'Miss!';
  damageContainer.appendChild(popup);
  setTimeout(() => { if (popup.parentNode) popup.parentNode.removeChild(popup); }, 1500);
}

// ã‚­ãƒ£ãƒ©ãŒãƒ€ãƒƒã‚·ãƒ¥ã—ã¦æ•µã‚’æ”»æ’ƒã™ã‚‹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
function performAttackAnimation(attackerIndex, target = 'enemy') {
  const sys = spriteSystem;
  const sprite = sys.chars[attackerIndex];
  if (!sprite || !party[attackerIndex]?.alive) return Promise.resolve();

  const charEl = document.getElementById(`stageChar${attackerIndex}`);
  const charBody = charEl?.querySelector('.character-sprite');

  return new Promise((resolve) => {
    const origX = sprite.targetX;
    const origY = sprite.targetY;
    const isMelee = MELEE_CLASSES.includes(party[attackerIndex].classId);

    if (target === 'enemy' && sys.enemy.visible) {
      if (isMelee) {
        // è¿‘æ¥ï¼šæ•µã«å‘ã‹ã£ã¦ãƒ€ãƒƒã‚·ãƒ¥
        sprite.state = 'dashing';
        sprite.targetX = sys.enemy.x - 12;
        sprite.targetY = sys.enemy.y;

        setTimeout(() => {
          // ãƒ’ãƒƒãƒˆã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
          spawnEffect('slash', sys.enemy.x, sys.enemy.y);
          const enemyBody = document.getElementById('currentEnemy');
          if (enemyBody) {
            enemyBody.style.animation = 'shake 0.4s ease-in-out';
            setTimeout(() => enemyBody.style.animation = '', 400);
          }
          // æˆ»ã‚‹
          setTimeout(() => {
            sprite.targetX = origX;
            sprite.targetY = origY;
            sprite.state = 'idle';
            resolve();
          }, 250);
        }, 300);
      } else {
        // é è·é›¢ï¼šãã®å ´ã‹ã‚‰å¼¾ã‚’æ’ƒã¤
        sprite.state = 'casting';
        if (charBody) {
          charBody.style.transform += ' scale(1.15)';
          charBody.style.boxShadow = '0 0 20px rgba(255,215,0,0.5)';
        }
        // å¼¾ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
        const projIcon = party[attackerIndex].classId === 'archer' ? 'ğŸ¹' :
                         party[attackerIndex].classId === 'mage' ? 'âœ¨' : 'ğŸ’«';
        spawnProjectile(projIcon, sprite.x, sprite.y, sys.enemy.x, sys.enemy.y);

        setTimeout(() => {
          const enemyBody = document.getElementById('currentEnemy');
          if (enemyBody) {
            enemyBody.style.animation = 'shake 0.4s ease-in-out';
            setTimeout(() => enemyBody.style.animation = '', 400);
          }
          spawnEffect('slash', sys.enemy.x, sys.enemy.y);
          if (charBody) {
            charBody.style.boxShadow = '';
          }
          sprite.state = 'idle';
          resolve();
        }, 400);
      }
    } else {
      // å‘³æ–¹æ”»æ’ƒï¼ˆç½ ãªã©ï¼‰
      const targetSprite = document.getElementById(`char${target}`);
      if (targetSprite) {
        targetSprite.classList.add('hit-flash');
        setTimeout(() => targetSprite.classList.remove('hit-flash'), 300);
      }
      resolve();
    }
  });
}

// æ•µãŒã‚­ãƒ£ãƒ©ã«çªé€²ã™ã‚‹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
function performEnemyAttackAnimation() {
  const sys = spriteSystem;
  if (!sys.enemy.visible) return Promise.resolve();
  const enemyBody = document.getElementById('currentEnemy');

  return new Promise((resolve) => {
    const origX = sys.enemy.targetX;
    // çªé€²
    sys.enemy.targetX = origX - 20;
    if (enemyBody) {
      enemyBody.style.transform = 'scale(1.2)';
      enemyBody.style.filter = 'brightness(1.3)';
    }
    setTimeout(() => {
      // æˆ»ã‚‹
      sys.enemy.targetX = origX;
      if (enemyBody) {
        enemyBody.style.transform = '';
        enemyBody.style.filter = '';
      }
      resolve();
    }, 500);
  });
}

// ã‚¨ãƒ•ã‚§ã‚¯ãƒˆç”Ÿæˆ
function spawnEffect(type, x, y) {
  const layer = document.getElementById('effectsLayer');
  if (!layer) return;
  const el = document.createElement('div');
  el.className = type === 'heal' ? 'fx-heal' : 'fx-slash';
  el.style.left = `${x}%`;
  el.style.top = `${y}%`;
  el.style.transform = 'translate(-50%,-50%)';
  layer.appendChild(el);
  setTimeout(() => el.remove(), type === 'heal' ? 800 : 400);
}

// å¼¾ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
function spawnProjectile(icon, fromX, fromY, toX, toY) {
  const layer = document.getElementById('effectsLayer');
  if (!layer) return;
  const el = document.createElement('div');
  el.className = 'fx-projectile';
  el.textContent = icon;
  el.style.left = `${fromX}%`;
  el.style.top = `${fromY}%`;
  el.style.transition = 'left 0.35s ease-in, top 0.35s ease-in';
  layer.appendChild(el);
  requestAnimationFrame(() => {
    el.style.left = `${toX}%`;
    el.style.top = `${toY}%`;
  });
  setTimeout(() => el.remove(), 400);
}

// ç„šãç«ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
function showCampfire() {
  const layer = document.getElementById('effectsLayer');
  if (!layer) return;
  const el = document.createElement('div');
  el.className = 'fx-campfire';
  el.id = 'campfire';
  el.textContent = 'ğŸ”¥';
  el.style.left = '46%';
  el.style.top = '56%';
  el.style.transform = 'translate(-50%,-50%)';
  layer.appendChild(el);
  spriteSystem.campfire = el;
}
function hideCampfire() {
  if (spriteSystem.campfire) {
    spriteSystem.campfire.remove();
    spriteSystem.campfire = null;
  }
}

function initAdventureField() {
  initSpriteSystem();
  updateAdventureField();
  updateEventStatus('æ¢ç´¢æº–å‚™å®Œäº†');
  showEventMessage('ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ã®å¥¥æ·±ãã¸å‘ã‹ã†');
  clearFieldFeed();
  setStageMode('explore');
}

// ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿
function setStageMode(mode) {
  spriteSystem.mode = mode;
  const formation = FORMATIONS[mode] || FORMATIONS.explore;
  spriteSystem.chars.forEach((sprite, i) => {
    if (!party[i] || !party[i].alive) return;
    sprite.targetX = formation[i].x;
    sprite.targetY = formation[i].y;
    sprite.state = 'idle';
    sprite.facing = mode === 'rest' ? (i < 2 ? 1 : -1) : 1;
  });
}

// ===== ãƒ­ã‚°æŠ˜ã‚ŠãŸãŸã¿ =====
function toggleLog() {
  const logArea = document.getElementById('log-area');
  const arrow = document.getElementById('toggleArrow');
  logArea.classList.toggle('collapsed');
  arrow.classList.toggle('collapsed');
}

// ===== ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãƒ•ã‚£ãƒ¼ãƒ‰ =====
function clearFieldFeed() {
  const feed = document.getElementById('fieldDialogueFeed');
  if (feed) feed.innerHTML = '';
}

function addFieldMsg(text, type = 'event') {
  const feed = document.getElementById('fieldDialogueFeed');
  if (!feed) return;
  const el = document.createElement('div');
  el.className = `field-msg ${type}-msg`;
  el.textContent = text;
  feed.appendChild(el);
  feed.scrollTop = feed.scrollHeight;
  while (feed.children.length > 25) feed.removeChild(feed.firstChild);
}

function addFieldDialogue(speakerName, speakerIcon, text) {
  const feed = document.getElementById('fieldDialogueFeed');
  if (!feed) return;
  const el = document.createElement('div');
  el.className = 'field-dialogue';
  el.innerHTML = `<div class="speaker-icon">${speakerIcon || 'ğŸ’¬'}</div><div class="dialogue-content"><div class="speaker-name">${speakerName}</div>${escapeHtml(text)}</div>`;
  feed.appendChild(el);
  feed.scrollTop = feed.scrollHeight;
  while (feed.children.length > 25) feed.removeChild(feed.firstChild);
}

function escapeHtml(str) {
  const div = document.createElement('div');
  div.textContent = str;
  return div.innerHTML;
}

// ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼å…¨ä½“ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®šï¼ˆäº’æ›ç”¨ - å®Ÿéš›ã¯spriteSystemãŒåˆ¶å¾¡ï¼‰
function setPartyAnimation(state) {
  // spriteSystemã®modeã§åˆ¶å¾¡ã™ã‚‹ã®ã§ã€ã“ã“ã§ã¯ä½•ã‚‚ã—ãªã„
}

// ç’°å¢ƒã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
function setEnvEffect(type) {
  const envEffect = document.getElementById('envEffect');
  if (!envEffect) return;
  envEffect.className = 'env-effect';
  if (type) envEffect.classList.add(type, 'active');
}

// ç’°å¢ƒæƒ…å ±ã®æ›´æ–°
function updateEnvironmentVisual() {
  const envInfo = document.getElementById('envInfo');
  const envDesc = envInfo?.querySelector('.env-description');
  if (envDesc) {
    const env = FLOOR_ENVIRONMENTS[floor % FLOOR_ENVIRONMENTS.length];
    envDesc.textContent = env.desc;
  }
}

function setExploringMode() {
  hideEnemy();
  hideCampfire();
  updateEventStatus('æ¢ç´¢ä¸­...');
  setStageMode('explore');
  setEnvEffect(null);
  updateEnvironmentVisual();
  const exploreMessages = [
    'æš—ã„é€šè·¯ã‚’æ…é‡ã«é€²ã‚“ã§ã„ã‚‹',
    'çŸ³ã®å£ã«å¤ã„æ–‡å­—ãŒåˆ»ã¾ã‚Œã¦ã„ã‚‹',
    'ã‹ã™ã‹ãªé¢¨ã®éŸ³ãŒèã“ãˆã‚‹',
    'è¶³éŸ³ãŒé™å¯‚ã«éŸ¿ã',
    'ä½•ã‹ã®æ°—é…ã‚’æ„Ÿã˜ã‚‹...'
  ];
  showEventMessage(exploreMessages[Math.floor(Math.random() * exploreMessages.length)]);
}

function setBattleMode(monsterName) {
  updateEventStatus('âš”ï¸ æˆ¦é—˜ä¸­ï¼');
  showEventMessage(`${monsterName} ã¨æˆ¦é—˜é–‹å§‹ï¼`, 'battle');
  setStageMode('battle');
  setEnvEffect('battle-env');
}

// ===== ã‚¤ãƒ™ãƒ³ãƒˆ =====
async function battleEvent() {
  const monsters = [
    {name:'ã‚´ãƒ–ãƒªãƒ³ã®ç¾¤ã‚Œ',atk:15,hp:60,tier:1},
    {name:'ã‚¹ã‚±ãƒ«ãƒˆãƒ³æˆ¦å£«',atk:22,hp:80,tier:1},
    {name:'ã‚ªãƒ¼ã‚¯',atk:30,hp:120,tier:2},
    {name:'ãƒ€ãƒ¼ã‚¯ã‚¨ãƒ«ãƒ•',atk:35,hp:90,tier:2},
    {name:'ãƒŸãƒã‚¿ã‚¦ãƒ­ã‚¹',atk:45,hp:200,tier:3},
    {name:'ãƒ¯ã‚¤ãƒãƒ¼ãƒ³',atk:50,hp:180,tier:3},
    {name:'ãƒªãƒƒãƒ',atk:55,hp:150,tier:4},
    {name:'ãƒ‰ãƒ©ã‚´ãƒ³',atk:70,hp:300,tier:4},
    {name:'ãƒ‡ãƒ¼ãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ‰',atk:80,hp:350,tier:5},
    {name:'æ·±æ·µã®ä½¿å¾’',atk:90,hp:400,tier:5},
  ];

  // ãƒ•ãƒ­ã‚¢ã«å¿œã˜ãŸæ•µé¸æŠ
  const maxTier = Math.min(5, Math.ceil(floor / 8));
  const pool = monsters.filter(m => m.tier <= maxTier);
  const mon = pool[Math.floor(Math.random()*pool.length)];
  const scale = 1 + floor * 0.08;
  const mAtk = Math.floor(mon.atk * scale);
  let mHp = Math.floor(mon.hp * scale);
  const maxHp = mHp;

  // æ•µå‡ºç¾ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
  const appearMsgs = TEXTS.monsterAppear[mon.name] || TEXTS.monsterAppear._default;
  const appearMsg = pick(appearMsgs).replace(/{name}/g, mon.name);
  addLog(`âš” ${appearMsg}`, 'battle');

  // æˆ¦é—˜ãƒ¢ãƒ¼ãƒ‰è¨­å®š
  setBattleMode(mon.name);
  showEnemy(mon.name, mHp, maxHp);

  const alive = party.filter(p=>p.alive);
  // æˆ¦é—˜ä¸­ã®æ›ã‘åˆã„
  triggerBanter('battle');

  // æ„›ã®åŠ›ã‚³ãƒ³ãƒœæ”»æ’ƒãƒã‚§ãƒƒã‚¯
  const loveCombo = tryLovePowerCombo(alive);
  if (loveCombo && mHp > 0) {
    mHp -= loveCombo.damage;
    loveCombo.attackers.forEach(a => mvpDamage[a.uid] += Math.floor(loveCombo.damage / 2));
    // ä¸¡ã‚­ãƒ£ãƒ©ã®æ”»æ’ƒã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
    for (const a of loveCombo.attackers) {
      const ci = party.findIndex(m => m.uid === a.uid);
      await performAttackAnimation(ci, 'enemy');
    }
    const enemySlot = document.getElementById('stageEnemy');
    if (enemySlot) showDamageNumber(enemySlot, loveCombo.damage, 'damage');
    updateEnemyHP(mHp, maxHp);
    await new Promise(resolve => setTimeout(resolve, 500));
  }

  // ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼æ”»æ’ƒï¼ˆé †ç•ªã«ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ä»˜ãã§ï¼‰
  for (let i = 0; i < alive.length; i++) {
    const p = alive[i];
    const charIndex = party.findIndex(member => member.uid === p.uid);

    // ãƒãƒ¼ã‚µãƒ¼ã‚¯ä¸­ã®ç‰¹åˆ¥ã‚»ãƒªãƒ•
    if (p.berserk) {
      addLog(`  ğŸ’¢ ${pick(TEXTS.berserkAttack).replace(/{name}/g, p.name).replace(/{b}/g, p.berserkTarget)}`, 'battle');
    } else {
      // ã‚­ãƒ£ãƒ©å›ºæœ‰ã‚»ãƒªãƒ•
      const cry = getCharBattleCry(p);
      if (cry) {
        addLog(`  ğŸ’¬ ${cry}`, 'talk');
        const speechText = cry.replace(/.*ã€Œ(.*)ã€.*/, '$1');
        showSpeechBubble(p.name, speechText);
      }
    }

    // ãƒ€ãƒ¡ãƒ¼ã‚¸è¨ˆç®—ï¼ˆãƒãƒ¼ã‚µãƒ¼ã‚¯ä¸­ã¯æ‹æ„›ãƒšãƒŠãƒ«ãƒ†ã‚£ãªã—ï¼†ãƒ€ãƒ¡ãƒ¼ã‚¸å¤§ï¼‰
    let dmg;
    if (p.berserk) {
      dmg = Math.max(1, Math.floor((p.atk + Math.random()*20) * 1.5));
    } else {
      const lovePenalty = p.loveStage >= 3 ? 0.5 : p.loveStage >= 2 ? 0.8 : 1;
      const quarrelPenalty = p.quarrelWith ? 0.7 : 1;
      dmg = Math.max(1, Math.floor((p.atk + Math.random()*10) * lovePenalty * quarrelPenalty));
    }
    mHp -= dmg;
    mvpDamage[p.uid] += dmg;
    
    // æ”»æ’ƒãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    const atkMsgs = TEXTS.attack[p.classId] || TEXTS.attack.knight;
    addLog(`  â†’ ${pick(atkMsgs).replace(/{name}/g, p.name)} ${dmg}ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼`, 'battle');
    
    // æ”»æ’ƒã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
    await performAttackAnimation(charIndex, 'enemy');
    
    // æ•µã«ãƒ€ãƒ¡ãƒ¼ã‚¸è¡¨ç¤º
    const enemySlot = document.getElementById('stageEnemy');
    if (enemySlot) {
      showDamageNumber(enemySlot, dmg, 'damage');
    }
    
    // æ•µHPæ›´æ–°
    updateEnemyHP(mHp, maxHp);
    
    // ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰çŠ¶æ…‹æ›´æ–°
    updateAdventureField();
    
    // 0.5ç§’å¾…æ©Ÿï¼ˆæ¬¡ã®æ”»æ’ƒã¾ã§ï¼‰
    await new Promise(resolve => setTimeout(resolve, 500));
    
    // æ•µãŒæ­»äº¡ã—ãŸå ´åˆã¯æ”»æ’ƒçµ‚äº†
    if (mHp <= 0) break;
  }

  // æˆ¦é—˜çµæœã®å‡¦ç†
  if (mHp <= 0) {
    addLog(`  â†’ ${pick(TEXTS.victory).replace(/{name}/g, mon.name)}`, 'battle');
    // å‹åˆ©æ™‚ã‚­ãƒ£ãƒ©ã‚»ãƒªãƒ•
    if (Math.random() < 0.35) {
      const speaker = pick(alive);
      if (speaker.personality && speaker.personality.battleWin) {
        addLog(`  ğŸ’¬ ${speaker.name}ã€Œ${pick(speaker.personality.battleWin)}ã€`, 'talk');
      }
    }
  } else {
    addLog(`  â†’ ${pick(TEXTS.counterattack).replace(/{name}/g, mon.name)}`, 'battle');
    
    // æ•µã®æ”»æ’ƒã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
    await performEnemyAttackAnimation();
    
    // æ•µæ”»æ’ƒï¼šã‚¿ãƒ³ã‚¯ãŒã„ã‚Œã°é›†ä¸­ã€ã„ãªã‘ã‚Œã°ãƒ©ãƒ³ãƒ€ãƒ 
    const knights = alive.filter(p=>p.classId==='knight');
    const targets = knights.length > 0 && Math.random()<0.6 ? knights : alive;
    const numHits = 1 + Math.floor(Math.random()*2);
    
    for (let i = 0; i < numHits; i++) {
      const t = targets[Math.floor(Math.random()*targets.length)];
      const charIndex = party.findIndex(member => member.uid === t.uid);
      const dmg = Math.max(1, mAtk - t.def + Math.floor(Math.random()*8));
      t.hp -= dmg;
      
      addLog(`  â†’ ${pick(TEXTS.takeDamage).replace(/{name}/g, t.name).replace(/{dmg}/g, dmg)} (HP:${Math.max(0,t.hp)}/${t.maxHp})`, 'battle');
      
      // ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ãƒ¡ãƒ³ãƒãƒ¼ã«ãƒ€ãƒ¡ãƒ¼ã‚¸è¡¨ç¤º
      const charSlot = document.querySelector(`[data-index="${charIndex}"]`);
      if (charSlot) {
        showDamageNumber(charSlot, dmg, 'damage');
        // ãƒ’ãƒƒãƒˆãƒ•ãƒ©ãƒƒã‚·ãƒ¥
        const charSprite = charSlot.querySelector('.character-sprite');
        if (charSprite) {
          charSprite.classList.add('hit-flash');
          setTimeout(() => charSprite.classList.remove('hit-flash'), 300);
        }
      }
      
      // 0.3ç§’å¾…æ©Ÿï¼ˆæ¬¡ã®ãƒ’ãƒƒãƒˆã¾ã§ï¼‰
      await new Promise(resolve => setTimeout(resolve, 300));
    }
    
    if (mHp > 0) addLog(`  â†’ ${pick(TEXTS.monsterFlee).replace(/{name}/g, mon.name)}`, 'battle');
  }

  // å°‘ã—å¾…ã£ã¦ã‹ã‚‰æˆ¦é—˜ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æ›´æ–°
  await new Promise(resolve => setTimeout(resolve, 500));

  // ãƒ’ãƒ¼ãƒ©ãƒ¼å›å¾©ï¼ˆã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ä»˜ãï¼‰
  const healers = alive.filter(p=>p.classId==='healer' && p.alive);
  for (const h of healers) {
    const mult = h.buffs.healMult || 1;
    const wounded = party.filter(p=>p.alive && p.hp < p.maxHp);
    if (wounded.length > 0) {
      const t = wounded.sort((a,b)=>a.hp/a.maxHp-b.hp/b.maxHp)[0];
      const heal = Math.floor((25 + Math.random()*15) * mult);
      t.hp = Math.min(t.maxHp, t.hp + heal);
      
      addLog(`  ğŸ’š ${pick(TEXTS.heal).replace(/{healer}/g, h.name).replace(/{target}/g, t.name).replace(/{val}/g, heal)} (HP:${t.hp}/${t.maxHp})`, 'heal');
      
      // å›å¾©å¯¾è±¡ã«ãƒ’ãƒ¼ãƒ«ã‚¨ãƒ•ã‚§ã‚¯ãƒˆè¡¨ç¤º
      const targetIndex = party.findIndex(member => member.uid === t.uid);
      const targetSlot = document.querySelector(`[data-index="${targetIndex}"]`);
      if (targetSlot) {
        showDamageNumber(targetSlot, heal, 'heal');
      }
      // ã‚¹ãƒ†ãƒ¼ã‚¸ä¸Šã«ãƒ’ãƒ¼ãƒ«ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
      if (spriteSystem.chars[targetIndex]) {
        spawnEffect('heal', spriteSystem.chars[targetIndex].x, spriteSystem.chars[targetIndex].y);
      }
      
      await new Promise(resolve => setTimeout(resolve, 300));
    }
  }

  // åƒ§ä¾¶ãƒãƒ•ï¼ˆã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ä»˜ãï¼‰
  const priests = alive.filter(p=>p.classId==='priest' && p.alive);
  for (const pr of priests) {
    if (Math.random() < 0.4) {
      const t = alive[Math.floor(Math.random()*alive.length)];
      const buff = Math.floor(3 + Math.random()*5);
      t.def += buff;
      
      addLog(`  ğŸ“¿ ${pick(TEXTS.priestBuff).replace(/{priest}/g, pr.name).replace(/{target}/g, t.name).replace(/{val}/g, buff)}`, 'synergy');
      
      // ãƒãƒ•å¯¾è±¡ã«ã‚¨ãƒ•ã‚§ã‚¯ãƒˆè¡¨ç¤º
      const targetIndex = party.findIndex(member => member.uid === t.uid);
      const targetSlot = document.querySelector(`[data-index="${targetIndex}"]`);
      if (targetSlot) {
        const targetSprite = targetSlot.querySelector('.character-sprite');
        if (targetSprite) {
          targetSprite.style.boxShadow = '0 0 18px #ffd700';
          targetSprite.style.borderColor = '#ffd700';
          setTimeout(() => {
            targetSprite.style.boxShadow = '';
            targetSprite.style.borderColor = '';
          }, 1200);
        }
      }
      if (spriteSystem.chars[targetIndex]) {
        spawnEffect('heal', spriteSystem.chars[targetIndex].x, spriteSystem.chars[targetIndex].y);
      }
      
      await new Promise(resolve => setTimeout(resolve, 300));
    }
  }

  // ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰çŠ¶æ…‹æ›´æ–°
  updateAdventureField(); // æ­»äº¡çŠ¶æ…‹ãªã©ã‚’åæ˜ 
  
  // 2ç§’å¾Œã«æ¢ç´¢ãƒ¢ãƒ¼ãƒ‰ã«æˆ»ã‚‹
  setTimeout(() => {
    setExploringMode();
    showEventMessage(mHp <= 0 ? 'æˆ¦é—˜ã«å‹åˆ©ã—ãŸã€‚å…ˆã«é€²ã‚€...' : 'æ•µã‚’é€€ã‘ãŸã€‚å…ˆã«é€²ã‚€...');
  }, 2000);
}

function trapEvent() {
  const traps = [
    {name:'è½ã¨ã—ç©´', dmg:20},
    {name:'æ¯’é‡ã®ç½ ', dmg:25},
    {name:'çˆ†ç™ºã®ãƒ«ãƒ¼ãƒ³', dmg:35},
    {name:'å‘ªã„ã®éœ§', dmg:30},
    {name:'çŸ¢ã®é›¨', dmg:28},
  ];
  const trap = traps[Math.floor(Math.random()*traps.length)];
  const scale = 1 + floor * 0.05;
  const baseDmg = Math.floor(trap.dmg * scale);

  const thieves = party.filter(p=>p.classId==='thief' && p.alive);
  if (thieves.length > 0 && Math.random() < 0.75) {
    addLog(`ğŸ”§ ${pick(TEXTS.trapFound).replace(/{trap}/g, trap.name).replace(/{thief}/g, thieves[0].name)}`, 'trap');
    if (thieves[0].personality && thieves[0].personality.trapLine && Math.random() < 0.4) {
      addLog(`  ğŸ’¬ ${thieves[0].name}ã€Œ${pick(thieves[0].personality.trapLine)}ã€`, 'talk');
    }
  } else {
    addLog(pick(TEXTS.trapTriggered).replace(/{trap}/g, trap.name), 'trap');
    const alive = party.filter(p=>p.alive);
    const hit = thieves.length > 0 ? 0.5 : 1;
    alive.forEach(p => {
      if (Math.random() < hit) {
        const dmg = Math.max(1, baseDmg - Math.floor(p.def * 0.3));
        p.hp -= dmg;
        addLog(`  â†’ ${pick(TEXTS.trapDamage).replace(/{name}/g, p.name).replace(/{dmg}/g, dmg).replace(/{trap}/g, trap.name)}`, 'trap');
      }
    });
  }
}

function restEvent() {
  setStageMode('rest');
  showCampfire();
  addLog(pick(TEXTS.restScene), 'rest');
  const alive = party.filter(p=>p.alive);
  alive.forEach(p => {
    const heal = Math.floor(p.maxHp * (0.05 + Math.random()*0.1));
    p.hp = Math.min(p.maxHp, p.hp + heal);
  });
  addLog(`  â†’ ${pick(TEXTS.restRecover)}`, 'rest');

  // ã‚­ãƒ£ãƒ©å›ºæœ‰ã®ä¼‘æ†©ã‚»ãƒªãƒ•
  if (Math.random() < 0.4) {
    const speaker = pick(alive);
    if (speaker.personality && speaker.personality.restLine) {
      addLog(`  ğŸ’¬ ${speaker.name}ã€Œ${pick(speaker.personality.restLine)}ã€`, 'talk');
    }
  }

  // ä¼‘æ†©ä¸­ã®æ›ã‘åˆã„
  triggerBanter('rest');
}

function treasureEvent() {
  const items = [
    {name:'åŠ›ã®çµæ™¶', stat:'atk', val:5},
    {name:'å®ˆã‚Šã®ãŠå®ˆã‚Š', stat:'def', val:5},
    {name:'ç–¾é¢¨ã®é´', stat:'spd', val:5},
    {name:'ç”Ÿå‘½ã®é›«', stat:'hp', val:30},
  ];
  const item = items[Math.floor(Math.random()*items.length)];
  const alive = party.filter(p=>p.alive);
  const t = alive[Math.floor(Math.random()*alive.length)];
  addLog(pick(TEXTS.treasureFind), 'synergy');
  addLog(`  â†’ ${pick(TEXTS.treasureGet).replace(/{item}/g, item.name).replace(/{target}/g, t.name)}`, 'synergy');
  if (item.stat==='hp') { t.maxHp += item.val; t.hp += item.val; }
  else t[item.stat] += item.val;
  addLog(`  â†’ ${pick(TEXTS.treasureStatUp[item.stat]).replace(/{target}/g, t.name)}`, 'synergy');
}

// ===== åŒè·å«‰å¦¬ =====
function applyJealousy() {
  const classCount = {};
  party.filter(p=>p.alive).forEach(p => {
    classCount[p.classId] = (classCount[p.classId]||0)+1;
  });
  Object.entries(classCount).forEach(([cid,cnt]) => {
    if (cnt >= 2 && Math.random() < 0.3) {
      const dupes = party.filter(p=>p.alive && p.classId===cid);
      dupes.forEach(p => { p.atk = Math.max(5, p.atk - 2); });
      const cls = CLASSES.find(c=>c.id===cid).name;
      addLog(pick(TEXTS.jealousy).replace(/{names}/g, dupes.map(p=>p.name).join('ã¨')).replace(/{a}/g, dupes[0].name).replace(/{b}/g, dupes[1].name).replace(/{cls}/g, cls), 'love');
    }
  });
}

// ===== æ‹æ„›é€²è¡Œ =====
function advanceLove() {
  Object.entries(loveStates).forEach(([key, state]) => {
    const pa = party.find(p=>p.uid===state.a);
    const pb = party.find(p=>p.uid===state.b);
    if (!pa || !pb) return;

    // æ‹äººã®æ­» â†’ ç™ºç‹‚ãƒã‚§ãƒƒã‚¯
    if (state.stage >= 2) {
      if (pa.alive && !pb.alive && !pa.berserk && !state.berserkTriggered) {
        triggerBerserk(pa, pb, state);
        return;
      }
      if (pb.alive && !pa.alive && !pb.berserk && !state.berserkTriggered) {
        triggerBerserk(pb, pa, state);
        return;
      }
    }

    if (!pa.alive || !pb.alive) return;

    state.timer--;
    if (state.timer > 0) return;

    state.stage++;
    state.timer = 1 + Math.floor(Math.random()*2); // æ—©ã‚ã«é€²è¡Œ
    pa.loveStage = Math.max(pa.loveStage, state.stage);
    pb.loveStage = Math.max(pb.loveStage, state.stage);

    const loveMsgSets = [
      [TEXTS.loveStage1, 'love'],
      [TEXTS.loveStage2, 'love'],
      [TEXTS.loveStage3, 'love'],
      [TEXTS.loveStage4, 'death'],
    ];

    if (state.stage <= 4) {
      const [pool, cls] = loveMsgSets[Math.min(state.stage-1, loveMsgSets.length-1)];
      addLog(pick(pool).replace(/{a}/g, pa.name).replace(/{b}/g, pb.name), cls);

      // ã‚¹ãƒ†ãƒ¼ã‚¸3: æ„›ã®åŠ›ç™ºå‹•ãƒãƒ£ãƒ³ã‚¹
      if (state.stage === 3 && Math.random() < 0.6) {
        triggerLovePower(pa, pb);
      }

      // ä¸‰è§’é–¢ä¿‚ï¼šä»–ã®ãƒ¡ãƒ³ãƒãƒ¼ãŒå«‰å¦¬
      if (state.stage >= 2 && Math.random() < 0.3) {
        const others = party.filter(p => p.alive && p.uid !== pa.uid && p.uid !== pb.uid);
        if (others.length > 0) {
          const jealous = pick(others);
          addLog(pick(TEXTS.jealousLove)
            .replace(/{a}/g, pa.name).replace(/{b}/g, pb.name).replace(/{c}/g, jealous.name), 'love');
          jealous.atk = Math.max(5, jealous.atk - 3);
        }
      }
    }

    if (state.stage >= 4) {
      pa.alive = false; pa.hp = 0;
      pb.alive = false; pb.hp = 0;
      deathLog.push({name:pa.name, floor, cause:`${pb.name}ã¨ã®æ‹ã«è½ã¡ãŸ`});
      deathLog.push({name:pb.name, floor, cause:`${pa.name}ã¨ã®æ‹ã«è½ã¡ãŸ`});
      addLog(pick(TEXTS.loveLeave).replace(/{a}/g, pa.name).replace(/{b}/g, pb.name), 'love');
    }
  });
}

// ===== ç™ºç‹‚ï¼ˆãƒãƒ¼ã‚µãƒ¼ã‚¯ï¼‰ã‚·ã‚¹ãƒ†ãƒ  =====
function triggerBerserk(survivor, dead, state) {
  state.berserkTriggered = true;
  survivor.berserk = true;
  survivor.berserkTarget = dead.name;
  survivor.atk = Math.floor(survivor.atk * 2.5); // æ”»æ’ƒåŠ›æš´èµ°
  survivor.def = Math.floor(survivor.def * 0.3);  // é˜²å¾¡ã‚¬ã‚¿è½ã¡

  addLog(pick(TEXTS.loverDeath).replace(/{a}/g, survivor.name).replace(/{b}/g, dead.name), 'death');
  addLog(pick(TEXTS.berserk).replace(/{a}/g, survivor.name).replace(/{b}/g, dead.name), 'battle');

  // ã‚¹ãƒ†ãƒ¼ã‚¸ä¸Šã§èµ¤ãå…‰ã‚‰ã›ã‚‹
  const idx = party.findIndex(p => p.uid === survivor.uid);
  if (idx >= 0) {
    const charEl = document.getElementById(`char${idx}`);
    if (charEl) {
      charEl.style.borderColor = '#ff0000';
      charEl.style.boxShadow = '0 0 20px rgba(255,0,0,0.6)';
      charEl.style.animation = 'shake 0.5s infinite';
    }
  }
}

// ãƒãƒ¼ã‚µãƒ¼ã‚¯ä¸­ã®è‡ªå‚·å‡¦ç†ï¼ˆæ¯ãƒ•ãƒ­ã‚¢ï¼‰
function processBerserk() {
  party.filter(p => p.alive && p.berserk).forEach(p => {
    // æ¯ãƒ•ãƒ­ã‚¢è‡ªå‚·ãƒ€ãƒ¡ãƒ¼ã‚¸
    const selfDmg = Math.floor(p.maxHp * 0.08);
    p.hp -= selfDmg;
    if (Math.random() < 0.5) {
      addLog(pick(TEXTS.berserkSelfDamage).replace(/{a}/g, p.name), 'battle');
    }

    // HPå°½ããŸã‚‰è¿½ã„æ­»ã«
    if (p.hp <= 0) {
      p.hp = 0; p.alive = false;
      addLog(pick(TEXTS.berserkEnd).replace(/{a}/g, p.name).replace(/{b}/g, p.berserkTarget), 'death');
      deathLog.push({name: p.name, floor, cause: `${p.berserkTarget}ã®å¾Œã‚’è¿½ã£ãŸ`});
    }
  });
}

// ===== æ„›ã®åŠ›ã‚·ã‚¹ãƒ†ãƒ  =====
function triggerLovePower(pa, pb) {
  addLog(pick(TEXTS.lovePower).replace(/{a}/g, pa.name).replace(/{b}/g, pb.name), 'synergy');
  // ä¸¡æ–¹ã«ãƒãƒ•
  const atkBoost = 8 + Math.floor(Math.random() * 8);
  const defBoost = 5 + Math.floor(Math.random() * 5);
  pa.atk += atkBoost;
  pb.def += defBoost;
  pa.lovePowerUsed = true;
  pb.lovePowerUsed = true;
}

// æˆ¦é—˜ä¸­ã®æ„›ã®åŠ›é€£æºæ”»æ’ƒï¼ˆbattleEventå†…ã§å‘¼ã°ã‚Œã‚‹ï¼‰
function tryLovePowerCombo(alive) {
  for (const [key, state] of Object.entries(loveStates)) {
    if (state.stage >= 3) {
      const pa = alive.find(p => p.uid === state.a);
      const pb = alive.find(p => p.uid === state.b);
      if (pa && pb && pa.alive && pb.alive && Math.random() < 0.35) {
        const comboDmg = Math.floor((pa.atk + pb.atk) * 1.5);
        addLog(pick(TEXTS.lovePowerCombo).replace(/{a}/g, pa.name).replace(/{b}/g, pb.name), 'synergy');
        return { damage: comboDmg, attackers: [pa, pb] };
      }
    }
  }
  return null;
}

// ===== å–§å˜©ã‚·ã‚¹ãƒ†ãƒ  =====
function tryQuarrel() {
  const alive = party.filter(p => p.alive && !p.berserk);
  if (alive.length < 2) return;
  if (Math.random() > 0.12) return; // 12%ã®ç¢ºç‡

  // å–§å˜©ç›¸æ‰‹ã‚’é¸ã¶ï¼ˆåŒè·ãƒšã‚¢ã‚„å«‰å¦¬ä¸­ãŒå„ªå…ˆï¼‰
  let a, b;
  const sameClassPairs = [];
  for (let i = 0; i < alive.length; i++) {
    for (let j = i+1; j < alive.length; j++) {
      if (alive[i].classId === alive[j].classId) {
        sameClassPairs.push([alive[i], alive[j]]);
      }
    }
  }
  if (sameClassPairs.length > 0 && Math.random() < 0.6) {
    [a, b] = pick(sameClassPairs);
  } else {
    a = pick(alive);
    b = pick(alive.filter(p => p.uid !== a.uid));
    if (!b) return;
  }

  // æ—¢ã«å–§å˜©ä¸­ãªã‚‰ä»²ç›´ã‚Šãƒãƒ£ãƒ³ã‚¹
  if (a.quarrelWith === b.uid || b.quarrelWith === a.uid) {
    triggerMakeUp(a, b);
    return;
  }

  // æ‹äººåŒå£«ã¯å–§å˜©ã—ã«ãã„
  for (const [key, state] of Object.entries(loveStates)) {
    if (state.stage >= 2 && ((state.a === a.uid && state.b === b.uid) || (state.a === b.uid && state.b === a.uid))) {
      if (Math.random() < 0.8) return; // æ‹äººã¯80%ã§å–§å˜©å›é¿
    }
  }

  // å–§å˜©ç™ºç”Ÿï¼
  a.quarrelWith = b.uid;
  b.quarrelWith = a.uid;
  a.quarrelTimer = 3 + Math.floor(Math.random() * 3);
  b.quarrelTimer = a.quarrelTimer;

  // ãƒšãƒŠãƒ«ãƒ†ã‚£
  const atkPenalty = 5 + Math.floor(Math.random() * 5);
  const defPenalty = 3 + Math.floor(Math.random() * 3);
  a.atk = Math.max(5, a.atk - atkPenalty);
  a.def = Math.max(3, a.def - defPenalty);
  b.atk = Math.max(5, b.atk - atkPenalty);
  b.def = Math.max(3, b.def - defPenalty);

  // ä¿å­˜ï¼ˆä»²ç›´ã‚Šæ™‚ã«ãƒœãƒ¼ãƒŠã‚¹ã¨ã—ã¦æˆ»ã™ï¼‰
  a._quarrelLoss = { atk: atkPenalty, def: defPenalty };
  b._quarrelLoss = { atk: atkPenalty, def: defPenalty };

  addLog(pick(TEXTS.quarrel).replace(/{a}/g, a.name).replace(/{b}/g, b.name), 'love');
  addLog(`  â†’ ${pick(TEXTS.quarrelPenalty).replace(/{a}/g, a.name).replace(/{b}/g, b.name)}`, 'love');
}

function processQuarrels() {
  party.filter(p => p.alive && p.quarrelWith).forEach(p => {
    p.quarrelTimer--;
    if (p.quarrelTimer <= 0) {
      const other = party.find(o => o.uid === p.quarrelWith && o.alive);
      if (other) {
        triggerMakeUp(p, other);
      } else {
        p.quarrelWith = null;
      }
    }
  });
}

function triggerMakeUp(a, b) {
  a.quarrelWith = null;
  b.quarrelWith = null;
  a.quarrelTimer = 0;
  b.quarrelTimer = 0;

  // èƒ½åŠ›ã‚’å›å¾© + ãƒœãƒ¼ãƒŠã‚¹
  const bonusAtk = 3;
  const bonusDef = 2;
  if (a._quarrelLoss) {
    a.atk += a._quarrelLoss.atk + bonusAtk;
    a.def += a._quarrelLoss.def + bonusDef;
    delete a._quarrelLoss;
  }
  if (b._quarrelLoss) {
    b.atk += b._quarrelLoss.atk + bonusAtk;
    b.def += b._quarrelLoss.def + bonusDef;
    delete b._quarrelLoss;
  }

  addLog(pick(TEXTS.makeUp).replace(/{a}/g, a.name).replace(/{b}/g, b.name), 'synergy');
  addLog(`  â†’ ${pick(TEXTS.makeUpBonus).replace(/{a}/g, a.name).replace(/{b}/g, b.name)}`, 'synergy');
}

// ===== UI =====
const CLASS_ICONS = {knight:'ğŸ›¡ï¸',mage:'ğŸ”®',healer:'ğŸ’š',thief:'ğŸ—¡ï¸',archer:'ğŸ¹',priest:'ğŸ“¿'};

function getStatusIcons(p) {
  let icons = '';
  if (!p.alive) return 'â˜ ï¸';
  if (p.berserk) icons += 'ğŸ”¥';
  if (p.quarrelWith) icons += 'ğŸ˜ ';
  if (p.loveStage >= 3) icons += 'ğŸ’•';
  else if (p.loveStage >= 1) icons += 'ğŸ’—';
  // å«‰å¦¬ãƒã‚§ãƒƒã‚¯ï¼ˆåŒè·ãŒã„ã‚‹ã‹ï¼‰
  const sameClass = party.filter(x=>x.uid!==p.uid && x.classId===p.classId && x.alive);
  if (sameClass.length > 0) icons += 'ğŸ˜¤';
  return icons;
}

function renderHP() {
  const area = document.getElementById('party-hp');
  area.innerHTML = party.map(p => {
    const pct = Math.max(0, p.hp / p.maxHp * 100);
    const cls = pct <= 25 ? 'low' : pct <= 50 ? 'mid' : '';
    const statusIcons = getStatusIcons(p);
    const classIcon = CLASS_ICONS[p.classId]||'';
    return `<div class="hp-bar-wrap${p.alive?'':' dead'}">
      <div class="hp-name">
        <span class="char-info-left">${p.icon}${classIcon} ${p.name}</span>
        <span><span class="status-icons">${statusIcons}</span> ${Math.max(0,p.hp)}/${p.maxHp}</span>
      </div>
      <div class="hp-bar-bg"><div class="hp-bar ${cls}" style="width:${pct}%"></div></div>
    </div>`;
  }).join('');
}

function addLog(text, cls='') {
  const area = document.getElementById('log-area');
  const div = document.createElement('div');
  const isTalkBubble = cls === 'talk' && (text.includes('ã€Œ') || text.trim().startsWith('ğŸ’¬'));
  div.className = 'log-line ' + cls + (isTalkBubble ? ' talk-bubble' : '');
  div.textContent = text;
  area.appendChild(div);
  area.scrollTop = area.scrollHeight;

  // ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒ•ã‚£ãƒ¼ãƒ‰ã«ã‚‚è¡¨ç¤ºï¼ˆãƒ†ã‚­ã‚¹ãƒˆãƒ­ã‚°ã‚’è¦‹ãªãã¦ã‚‚OKï¼‰
  if (!running) return; // ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³å¤–ã§ã¯ä¸è¦
  const trimmed = text.trim();
  if (!trimmed) return;

  // ã‚»ãƒªãƒ• â†’ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å¹ãå‡ºã—ã§è¡¨ç¤º
  if (cls === 'talk' && trimmed.includes('ã€Œ')) {
    const match = trimmed.replace(/^\s*ğŸ’¬\s*/, '').match(/^(.+?)ã€Œ(.+)ã€/);
    if (match) {
      const speaker = match[1].trim();
      const speech = match[2];
      const member = party.find(p => p.name === speaker);
      addFieldDialogue(speaker, member ? member.icon : 'ğŸ’¬', speech);
      return;
    }
  }

  // å„ç¨®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«è¡¨ç¤º
  const fieldTypeMap = {
    'battle': 'battle',
    'heal': 'heal',
    'trap': 'trap',
    'rest': 'rest',
    'synergy': 'treasure',
    'love': 'love',
    'death': 'death',
    'floor': 'floor',
    'system': 'system',
  };
  const fieldType = fieldTypeMap[cls];
  if (fieldType) {
    addFieldMsg(trimmed, fieldType);
  }
}

function clearLog() {
  document.getElementById('log-area').innerHTML = '';
}

function showScreen(id) {
  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

function setSpeed(s) {
  currentSpeed = s;
  document.querySelectorAll('.speed-control button').forEach((b,i)=>b.classList.toggle('active',i===s));
}

// ===== çµæœ =====
function endGame() {
  running = false;
  clearTimeout(intervalId);
  // ã‚²ãƒ¼ãƒ ãƒ«ãƒ¼ãƒ—åœæ­¢
  if (spriteSystem.animId) { cancelAnimationFrame(spriteSystem.animId); spriteSystem.animId = null; }
  hideCampfire();
  addLog(`\n${pick(TEXTS.wipe)}`, 'death');

  setTimeout(() => {
    // MVPè¨ˆç®—
    let mvpUid = null, mvpVal = 0;
    Object.entries(mvpDamage).forEach(([uid,d]) => { if (d>mvpVal){mvpVal=d;mvpUid=uid;} });
    const mvp = characters.find(c=>c.uid===mvpUid);

    const box = document.getElementById('result-box');
    box.innerHTML = `
      <div style="font-size:1em;color:#aaa">åˆ°é”éšæ•°</div>
      <div class="result-floor">B${floor}F</div>
      ${mvp ? `<div style="margin:8px 0">ğŸ† MVP: ${mvp.icon} ${mvp.name}ï¼ˆç·ãƒ€ãƒ¡ãƒ¼ã‚¸: ${mvpVal}ï¼‰</div>` : ''}
      <div class="death-summary">
        <div style="color:#ffd700;margin-bottom:6px">â˜  æ­»å› ã‚µãƒãƒªãƒ¼</div>
        ${deathLog.map(d =>
          `<div class="${d.cause.includes('æ‹')?'love':'death'}">B${d.floor}F - ${d.name}: ${d.cause}</div>`
        ).join('')}
        ${deathLog.length===0 ? '<div>è¨˜éŒ²ãªã—</div>' : ''}
      </div>
      <div style="margin-top:12px;font-size:.8em;color:#888">
        ${floor >= 30 ? 'ğŸŒŸ ç´ æ™´ã‚‰ã—ã„ï¼æœ€æ·±éƒ¨ã«è¿‘ã¥ã„ã¦ã„ã‚‹ï¼' :
          floor >= 20 ? 'â­ ãªã‹ãªã‹ã®è…•å‰ã ï¼' :
          floor >= 10 ? 'ğŸ’ª ã¾ã ã¾ã å…ˆã¯é•·ã„...' :
          'ğŸ˜… ç›¸æ€§ã‚’è¦‹ç›´ã—ã¦ã¿ã‚ˆã†...'}
      </div>`;
    showScreen('result-screen');
  }, 1500);
}

function backToSelect() {
  if (spriteSystem.animId) { cancelAnimationFrame(spriteSystem.animId); spriteSystem.animId = null; }
  spriteSystem.initialized = false;
  selected = [];
  renderSelect();
  showScreen('select-screen');
}

// åˆæœŸåŒ–
renderSelect();
</script>
</body>
</html>
