<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æ·±æ·µã®ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ - ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ç·¨æˆRPG v2.0</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=DotGothic16&display=swap');
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'DotGothic16','MS Gothic',monospace;background:#1a1a2e;color:#e0e0e0;min-height:100vh;overflow-x:hidden}
.screen{display:none;min-height:100vh;padding:12px;max-width:960px;margin:0 auto}
.screen.active{display:block}
h1{text-align:center;color:#ffd700;font-size:1.6em;margin:12px 0;text-shadow:0 0 10px #ffd70066}
h2{text-align:center;color:#aaa;font-size:1em;margin-bottom:16px}
.subtitle{text-align:center;color:#888;font-size:.85em;margin-bottom:20px}

/* === ã‚­ãƒ£ãƒ©é¸æŠ === */
.char-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(165px,1fr));gap:10px;margin-bottom:16px}
.char-card{background:#16213e;border:2px solid #333;border-radius:10px;padding:12px 10px 10px;cursor:pointer;transition:.2s;text-align:center;user-select:none;position:relative}
.char-card:hover{border-color:#5588ff;transform:translateY(-3px);box-shadow:0 4px 16px #5588ff22}
.char-card.selected{border-color:#ffd700;background:#1a2a4e;box-shadow:0 0 16px #ffd70044}
.char-card.disabled{opacity:.35;pointer-events:none}
.char-icon{font-size:2.4em;margin-bottom:2px}
.char-name{font-size:1em;color:#fff;font-weight:bold;display:flex;align-items:center;justify-content:center;gap:4px}
.gender-m{color:#6ec6ff}
.gender-f{color:#ff8ec4}
.char-class{font-size:.8em;color:#aaa;margin:2px 0}
.char-trait{font-size:.72em;color:#b8b8d0;margin:2px 0}
.char-quote{font-size:.68em;color:#8899aa;font-style:italic;margin:4px 0 6px;min-height:2em;line-height:1.3}
.char-stats-bars{margin-top:6px;text-align:left}
.stat-row{display:flex;align-items:center;gap:4px;margin:2px 0;font-size:.65em;color:#999}
.stat-label{width:28px;text-align:right;flex-shrink:0}
.stat-bar-bg{flex:1;height:6px;background:#222;border-radius:3px;overflow:hidden}
.stat-bar-fill{height:100%;border-radius:3px;transition:width .3s}
.stat-bar-fill.hp{background:#4caf50}
.stat-bar-fill.atk{background:#ff6b6b}
.stat-bar-fill.def{background:#5588ff}
.stat-bar-fill.spd{background:#ffd700}
.stat-val{width:22px;text-align:left;flex-shrink:0}

/* ã‚«ãƒ¼ãƒ‰è©³ç´°ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ— */
.card-detail-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.7);z-index:100;justify-content:center;align-items:center;padding:16px}
.card-detail-overlay.show{display:flex}
.card-detail{background:#16213e;border:2px solid #5588ff;border-radius:12px;padding:20px;max-width:400px;width:100%;max-height:80vh;overflow-y:auto;position:relative}
.card-detail .close-btn{position:absolute;top:8px;right:12px;background:none;border:none;color:#aaa;font-size:1.4em;cursor:pointer}
.card-detail .close-btn:hover{color:#fff}
.card-detail h3{text-align:center;color:#ffd700;margin-bottom:10px;font-size:1.2em}
.card-detail .detail-section{margin:10px 0;padding:8px;background:#111a2e;border-radius:6px}
.card-detail .detail-section h4{color:#5588ff;font-size:.85em;margin-bottom:4px}
.card-detail .detail-section p{font-size:.8em;color:#ccc;line-height:1.5}
.card-detail .detail-stats .stat-row{font-size:.78em}
.card-detail .detail-stats .stat-bar-bg{height:8px}

/* ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼é¸æŠãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ */
.party-info{text-align:center;margin:12px 0;font-size:1.1em;color:#ffd700}
.party-preview{position:fixed;bottom:0;left:0;right:0;background:#0d1117ee;border-top:2px solid #ffd700;padding:10px 12px;z-index:50;display:none;backdrop-filter:blur(6px)}
.party-preview.show{display:block}
.party-preview-inner{max-width:960px;margin:0 auto}
.party-preview-members{display:flex;gap:10px;justify-content:center;flex-wrap:wrap;margin-bottom:4px}
.party-preview-member{display:flex;align-items:center;gap:6px;background:#16213e;border:1px solid #ffd700;border-radius:8px;padding:6px 10px;min-width:100px}
.party-preview-member .pp-icon{font-size:1.4em}
.party-preview-member .pp-info{font-size:.75em;line-height:1.3}
.party-preview-member .pp-name{color:#fff;font-weight:bold}
.party-preview-member .pp-class{color:#aaa}
.party-preview-empty{width:100px;height:48px;border:1px dashed #555;border-radius:8px;display:flex;align-items:center;justify-content:center;color:#555;font-size:.8em}
.party-hint{text-align:center;font-size:.72em;color:#f783ac;margin-top:4px;min-height:1.2em}

.btn{display:block;margin:10px auto;padding:12px 40px;font-family:inherit;font-size:1.1em;background:#ffd700;color:#1a1a2e;border:none;border-radius:6px;cursor:pointer;font-weight:bold;transition:.2s}
.btn:hover{background:#ffed4a;transform:scale(1.05)}
.btn:disabled{opacity:.4;cursor:default;transform:none}

/* === ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ç”»é¢ === */
.dungeon-sticky{position:sticky;top:0;z-index:30;background:#1a1a2e;padding:6px 0 8px;border-bottom:2px solid #333}
.dungeon-header{display:flex;justify-content:space-between;align-items:center;padding:4px 0}
.dungeon-controls{display:flex;gap:15px;align-items:center}
.game-controls{display:flex;gap:8px}
.control-btn{
  background:rgba(22,33,62,0.8);
  border:1px solid #334155;
  color:#e2e8f0;
  padding:8px 12px;
  border-radius:6px;
  cursor:pointer;
  transition:all 0.2s ease;
  font-size:1em;
}
.control-btn:hover{
  background:rgba(34,51,78,1);
  border-color:#4a5568;
  transform:translateY(-1px);
}
.floor-display{font-size:1.8em;color:#ffd700;font-weight:bold;text-shadow:0 0 12px #ffd70055;letter-spacing:2px}
.party-hp{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:6px;margin-top:8px}
.hp-bar-wrap{background:#16213e;border:1px solid #333;border-radius:6px;padding:7px 10px;transition:opacity .3s, filter .3s}
.hp-bar-wrap.dead{opacity:.4;filter:grayscale(1)}
.hp-name{font-size:.8em;margin-bottom:3px;display:flex;justify-content:space-between;align-items:center}
.hp-name .char-info-left{display:flex;align-items:center;gap:4px}
.hp-name .status-icons{font-size:.9em}
.hp-bar-bg{background:#333;height:10px;border-radius:4px;overflow:hidden}
.hp-bar{height:100%;background:#4caf50;transition:width .4s ease;border-radius:4px}
.hp-bar.low{background:linear-gradient(90deg,#ff5722,#ff8a65)}
.hp-bar.mid{background:linear-gradient(90deg,#ff9800,#ffcc02)}

/* ãƒ­ã‚°ã‚¨ãƒªã‚¢ */
.log-area{background:#0d1117;border:1px solid #333;border-radius:8px;padding:12px;height:calc(100vh - 380px);overflow-y:auto;font-size:.82em;line-height:1.6;scroll-behavior:smooth}
.log-line{animation:fadeIn .3s;padding:2px 4px;border-radius:4px;margin:1px 0}
.log-line.battle{color:#ff6b6b}
.log-line.heal{color:#69db7c}
.log-line.trap{color:#ffa94d}
.log-line.rest{color:#74c0fc}
.log-line.love{color:#f783ac;background:#f783ac11;padding:4px 8px;border-left:3px solid #f783ac}
.log-line.synergy{color:#ffd700}
.log-line.floor{color:#fff;font-weight:bold;font-size:1.1em;background:linear-gradient(90deg,#1a2a4e,#16213e,#1a2a4e);padding:8px 12px;margin:10px -4px 6px;border-radius:6px;text-align:center;letter-spacing:2px;border:1px solid #334}
.log-line.death{color:#ff3333;font-weight:bold;background:#ff000015;padding:4px 8px;border-left:3px solid #ff3333}
.log-line.system{color:#aaa}
.log-line.talk{color:#7ecfcf;background:#7ecfcf0a;padding:4px 10px;margin:2px 0;border-radius:8px;border:1px solid #7ecfcf15;position:relative}
.log-line.talk-bubble{background:#1a2e3e;border:1px solid #2a4e5e;border-radius:12px;padding:6px 12px;margin:3px 0 3px 16px;color:#a0dede;position:relative}
.log-line.achievement{color:#ffd700;background:linear-gradient(90deg,#ffd70020,#ffd70010,#ffd70020);padding:8px 12px;border:2px solid #ffd700;margin:4px 0;font-weight:bold;animation:glow 2s infinite alternate}

/* === å†’é™ºãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ === */
.adventure-field{
  background:linear-gradient(135deg,#1a1a2e 0%,#16213e 30%,#0d1117 70%,#1a1a2e 100%);
  border:2px solid #4a5568;
  border-radius:15px;
  padding:20px;
  margin:10px 12px;
  display:grid;
  grid-template-columns:300px 1fr 250px;
  gap:20px;
  min-height:300px;
  position:relative;
  overflow:hidden;
}
.adventure-field::before{
  content:'';
  position:absolute;
  inset:0;
  background:
    radial-gradient(circle at 20% 80%, rgba(255,215,0,0.05) 0%, transparent 50%),
    radial-gradient(circle at 80% 20%, rgba(138,43,226,0.03) 0%, transparent 50%);
  pointer-events:none;
}

/* ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã‚¨ãƒªã‚¢ */
.party-area{
  background:rgba(22,33,62,0.6);
  border:1px solid #334155;
  border-radius:10px;
  padding:15px;
}
.party-grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:15px;
  margin-top:10px;
}
.area-title{
  color:#ffd700;
  font-size:0.9em;
  font-weight:bold;
  text-align:center;
  margin-bottom:10px;
  border-bottom:1px solid #334155;
  padding-bottom:5px;
}

/* ã‚¤ãƒ™ãƒ³ãƒˆè¡¨ç¤ºã‚¨ãƒªã‚¢ */
.event-display{
  display:flex;
  flex-direction:column;
  justify-content:space-between;
  align-items:center;
  text-align:center;
  position:relative;
}
.floor-info{
  background:rgba(26,26,46,0.8);
  border:2px solid #ffd700;
  border-radius:10px;
  padding:10px 20px;
  margin-bottom:15px;
}
.floor-number{
  font-size:1.5em;
  color:#ffd700;
  font-weight:bold;
  text-shadow:0 0 8px #ffd70055;
}
.event-status{
  font-size:0.8em;
  color:#aaa;
  margin-top:3px;
}
.action-description{
  font-size:1.1em;
  color:#e2e8f0;
  background:rgba(16,33,62,0.7);
  padding:15px 20px;
  border-radius:10px;
  border:1px solid #334155;
  margin:10px 0;
  max-width:400px;
  line-height:1.4;
}
.speech-bubble{
  background:#1a2e3e;
  border:2px solid #2a4e5e;
  border-radius:15px;
  padding:12px 18px;
  margin:10px 0;
  max-width:350px;
  position:relative;
  color:#7ecfcf;
  box-shadow:0 4px 12px rgba(0,0,0,0.3);
}
.speech-bubble::before{
  content:'ğŸ’¬';
  position:absolute;
  top:-8px;
  left:15px;
  font-size:1.2em;
}
.event-messages{
  background:rgba(13,17,23,0.7);
  border:1px solid #21262d;
  border-radius:8px;
  padding:10px;
  max-height:100px;
  overflow-y:auto;
  font-size:0.8em;
  width:100%;
  margin-top:auto;
}

/* ç’°å¢ƒãƒ»æ•µã‚¨ãƒªã‚¢ */
.environment-area{
  background:rgba(35,25,50,0.6);
  border:1px solid #553c60;
  border-radius:10px;
  padding:15px;
  display:flex;
  flex-direction:column;
}
.enemy-container{
  display:flex;
  justify-content:center;
  margin:20px 0;
}
.environment-info{
  margin-top:auto;
  font-size:0.8em;
  color:#b8b8d0;
  text-align:center;
  padding:10px;
  background:rgba(16,16,30,0.5);
  border-radius:6px;
}
.character-slot{
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:6px;
  background:rgba(13,17,23,0.4);
  border:1px solid #21262d;
  border-radius:8px;
  padding:8px;
  min-height:120px;
  transition:all 0.3s ease;
}
.character-slot:hover{
  background:rgba(13,17,23,0.6);
  border-color:#334155;
}
.character-sprite{
  width:50px;
  height:50px;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:1.8em;
  background:linear-gradient(135deg,#2d3748,#4a5568);
  border:2px solid #5588ff;
  position:relative;
  transition:all 0.3s ease;
  cursor:pointer;
  box-shadow:0 2px 8px rgba(0,0,0,0.3);
}
.character-sprite.dead{
  opacity:0.3;
  filter:grayscale(1);
  border-color:#666;
}
.character-sprite.attacking{
  transform:scale(1.15);
  box-shadow:0 0 20px #ffd70088;
  border-color:#ffd700;
}
.character-sprite.defending{
  transform:scale(0.9);
  filter:brightness(0.8);
}
.char-hp-bar{
  width:100%;
  height:8px;
  background:#333;
  border-radius:4px;
  overflow:hidden;
  border:1px solid #555;
  position:relative;
}
.hp-fill{
  height:100%;
  background:linear-gradient(90deg,#4caf50,#8bc34a);
  transition:width 0.5s ease;
  border-radius:3px;
}
.hp-fill.low{
  background:linear-gradient(90deg,#f44336,#ff9800);
}
.hp-fill.mid{
  background:linear-gradient(90deg,#ff9800,#ffc107);
}
.hp-text{
  position:absolute;
  top:0;
  left:50%;
  transform:translateX(-50%);
  font-size:0.6em;
  color:#fff;
  text-shadow:1px 1px 2px rgba(0,0,0,0.8);
  line-height:8px;
}
.enemy-sprite{
  width:90px;
  height:90px;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:2.8em;
  background:linear-gradient(135deg,#744210,#975a16);
  border:3px solid #ff6b6b;
  position:relative;
  transition:all 0.3s ease;
  animation:breathe 3s ease-in-out infinite;
  box-shadow:0 4px 15px rgba(255,107,107,0.3);
}
.enemy-sprite.attacking{
  animation:enemyAttack 0.5s ease-in-out;
}
.enemy-sprite.damaged{
  animation:shake 0.5s ease-in-out;
}
.enemy-hp-bar{
  width:120px;
  height:10px;
  background:#333;
  border-radius:5px;
  overflow:hidden;
  border:1px solid #666;
  margin-top:5px;
  position:relative;
}
.enemy-hp-fill{
  height:100%;
  background:linear-gradient(90deg,#ff6b6b,#ff8a65);
  transition:width 0.5s ease;
  border-radius:4px;
}
.enemy-hp-text{
  position:absolute;
  top:0;
  left:50%;
  transform:translateX(-50%);
  font-size:0.7em;
  color:#fff;
  text-shadow:1px 1px 2px rgba(0,0,0,0.8);
  line-height:10px;
}
.char-status,.enemy-status{
  text-align:center;
  position:relative;
  width:100%;
}
.char-name-mini{
  font-size:0.65em;
  color:#e2e8f0;
  font-weight:bold;
  margin-bottom:3px;
  text-shadow:1px 1px 2px rgba(0,0,0,0.5);
}
.enemy-name-mini{
  font-size:0.75em;
  color:#ff8a65;
  font-weight:bold;
  margin-bottom:3px;
  text-shadow:1px 1px 2px rgba(0,0,0,0.8);
}
.env-description{
  line-height:1.3;
  font-style:italic;
}
.damage-numbers{
  position:absolute;
  top:-20px;
  left:50%;
  transform:translateX(-50%);
  pointer-events:none;
}
.damage-popup{
  position:absolute;
  font-weight:bold;
  font-size:1.1em;
  animation:damageFloat 1.5s ease-out forwards;
  text-shadow:1px 1px 2px rgba(0,0,0,0.8);
}
.damage-popup.damage{color:#ff4444}
.damage-popup.heal{color:#44ff44}
.damage-popup.miss{color:#888;font-size:0.9em}
.hit-flash{animation:flash 0.3s ease-in-out}

/* ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
@keyframes pulse{
  0%,100%{opacity:1}
  50%{opacity:0.6}
}
@keyframes breathe{
  0%,100%{transform:scale(1)}
  50%{transform:scale(1.05)}
}
@keyframes enemyAttack{
  0%{transform:scale(1)}
  25%{transform:scale(1.15) translateX(-10px)}
  75%{transform:scale(1.15) translateX(-10px)}
  100%{transform:scale(1)}
}
@keyframes shake{
  0%,100%{transform:translateX(0)}
  10%,30%,50%,70%,90%{transform:translateX(-2px)}
  20%,40%,60%,80%{transform:translateX(2px)}
}
@keyframes damageFloat{
  0%{opacity:1;transform:translateX(-50%) translateY(0) scale(1)}
  20%{transform:translateX(-50%) translateY(-10px) scale(1.2)}
  100%{opacity:0;transform:translateX(-50%) translateY(-40px) scale(0.8)}
}
@keyframes flash{
  0%,100%{filter:brightness(1)}
  50%{filter:brightness(2.5) saturate(0) contrast(2)}
}
@keyframes glow{
  0%{box-shadow:0 0 5px #ffd700}
  100%{box-shadow:0 0 20px #ffd700, 0 0 30px #ffd700}
}

/* === è¨­å®šç”»é¢ === */
.settings-container{
  max-width:600px;
  margin:0 auto;
  padding:20px;
}
.setting-group{
  background:rgba(22,33,62,0.6);
  border:1px solid #334155;
  border-radius:10px;
  padding:20px;
  margin:20px 0;
}
.setting-group h3{
  color:#ffd700;
  margin-bottom:15px;
  border-bottom:1px solid #334155;
  padding-bottom:5px;
}
.setting-item{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin:10px 0;
  padding:8px;
  background:rgba(13,17,23,0.4);
  border-radius:6px;
}
.setting-item label{
  color:#e2e8f0;
  font-weight:bold;
}
.setting-item select, .setting-item input{
  background:#2d3748;
  color:#e2e8f0;
  border:1px solid #4a5568;
  padding:5px 10px;
  border-radius:4px;
}
.stats-display{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:10px;
}
.stat-line{
  background:rgba(13,17,23,0.4);
  padding:8px 12px;
  border-radius:6px;
  color:#e2e8f0;
  display:flex;
  justify-content:space-between;
}
.stat-line span{
  color:#ffd700;
  font-weight:bold;
}
.setting-buttons{
  display:flex;
  justify-content:center;
  gap:10px;
  flex-wrap:wrap;
}

/* === ã‚¢ãƒãƒ¼ãƒ–ãƒ¡ãƒ³ãƒˆ === */
.achievement-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(200px,1fr));
  gap:10px;
  margin-top:10px;
}
.achievement-item{
  background:rgba(13,17,23,0.4);
  border:1px solid #334155;
  border-radius:8px;
  padding:12px;
  text-align:center;
  transition:all 0.3s ease;
}
.achievement-item.unlocked{
  border-color:#ffd700;
  background:rgba(255,215,0,0.1);
}
.achievement-item.locked{
  opacity:0.5;
}
.achievement-icon{
  font-size:2em;
  margin-bottom:5px;
}
.achievement-name{
  color:#ffd700;
  font-weight:bold;
  font-size:0.9em;
  margin-bottom:3px;
}
.achievement-desc{
  color:#b8b8d0;
  font-size:0.8em;
  line-height:1.2;
}

/* === çµæœç”»é¢æ”¹å–„ === */
.result-container{
  max-width:800px;
  margin:0 auto;
  padding:20px;
}
.result-summary{
  background:linear-gradient(135deg,#1a2a4e,#16213e);
  border:2px solid #ffd700;
  border-radius:15px;
  padding:25px;
  text-align:center;
  margin:20px 0;
}
.result-title-main{
  font-size:2em;
  color:#ffd700;
  margin-bottom:10px;
}
.result-subtitle{
  font-size:1.2em;
  color:#e2e8f0;
  margin-bottom:15px;
}
.result-time{
  color:#aaa;
  font-size:0.9em;
}
.result-stats{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
  gap:15px;
  margin:20px 0;
}
.result-stat-card{
  background:rgba(22,33,62,0.6);
  border:1px solid #334155;
  border-radius:10px;
  padding:15px;
  text-align:center;
}
.result-stat-card h4{
  color:#ffd700;
  margin-bottom:10px;
}
.result-stat-value{
  font-size:1.5em;
  color:#fff;
  font-weight:bold;
}
.result-party{
  background:rgba(22,33,62,0.6);
  border:1px solid #334155;
  border-radius:10px;
  padding:20px;
  margin:20px 0;
}
.result-party h4{
  color:#ffd700;
  text-align:center;
  margin-bottom:15px;
}
.result-party-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(150px,1fr));
  gap:10px;
}
.result-party-member{
  background:rgba(13,17,23,0.4);
  border-radius:8px;
  padding:12px;
  text-align:center;
}
.result-party-member.dead{
  opacity:0.5;
  border:1px solid #666;
}
.result-party-member.alive{
  border:1px solid #4caf50;
}
.result-buttons{
  text-align:center;
  margin:30px 0;
}
.log-line.talk-bubble::before{content:'';position:absolute;left:-8px;top:10px;width:0;height:0;border-top:5px solid transparent;border-bottom:5px solid transparent;border-right:8px solid #2a4e5e}
@keyframes fadeIn{from{opacity:0;transform:translateY(4px)}to{opacity:1;transform:translateY(0)}}

/* çµæœç”»é¢ */
.result-box{background:#16213e;border:2px solid #ffd700;border-radius:12px;padding:24px;margin:20px auto;max-width:500px;text-align:center}
.result-floor{font-size:3em;color:#ffd700;margin:10px 0}
.result-detail{text-align:left;font-size:.85em;line-height:1.8;margin:16px 0;color:#ccc}
.result-detail span{color:#ffd700}
.death-summary{background:#1a1a2e;border-radius:6px;padding:12px;margin:12px 0;text-align:left;font-size:.82em;line-height:1.7}
.death-summary .death{color:#ff6b6b}
.death-summary .love{color:#f783ac}
.speed-control{text-align:center;margin:8px 0}
.speed-control button{font-family:inherit;background:#333;color:#ccc;border:1px solid #555;padding:4px 12px;margin:0 2px;border-radius:4px;cursor:pointer;font-size:.8em}
.speed-control button.active{background:#ffd700;color:#1a1a2e;border-color:#ffd700}

/* === ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ– === */
@media(max-width:600px){
  .char-grid{grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:8px}
  .char-card{padding:10px 8px 8px}
  .char-quote{font-size:.62em}
  .floor-display{font-size:1.4em}
  .party-hp{grid-template-columns:1fr 1fr}
  .hp-bar-wrap{padding:5px 7px}
  .log-area{height:calc(100vh - 200px);font-size:.78em;padding:8px}
  .party-preview-members{gap:6px}
  .party-preview-member{min-width:80px;padding:4px 8px}
  .card-detail{padding:14px;max-width:95vw}
  .screen{padding:8px}
  h1{font-size:1.3em}
}
@media(max-width:768px){
  .adventure-field{
    grid-template-columns:1fr;
    grid-template-rows:auto auto auto;
    gap:10px;
    padding:15px 10px;
    margin:5px;
    min-height:auto;
  }
  .party-grid{
    grid-template-columns:repeat(4, 1fr);
    gap:8px;
  }
  .character-slot{
    min-height:90px;
    padding:5px;
  }
  .character-sprite{
    width:40px;
    height:40px;
    font-size:1.4em;
  }
  .enemy-sprite{
    width:70px;
    height:70px;
    font-size:2.2em;
  }
  .action-description{
    font-size:0.9em;
    padding:10px 15px;
  }
  .speech-bubble{
    max-width:280px;
    padding:8px 12px;
  }
}

@media(max-width:480px){
  .char-grid{grid-template-columns:1fr 1fr;gap:6px}
  .party-hp{grid-template-columns:1fr}
  .party-grid{grid-template-columns:1fr 1fr}
  .character-sprite{width:35px;height:35px;font-size:1.2em}
  .enemy-sprite{width:60px;height:60px;font-size:1.8em}
}
</style>
</head>
<body>

<!-- é¸æŠç”»é¢ -->
<div class="screen active" id="select-screen">
<h1>âš”ï¸ æ·±æ·µã®ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³</h1>
<h2>ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã‚’ç·¨æˆã›ã‚ˆï¼ˆ4äººé¸æŠï¼‰</h2>
<div class="subtitle">ç›¸æ€§ã®è‰¯ã„çµ„ã¿åˆã‚ã›ã‚’è¦‹ã¤ã‘ã¦ã€ã‚ˆã‚Šæ·±ã„éšå±¤ã‚’ç›®æŒ‡ãã†</div>
<div class="party-info" id="party-info">0 / 4 äººé¸æŠä¸­</div>
<div class="char-grid" id="char-grid"></div>
<div class="button-group" style="text-align:center; margin-bottom:80px;">
  <button class="btn" id="continue-btn" onclick="continueGame()" style="display:none; margin: 5px;">ğŸ“– ç¶šãã‹ã‚‰</button>
  <button class="btn" id="start-btn" disabled onclick="startDungeon()" style="margin: 5px;">âš”ï¸ å‡ºç™ºï¼</button>
  <button class="btn" onclick="showSettings()" style="margin: 5px; background:#666;">âš™ï¸ è¨­å®š</button>
</div>
</div>
<!-- ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆå›ºå®šä¸‹éƒ¨ï¼‰ -->
<div class="party-preview" id="party-preview">
<div class="party-preview-inner">
<div class="party-preview-members" id="party-preview-members"></div>
<div class="party-hint" id="party-hint"></div>
</div>
</div>
<!-- ã‚­ãƒ£ãƒ©è©³ç´°ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ— -->
<div class="card-detail-overlay" id="card-detail-overlay">
<div class="card-detail" id="card-detail">
<button class="close-btn" onclick="closeDetail()">&times;</button>
<div id="card-detail-content"></div>
</div>
</div>

<!-- ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ç”»é¢ -->
<div class="screen" id="dungeon-screen">
<div class="dungeon-sticky">
<div class="dungeon-header">
<div class="floor-display" id="floor-display">B1F</div>
<div class="dungeon-controls">
  <div class="speed-control">
    <button onclick="setSpeed(0)" id="spd0">â–¶</button>
    <button onclick="setSpeed(1)" id="spd1" class="active">â–¶â–¶</button>
    <button onclick="setSpeed(2)" id="spd2">â–¶â–¶â–¶</button>
  </div>
  <div class="game-controls">
    <button onclick="saveGame()" class="control-btn" title="ã‚»ãƒ¼ãƒ–">ğŸ’¾</button>
    <button onclick="showSettings()" class="control-btn" title="è¨­å®š">âš™ï¸</button>
    <button onclick="pauseGame()" class="control-btn" id="pause-btn" title="ãƒãƒ¼ã‚º">â¸ï¸</button>
  </div>
</div>
</div>
<div class="party-hp" id="party-hp"></div>
</div>

<!-- æ¢ç´¢ï¼†æˆ¦é—˜ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ -->
<div class="adventure-field" id="adventureField">
  <!-- å·¦å´ï¼šãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ -->
  <div class="party-area">
    <div class="area-title">ğŸ›¡ï¸ ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼</div>
    <div class="party-grid">
      <div class="character-slot" data-index="0">
        <div class="character-sprite" id="char0"></div>
        <div class="char-status">
          <div class="char-name-mini"></div>
          <div class="char-hp-bar">
            <div class="hp-fill" id="charHp0"></div>
            <div class="hp-text" id="charHpText0"></div>
          </div>
          <div class="damage-numbers"></div>
        </div>
      </div>
      <div class="character-slot" data-index="1">
        <div class="character-sprite" id="char1"></div>
        <div class="char-status">
          <div class="char-name-mini"></div>
          <div class="char-hp-bar">
            <div class="hp-fill" id="charHp1"></div>
            <div class="hp-text" id="charHpText1"></div>
          </div>
          <div class="damage-numbers"></div>
        </div>
      </div>
      <div class="character-slot" data-index="2">
        <div class="character-sprite" id="char2"></div>
        <div class="char-status">
          <div class="char-name-mini"></div>
          <div class="char-hp-bar">
            <div class="hp-fill" id="charHp2"></div>
            <div class="hp-text" id="charHpText2"></div>
          </div>
          <div class="damage-numbers"></div>
        </div>
      </div>
      <div class="character-slot" data-index="3">
        <div class="character-sprite" id="char3"></div>
        <div class="char-status">
          <div class="char-name-mini"></div>
          <div class="char-hp-bar">
            <div class="hp-fill" id="charHp3"></div>
            <div class="hp-text" id="charHpText3"></div>
          </div>
          <div class="damage-numbers"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- ä¸­å¤®ï¼šã‚¤ãƒ™ãƒ³ãƒˆè¡¨ç¤ºã‚¨ãƒªã‚¢ -->
  <div class="event-display" id="eventDisplay">
    <div class="floor-info">
      <div class="floor-number" id="fieldFloorDisplay">B1F</div>
      <div class="event-status" id="eventStatus">æ¢ç´¢ä¸­...</div>
    </div>
    <div class="speech-bubble" id="speechBubble" style="display:none;">
      <div class="speech-content" id="speechContent"></div>
    </div>
    <div class="action-description" id="actionDesc">ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ã‚’æ¢ç´¢ã—ã¦ã„ã‚‹</div>
    <div class="event-messages" id="eventMessages"></div>
  </div>

  <!-- å³å´ï¼šæ•µãƒ»ç’°å¢ƒ -->
  <div class="environment-area">
    <div class="area-title" id="envTitle">ğŸŒ‘ æ·±æ·µã®é—‡</div>
    <div class="enemy-container" id="enemyContainer" style="display:none;">
      <div class="enemy-slot">
        <div class="enemy-sprite" id="currentEnemy"></div>
        <div class="enemy-status">
          <div class="enemy-name-mini" id="enemyName"></div>
          <div class="enemy-hp-bar">
            <div class="enemy-hp-fill" id="enemyHpFill"></div>
            <div class="enemy-hp-text" id="enemyHpText"></div>
          </div>
          <div class="damage-numbers"></div>
        </div>
      </div>
    </div>
    <div class="environment-info" id="envInfo">
      <div class="env-description">å†·ãŸã„çŸ³ã®å£ã«å›²ã¾ã‚ŒãŸé€šè·¯</div>
    </div>
  </div>
</div>

<div class="log-area" id="log-area"></div>
</div>

<!-- è¨­å®šç”»é¢ -->
<div class="screen" id="settings-screen">
<h1>âš™ï¸ è¨­å®š</h1>
<div class="settings-container">
  <div class="setting-group">
    <h3>ã‚²ãƒ¼ãƒ è¨­å®š</h3>
    <div class="setting-item">
      <label>æˆ¦é—˜é€Ÿåº¦:</label>
      <select id="default-speed" onchange="updateSettings()">
        <option value="0">é…ã„</option>
        <option value="1" selected>æ™®é€š</option>
        <option value="2">é€Ÿã„</option>
      </select>
    </div>
    <div class="setting-item">
      <label>ã‚ªãƒ¼ãƒˆã‚»ãƒ¼ãƒ–:</label>
      <input type="checkbox" id="auto-save" onchange="updateSettings()" checked>
    </div>
    <div class="setting-item">
      <label>ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³:</label>
      <input type="checkbox" id="animations" onchange="updateSettings()" checked>
    </div>
  </div>
  
  <div class="setting-group">
    <h3>çµ±è¨ˆæƒ…å ±</h3>
    <div class="stats-display" id="stats-display">
      <div class="stat-line">ãƒ—ãƒ¬ã‚¤å›æ•°: <span id="stat-games">0</span>å›</div>
      <div class="stat-line">æœ€é«˜åˆ°é”éšå±¤: <span id="stat-floor">B1F</span></div>
      <div class="stat-line">å€’ã—ãŸãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼: <span id="stat-monsters">0</span>ä½“</div>
      <div class="stat-line">è§£é™¤ã—ãŸç½ : <span id="stat-traps">0</span>å€‹</div>
    </div>
  </div>
  
  <div class="setting-group">
    <h3>ã‚¢ãƒãƒ¼ãƒ–ãƒ¡ãƒ³ãƒˆ</h3>
    <div class="achievements-display" id="achievements-display">
      <div class="achievement-grid" id="achievement-grid"></div>
    </div>
  </div>
  
  <div class="setting-group">
    <h3>ãƒ‡ãƒ¼ã‚¿ç®¡ç†</h3>
    <div class="setting-buttons">
      <button class="btn" onclick="deleteSaveData()" style="background:#d44; margin:5px;">ğŸ—‘ï¸ ã‚»ãƒ¼ãƒ–å‰Šé™¤</button>
      <button class="btn" onclick="resetStats()" style="background:#d44; margin:5px;">ğŸ“Š çµ±è¨ˆãƒªã‚»ãƒƒãƒˆ</button>
    </div>
  </div>
</div>

<button class="btn" onclick="backToSelect()">ğŸ”™ æˆ»ã‚‹</button>
</div>

<!-- çµæœç”»é¢ -->
<div class="screen" id="result-screen">
<h1 id="result-title">ğŸ° æ¢ç´¢çµ‚äº†</h1>
<div class="result-container">
  <div class="result-summary" id="result-summary"></div>
  <div class="result-stats" id="result-stats"></div>
  <div class="result-party" id="result-party"></div>
  <div class="result-achievements" id="result-achievements"></div>
</div>
<div class="result-buttons">
  <button class="btn" onclick="backToSelect()" style="margin: 5px;">ğŸ”„ ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦</button>
  <button class="btn" onclick="shareResult()" style="margin: 5px; background:#1da1f2;">ğŸ“¤ çµæœã‚’ã‚·ã‚§ã‚¢</button>
</div>
</div>

<script>
// ===== ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ =====
const CLASSES = [
  {id:'knight',name:'é¨å£«',icon:'ğŸ›¡ï¸',hp:180,atk:30,def:25,spd:8,desc:'é«˜HPãƒ»é«˜é˜²å¾¡ã®å£å½¹'},
  {id:'mage',name:'é­”è¡“å¸«',icon:'ğŸ”®',hp:80,atk:55,def:8,spd:15,desc:'é«˜ç«åŠ›ãƒ»ç´™è€ä¹…'},
  {id:'healer',name:'ãƒ’ãƒ¼ãƒ©ãƒ¼',icon:'ğŸ’š',hp:100,atk:15,def:12,spd:12,desc:'å›å¾©ã®ã‚¹ãƒšã‚·ãƒ£ãƒªã‚¹ãƒˆ'},
  {id:'thief',name:'ç›—è³Š',icon:'ğŸ—¡ï¸',hp:110,atk:35,def:10,spd:25,desc:'ç´ æ—©ã•ã¨ç½ è§£é™¤'},
  {id:'archer',name:'å¼“ä½¿ã„',icon:'ğŸ¹',hp:120,atk:40,def:14,spd:18,desc:'ãƒãƒ©ãƒ³ã‚¹ã®è‰¯ã„å°„æ‰‹'},
  {id:'priest',name:'åƒ§ä¾¶',icon:'ğŸ“¿',hp:95,atk:20,def:15,spd:10,desc:'ãƒãƒ•ãƒ»ãƒ‡ãƒãƒ•ã®é”äºº'},
];

const NAMES = {
  knight: {m:'ã‚¬ãƒ¬ã‚¹', f:'ã‚¢ãƒ‡ãƒ©ã‚¤ãƒ³'},
  mage:   {m:'ã‚¼ãƒãƒ³', f:'ãƒ«ã‚·ã‚¨ãƒ©'},
  healer: {m:'ã‚¨ãƒ«ãƒãƒ¼', f:'ãƒ•ã‚£ã‚ªãƒŠ'},
  thief:  {m:'ã‚«ã‚¤ãƒˆ', f:'ã‚·ãƒ£ãƒ¼ãƒªã‚£'},
  archer: {m:'ãƒ­ã‚¤ãƒ‰', f:'ã‚¨ãƒ¬ãƒŠ'},
  priest: {m:'ã‚»ãƒ‰ãƒªãƒƒã‚¯', f:'ãƒªãƒªã‚¢ãƒ¼ãƒ'},
};

const GENDERS = [{id:'m',label:'â™‚'},{id:'f',label:'â™€'}];

// ===== æ€§æ ¼è¨­å®š =====
const PERSONALITIES = {
  knight_m: {
    name:'ã‚¬ãƒ¬ã‚¹', trait:'ç”ŸçœŸé¢ç›®ãƒ»æ­£ç¾©æ„Ÿ', traitShort:'ç”ŸçœŸé¢ç›®ãªæ­£ç¾©æ¼¢', quote:'å®ˆã‚‹ã¹ãã‚‚ã®ãŒã‚ã‚‹é™ã‚Šã€å€’ã‚Œã¯ã—ãªã„ï¼', tone:'å …ã„å£èª¿',
    backstory:'é¨å£«å›£ã®æ¬¡ç”·åŠã€‚å…„ã®æˆ¦æ­»å¾Œã€ãã®æ„å¿—ã‚’ç¶™ã„ã§å‰ç·šã«ç«‹ã¤ã€‚',
    battleCry:['ä¿ºãŒå‰ã«å‡ºã‚‹ï¼','å®ˆã‚‹ã¹ãã‚‚ã®ãŒã‚ã‚‹é™ã‚Šã€å€’ã‚Œã¯ã—ãªã„ï¼','ã“ã®ç›¾ãŒã‚ã‚‹é™ã‚Šã€ä»²é–“ã«ã¯æŒ‡ä¸€æœ¬è§¦ã‚Œã•ã›ã‚“ï¼','å…¨å“¡ä¿ºã®å¾Œã‚ã«ä¸‹ãŒã‚Œï¼'],
    battleWin:['ä»»å‹™å®Œäº†ã ','çš†ã€ã‚ˆãã‚„ã£ãŸ','ã¾ã å…ˆã¯é•·ã„ã€‚æ°—ã‚’å¼•ãç· ã‚ã‚'],
    battleHurt:['ãã£...ã“ã®ç¨‹åº¦...ï¼','ã¾ã ã ...ã¾ã ç«‹ã¦ã‚‹ï¼','ç—›ã¿ãªã©ã€è¦šæ‚Ÿã®ä¸Šã '],
    restLine:['å°‘ã—ä¼‘ã‚€ãã€‚äº¤ä»£ã§è¦‹å¼µã‚Šã‚’é ¼ã‚€','...æ•…éƒ·ã®å¤•æ—¥ã‚’æ€ã„å‡ºã™ãª','å‰£ã®æ‰‹å…¥ã‚Œã§ã‚‚ã™ã‚‹ã‹'],
    trapLine:['å…¨å“¡æ­¢ã¾ã‚Œï¼è¶³å…ƒã‚’ç¢ºèªã—ã‚ï¼','ç½ ã‹...æ…é‡ã«é€²ã‚€ã'],
  },
  knight_f: {
    name:'ã‚¢ãƒ‡ãƒ©ã‚¤ãƒ³', trait:'å…ƒãŠå¬¢æ§˜ãƒ»ä¸Šå“ã ãŒèŠ¯ãŒå¼·ã„', traitShort:'æ°—é«˜ããŠå¬¢æ§˜é¨å£«', quote:'ãŠè¦šæ‚Ÿã¯ã‚ˆã‚ã—ãã¦ï¼Ÿ', tone:'ã§ã™ã‚å£èª¿',
    backstory:'åå®¶ã®ä»¤å¬¢ã ã£ãŸãŒã€è­·è¡›é¨å£«ã«æ†§ã‚Œå®¶ã‚’é£›ã³å‡ºã—ãŸã€‚',
    battleCry:['é€€ããªã•ã„ã€‚ã“ã®å‰£ã®éŒ†ã«ã—ã¦ã‚ã’ã¾ã™ã‚','ã‚ãŸãã—ã®å‰ã«ç«‹ã¤ã¨ã¯ã€ã„ã„åº¦èƒ¸ã§ã™ã“ã¨','ãŠè¦šæ‚Ÿã¯ã‚ˆã‚ã—ãã¦ï¼Ÿ','ãƒ¬ãƒ‡ã‚£ã«å‰£ã‚’æŠœã‹ã›ã‚‹ãªã‚“ã¦ã€ä¸‡æ­»ã«å€¤ã—ã¾ã™ã‚'],
    battleWin:['æ±—ã‚’ã‹ã„ã¦ã—ã¾ã„ã¾ã—ãŸã‚...','ãŠç‰‡ä»˜ã‘å®Œäº†ã§ã™ã‚ã­','æ€ã£ãŸã‚ˆã‚Šéª¨ãŒã‚ã‚Šã¾ã—ãŸã‚'],
    battleHurt:['ãã‚ƒã£...ï¼ã“ã€ã“ã®ç¨‹åº¦...ï¼','ãƒ‰ãƒ¬ã‚¹ãŒ...ã„ãˆã€é§ãŒå‚·ã¤ãã¾ã—ãŸã‚ï¼','ç—›ã„...ã§ã™ã‘ã©ã€æ³£ãã¾ã›ã‚“ã‚ã‚ˆ'],
    restLine:['ç´…èŒ¶ãŒæ‹ã—ã„ã§ã™ã‚...','æ˜ŸãŒè¦‹ãˆãªã„ã®ãŒæ®‹å¿µã§ã™ã‚ã­','æ•…éƒ·ã®ãƒãƒ©åœ’ã‚’æ€ã„å‡ºã—ã¾ã™ã‚'],
    trapLine:['ã¾ã‚ã€ãªã‚“ã¦é‡è›®ãªä»•æ›ã‘ã§ã™ã“ã¨','ãŠæ°—ã‚’ã¤ã‘ã¦ã€‚è¶³å…ƒãŒæ€ªã—ã„ã§ã™ã‚'],
  },
  mage_m: {
    name:'ã‚¼ãƒãƒ³', trait:'çŸ¥è­˜æ¬²ã®å¡Šãƒ»å†·ã‚ã¦ã¦çš®è‚‰å±‹', traitShort:'å†·å¾¹ãªçŸ¥è­˜ã®æ¢æ±‚è€…', quote:'çŸ¥è­˜ã“ããŒæœ€å¼·ã®æ­¦å™¨ã ', tone:'ç†çŸ¥çš„ãƒ»çš®è‚‰',
    backstory:'é­”è¡“å­¦é™¢ã‚’ä¸»å¸­å’æ¥­ã€‚å®Ÿåœ°ãƒ‡ãƒ¼ã‚¿åé›†ã®ãŸã‚ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ã«æ½œã‚‹ã€‚',
    battleCry:['ãµã‚€ã€èˆˆå‘³æ·±ã„åå¿œã ','ãƒ‡ãƒ¼ã‚¿ãŒè¶³ã‚Šãªã„ãª...ã‚µãƒ³ãƒ—ãƒ«ã«ãªã£ã¦ã‚‚ã‚‰ãŠã†','ç†è«–é€šã‚Šã«ã„ãã‹ã€æ¤œè¨¼ã•ã›ã¦ã‚‚ã‚‰ã†','é­”åŠ›æ¼”ç®—...å®Œäº†ã€‚æ’ƒã¤ã'],
    battleWin:['æƒ³å®šå†…ã ','ãƒ‡ãƒ¼ã‚¿ã¯å–ã‚ŒãŸã€‚æ¬¡ã«è¡Œã“ã†','ä»®èª¬ã¯æ­£ã—ã‹ã£ãŸã‚ˆã†ã '],
    battleHurt:['ã...è¨ˆç®—å¤–ã ','ç—›è¦šã®ãƒ‡ãƒ¼ã‚¿ãªã©ä¸è¦ãªã‚“ã ãŒ','ãªã‚‹ã»ã©ã€ã“ã®å¨åŠ›ã‹...ãƒ¡ãƒ¢ã—ã¦ãŠã“ã†'],
    restLine:['å°‘ã—è«–æ–‡ã‚’æ›¸ãæ™‚é–“ãŒæ¬²ã—ã„ãª','ã“ã®å£ã®ç´‹æ§˜...å¤ä»£æ–‡å­—ã‹ï¼Ÿèˆˆå‘³æ·±ã„','çŸ¥è­˜ã“ããŒæœ€å¼·ã®æ­¦å™¨ã '],
    trapLine:['ãµã‚€ã€ã“ã®ç½ ã®æ©Ÿæ§‹ã¯...ã„ã‚„ã€ä»Šã¯è§£é™¤ãŒå…ˆã‹','è«–ç†çš„ã«è€ƒãˆã‚Œã°å›é¿ã¯å¯èƒ½ã '],
  },
  mage_f: {
    name:'ãƒ«ã‚·ã‚¨ãƒ©', trait:'å¤©æ‰è‚Œãƒ»å¤©ç„¶ãƒœã‚±', traitShort:'å¤©æ‰è‚Œã®å¤©ç„¶ãƒœã‚±', quote:'ãƒ‰ã‚«ãƒ¼ãƒ³ã§ã„ã„ã‹ï¼', tone:'ãµã‚ãµã‚ãƒ»ãƒã‚¤ãƒšãƒ¼ã‚¹',
    backstory:'é­”æ³•ã®åé–€å®¶ç³»ã ãŒæœ¬äººã¯ç„¡è‡ªè¦šãªå¤©æ‰ã€‚ã‚ˆãé­”æ³•ã‚’é–“é•ãˆã‚‹ã€‚',
    battleCry:['ã‚ã‚Œã€ä»Šã®ã©ã®é­”æ³•ã ã£ã‘...ã¾ã‚ã„ã£ã‹ã€ç‡ƒãˆã¦ã‚‹ã—','ãˆãƒ¼ã£ã¨ã€ãƒ•ã‚¡ã‚¤ã‚¢ã ã£ã‘ï¼Ÿãƒ–ãƒªã‚¶ãƒ‰ã ã£ã‘ï¼Ÿ...ãƒ‰ã‚«ãƒ¼ãƒ³ã§ã„ã„ã‹ï¼','ãã‚‰ãã‚‰ã€œã£ã¦ã‚„ã¤ã€ã„ãã‚ˆã€œ','ã‚ã€å‡ºã¡ã‚ƒã£ãŸï¼ã§ã‚‚å½“ãŸã£ãŸã‹ã‚‰OKï¼'],
    battleWin:['ã‚„ã£ãŸãï¼...ã‚ã‚Œã€ä½•å€’ã—ãŸã‚“ã ã£ã‘','çµ‚ã‚ã£ãŸï¼ŸãŠè…¹ã™ã„ãŸãªã','é­”æ³•ä½¿ã„ã™ãã¦çœ ã„...'],
    battleHurt:['ã„ãŸãŸ...ã‚‚ã†ã€æœãŒç„¦ã’ã¡ã‚ƒã£ãŸ','ãˆã€ç—›ã„ã€‚ç—›ã„ã‚ˆã…','ã†ã‚ãã‚“ã€ä½•ã™ã‚‹ã®ã‰'],
    restLine:['ã­ã‡ã­ã‡ã€ã“ã®å…‰ã‚‹ã‚­ãƒã‚³é£Ÿã¹ã‚‰ã‚Œã‚‹ã‹ãªï¼Ÿ','ãŠæ˜Ÿã•ã¾è¦‹ãˆãªã„ã‹ãªã...åœ°ä¸‹ã ã£ãŸ','ã‚ã€æ–°ã—ã„é­”æ³•æ€ã„ã¤ã„ã¡ã‚ƒã£ãŸ...ã‹ã‚‚'],
    trapLine:['ã‚ã€ä½•ã‹å…‰ã£ã¦ã‚‹ï¼ãã‚Œãƒ¼...ã£ã¦ç½ !?','ã‚ã¶ãªãƒ¼ã„ï¼...ã‚ã‚Œã€ç§ãŒè¸ã‚“ã ï¼Ÿ'],
  },
  healer_m: {
    name:'ã‚¨ãƒ«ãƒãƒ¼', trait:'ç©ã‚„ã‹ãƒ»å„ªã—ã„å…„è²´åˆ†', traitShort:'åŒ…å®¹åŠ›ã®å…„è²´ãƒ’ãƒ¼ãƒ©ãƒ¼', quote:'å¤§ä¸ˆå¤«ã€ä¿ºãŒã¤ã„ã¦ã‚‹', tone:'è½ã¡ç€ã„ãŸå„ªã—ã„å£èª¿',
    backstory:'å­¤å…é™¢è‚²ã¡ã€‚å­ä¾›ãŸã¡ã‚’å®ˆã‚‹ãŸã‚ç™’ã—ã®åŠ›ã‚’ç£¨ã„ãŸã€‚',
    battleCry:['å¤§ä¸ˆå¤«ã€ä¿ºãŒã¤ã„ã¦ã‚‹','ç„¡ç†ã™ã‚‹ãªã‚ˆã€‚å›å¾©ã¯ä»»ã›ã‚','å‰è¡›ã¯æ°—ã«ã›ãšæ”»ã‚ã‚ã€‚å¾Œã‚ã¯ä¿ºãŒå®ˆã‚‹','ã¾ã èª°ã‚‚æ­»ãªã›ã‚„ã—ãªã„'],
    battleWin:['æ€ªæˆ‘ã¯ãªã„ã‹ï¼Ÿè¦‹ã›ã¦ã¿ã‚','ã‚ˆã—ã€å…¨å“¡ç„¡äº‹ã ãª','å‚·ã®æ‰‹å½“ã¦ã‚’ã™ã‚‹ãã€‚ã“ã£ã¡ã«æ¥ã„'],
    battleHurt:['ãã£...ãƒ’ãƒ¼ãƒ©ãƒ¼ãŒå€’ã‚Œã‚‹ã‚ã‘ã«ã¯ã„ã‹ãªã„ã‚“ã ','å¤§ä¸ˆå¤«...è‡ªåˆ†ã§æ²»ã›ã‚‹','å¿ƒé…ã™ã‚‹ãª...ã“ã®ç¨‹åº¦ã€ã™ãæ²»ã‚‹'],
    restLine:['ã»ã‚‰ã€æ¸©ã‹ã„ã‚¹ãƒ¼ãƒ—ã‚’ä½œã£ãŸã','ã¿ã‚“ãªã®é¡”ã‚’è¦‹ã¦ã‚‹ã¨å®‰å¿ƒã™ã‚‹ã‚ˆ','å­¤å…é™¢ã®å­ä¾›ãŸã¡...å…ƒæ°—ã«ã—ã¦ã‚‹ã‹ãª'],
    trapLine:['å±ãªã„ï¼ä¸‹ãŒã£ã¦ã‚ï¼','æ²»ç™‚ã®æº–å‚™ã¯ã§ãã¦ã‚‹ã€‚æ€ã„åˆ‡ã£ã¦è¡Œã‘'],
  },
  healer_f: {
    name:'ãƒ•ã‚£ã‚ªãƒŠ', trait:'ãŠã£ã¨ã‚Šãƒ»èŠ¯ãŒå¼·ã„', traitShort:'èŠ¯ã®å¼·ã„ãŠã£ã¨ã‚Šç™’ã—æ‰‹', quote:'ã¿ãªã•ã‚“ã®å‚·ã¯ç§ãŒå¼•ãå—ã‘ã¾ã™', tone:'ãŠã£ã¨ã‚Šä¸å¯§èª',
    backstory:'æ£®ã®å¥¥ã®è¨ºç™‚æ‰€ã§åƒã„ã¦ã„ãŸã€‚å†’é™ºè€…ã®æ²»ç™‚ãŒãã£ã‹ã‘ã§æ—…ã«å‡ºãŸã€‚',
    battleCry:['ç—›ã„ã®ç—›ã„ã®ã€é£›ã‚“ã§ã„ã‘...æœ¬å½“ã«é£›ã‚“ã§ã„ãã¾ã—ãŸã­','ã¿ãªã•ã‚“ã®å‚·ã¯ç§ãŒå¼•ãå—ã‘ã¾ã™','å€’ã‚Œãªã„ã§ãã ã•ã„...ãŠé¡˜ã„ã—ã¾ã™','ç™’ã—ã®åŠ›ã‚ˆã€ã¿ã‚“ãªã‚’å®ˆã£ã¦'],
    battleWin:['ã‚ˆã‹ã£ãŸ...ã¿ãªã•ã‚“ã”ç„¡äº‹ã§','ãŠç–²ã‚Œæ§˜ã§ã™ã€‚ã™ãæ²»ç™‚ã—ã¾ã™ã­','ãµã…...å¿ƒè‡“ã«æ‚ªã„ã§ã™'],
    battleHurt:['ã‚ã…...ã§ã‚‚ã€ã¿ãªã•ã‚“ã®æ–¹ãŒå¤§äº‹ã§ã™','ç§ã¯å¤§ä¸ˆå¤«...å¤šåˆ†','ã„ãŸãŸ...ã§ã‚‚ã€æ³£ãã¾ã›ã‚“'],
    restLine:['è–¬è‰ã‚’èª¿åˆã—ã¦ãŠãã¾ã™ã­','ã“ã®è‹”ã€è–¬ã«ãªã‚Šãã†ã§ã™','ã¿ãªã•ã‚“ã«ãŠèŒ¶ã‚’...ã‚ã€ææ–™ãŒãªã„...'],
    trapLine:['ã‚ã£ã€ãã“è¸ã‚“ã˜ã‚ƒãƒ€ãƒ¡ã§ã™ï¼','ãŠè–¬ã®æº–å‚™ã¯ã§ãã¦ã¾ã™ã‹ã‚‰ã€å®‰å¿ƒã—ã¦ãã ã•ã„'],
  },
  thief_m: {
    name:'ã‚«ã‚¤ãƒˆ', trait:'ãƒãƒ£ãƒ©ã„ãŒè…•ã¯ä¸€æµ', traitShort:'ãƒãƒ£ãƒ©ã„ãŒè…•ã¯ä¸€æµ', quote:'éš™ã ã‚‰ã‘ã ãœã€ã‚‚ã‚‰ã£ãŸï¼', tone:'è»½ã„ãƒ»ç •ã‘ãŸå£èª¿',
    backstory:'ã‚¹ãƒ©ãƒ è¡—å‡ºèº«ã€‚ç›—ã¿ã§ç”Ÿãå»¶ã³ã¦ããŸãŒã€ä»²é–“ã‚’å¾—ã¦æ­£é“ã«ã€‚',
    battleCry:['ã¸ã¸ã£ã€ãŠå®ã®åŒ‚ã„ãŒã™ã‚‹ãœ','ç½ ï¼Ÿã“ã‚“ãªã®æœé£¯å‰ã ã£ã¦','éš™ã ã‚‰ã‘ã ãœã€ã‚‚ã‚‰ã£ãŸï¼','ä¿ºã®é€Ÿã•ã«ã¤ã„ã¦ã“ã‚Œã‚‹ã‹ãªï¼Ÿ'],
    battleWin:['æ¥½å‹æ¥½å‹ï¼','æˆ¦åˆ©å“ãƒã‚§ãƒƒã‚¯ã€œã£ã¨','ã„ã„æ±—ã‹ã„ãŸãœ'],
    battleHurt:['ã£ã¨ã€å±ã­ã‡ï¼','ã‚„ã¹ã€æ²¹æ–­ã—ãŸ...','ããã£ã€æœãŒç ´ã‚ŒãŸã˜ã‚ƒã­ãƒ¼ã‹'],
    restLine:['ãªã‚ã€ã“ã®ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ã®å®ã£ã¦èª°ã®ã‚‚ã‚“ã ï¼Ÿ','ã‚¹ãƒ©ãƒ ã®é£¯ã®æ–¹ãŒã¾ã ãƒã‚·ã ã£ãŸãª...','é€€å±ˆã ãªã€‚ãƒˆãƒ©ãƒ³ãƒ—ã§ã‚‚ã‚„ã‚‰ã­ã‡ï¼Ÿ'],
    trapLine:['ãŠã£ã¨ã€ã“ã“ãƒ¤ãƒã„ãªã€‚ä¿ºã«ä»»ã›ãª','ã¸ã¸ã€ã“ã†ã„ã†ã®ã¯å¾—æ„ãªã‚“ã ã‚ˆ'],
  },
  thief_f: {
    name:'ã‚·ãƒ£ãƒ¼ãƒªã‚£', trait:'ã‚¯ãƒ¼ãƒ«ãƒ»å¯¡é»™', traitShort:'å¯¡é»™ãªå…ƒæš—æ®ºè€…', quote:'...ä¸€æ’ƒã§çµ‚ã‚ã‚‰ã›ã‚‹', tone:'æœ€å°é™ã®è¨€è‘‰',
    backstory:'æš—æ®ºè€…ã‚®ãƒ«ãƒ‰å‡ºèº«ã€‚ä¾é ¼ã§æ½œã£ãŸãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ã§ä»²é–“ã¨å‡ºä¼šã„è„±é€€ã€‚',
    battleCry:['...è§£é™¤ã—ãŸ','å…ˆã«è¡Œã£ã¦','...ä¸€æ’ƒã§çµ‚ã‚ã‚‰ã›ã‚‹','é»™ã£ã¦è¦‹ã¦ã¦'],
    battleWin:['...çµ‚ã‚ã‚Š','æ¬¡','...å•é¡Œãªã„'],
    battleHurt:['...ã£','æ ã‚Šå‚·','...å¤§ä¸ˆå¤«'],
    restLine:['...é™ã‹ã§ã„ã„','...ãƒŠã‚¤ãƒ•ã®æ‰‹å…¥ã‚Œä¸­','...èµ·ã“ã•ãªã„ã§'],
    trapLine:['...è¸ã‚€ãª','è§£é™¤ã™ã‚‹ã€‚å¾…ã£ã¦'],
  },
  archer_m: {
    name:'ãƒ­ã‚¤ãƒ‰', trait:'çœŸé¢ç›®ãƒ»åŠªåŠ›å®¶ãƒ»è‡ªä¿¡ãŒãªã„', traitShort:'è‡ªä¿¡ãªãåŠªåŠ›å®¶', quote:'...å½“ãŸã‚Œï¼', tone:'æ§ãˆã‚',
    backstory:'çŒŸå¸«ã®å®¶ç³»ã€‚æ‰èƒ½ã¯ã‚ã‚‹ãŒå¤±æ•—ã‚’æã‚Œã‚‹æ€§æ ¼ã€‚',
    battleCry:['...å½“ãŸã‚Œï¼','å¤–ã—ãŸã‚‰ã©ã†ã—ã‚ˆã†ã¨ã‹è€ƒãˆã¡ã‚ƒãƒ€ãƒ¡ã ã‚ˆãª...','é›†ä¸­...é›†ä¸­...ï¼','ä¸€å°„å…¥é­‚...ï¼'],
    battleWin:['å½“ãŸã£ãŸ...ã‚ˆã‹ã£ãŸ...','å¤–ã•ãªãã¦ã‚ˆã‹ã£ãŸ...','ã‚‚ã£ã¨ä¸Šæ‰‹ããªã‚ŠãŸã„ãª...'],
    battleHurt:['ã†ã£...å¼“ãŒ...ï¼','ç«‹ã¡ä½ç½®ãŒæ‚ªã‹ã£ãŸ...åƒ•ã®ãƒŸã‚¹ã ','ç—›ã„...ã‘ã©ã€ã¾ã å°„ã¦ã‚‹'],
    restLine:['å¼“å¼¦ã®èª¿æ•´ã‚’ã—ã¦ãŠã“ã†...','çˆ¶ã•ã‚“ãªã‚‰ã‚‚ã£ã¨ä¸Šæ‰‹ãã‚„ã‚‹ã‚“ã ã‚ã†ãª','çŸ¢ã®æ®‹ã‚ŠãŒå¿ƒé…ã ãª...'],
    trapLine:['å±ãªã„ï¼ã¿ã‚“ãªæ­¢ã¾ã£ã¦ï¼','ã‚ã€ã‚ãã“æ€ªã—ããªã„ã‹ãª...'],
  },
  archer_f: {
    name:'ã‚¨ãƒ¬ãƒŠ', trait:'æ´»ç™ºãƒ»è² ã‘ãšå«Œã„', traitShort:'å…ƒæ°—ã„ã£ã±ã„è² ã‘ãšå«Œã„', quote:'ã‚ãŸã—ã®å¼“ã‚’èˆã‚ãªã„ã§ã‚ˆï¼', tone:'å…ƒæ°—ãƒ»å‹æ°—',
    backstory:'è¾ºå¢ƒã®æ‘å‡ºèº«ã€‚æ‘ä¸€ç•ªã®å¼“ã®è…•å‰ã‚’å¼•ã£æã’ã¦å†’é™ºè€…ã«ã€‚',
    battleCry:['æ¬¡ã¯çµ¶å¯¾å¤–ã•ãªã„ã‹ã‚‰ï¼','ã‚ãŸã—ã®å¼“ã‚’èˆã‚ãªã„ã§ã‚ˆï¼','ã„ã£ãã‚ˆãƒ¼ï¼','ã©çœŸã‚“ä¸­ã¶ã¡æŠœã„ã¦ã‚„ã‚‹ï¼'],
    battleWin:['ã©ã†ï¼Ÿã‚ãŸã—ã®è…•å‰ï¼','ãµãµã‚“ã€ç™¾ç™ºç™¾ä¸­ã‚ˆï¼','ã¾ã€ã“ã‚“ãªã‚‚ã‚“ã‚ˆã­'],
    battleHurt:['ã„ã£ãŸï¼ã‚‚ã†æ€’ã£ãŸï¼','ãã…...å€ã«ã—ã¦è¿”ã™ã‹ã‚‰ã­ï¼','ã“ã®ã£...èˆã‚ãªã„ã§ã‚ˆï¼'],
    restLine:['ã­ã‡ã­ã‡ã€èª°ãŒä¸€ç•ªå¼·ã„ã¨æ€ã†ï¼Ÿã‚ãŸã—ã§ã—ã‚‡ï¼Ÿ','æ•…éƒ·ã®ã¿ã‚“ãªã€é©šãã‹ãªã','çš„å½“ã¦ã‚²ãƒ¼ãƒ ã—ãªã„ï¼Ÿæš‡ãªã‚“ã ã‘ã©'],
    trapLine:['ã‚ã£ï¼å±ãªã£ï¼','çŸ¢ã§é ãã‹ã‚‰èµ·å‹•ã•ã›ã¡ã‚ƒãŠã†ã‹ï¼Ÿ'],
  },
  priest_m: {
    name:'ã‚»ãƒ‰ãƒªãƒƒã‚¯', trait:'æ¸©åšãƒ»ãŸã¾ã«æ¯’èˆŒ', traitShort:'æ¯’èˆŒã®å…ƒå¸ç¥­', quote:'ç¥ã¯è©¦ç·´ãŒãŠå¥½ãã§...', tone:'ç©ã‚„ã‹ã ãŒæ™‚ã€…è¾›è¾£',
    backstory:'å¤§è–å ‚ã®å…ƒå¸ç¥­ã€‚æ•™ä¼šã®å •è½ã«å¤±æœ›ã—ã€æ°‘ã‚’ç›´æ¥æ•‘ã†æ—…ã«å‡ºãŸã€‚',
    battleCry:['ç¥ã®å°ãã§ã™ã‚ˆ...å¤šåˆ†','ç¥ˆã‚Šã¾ã—ã‚‡ã†ã€‚ãã‚Œã—ã‹ã§ãã¾ã›ã‚“ã—','ç¥ã‚ˆã€ã“ã®è€…ãŸã¡ã«æ…ˆæ‚²ã‚’...ã„ãˆã€ã‚„ã¯ã‚Šå¤©ç½°ã‚’','è–ãªã‚‹åŠ›ã§å®ˆã‚Šã¾ã—ã‚‡ã†...é–“ã«åˆãˆã°ã§ã™ãŒ'],
    battleWin:['ç¥ã®ã”åŠ è­·ãŒã‚ã£ãŸã‚ˆã†ã§ã™ã­','ã¾ã‚ã€å®ŸåŠ›ã§ã™ã‘ã©ã­','ç¥ˆã‚ŠãŒå±Šã„ãŸã‚ˆã†ã§ä½•ã‚ˆã‚Šã§ã™'],
    battleHurt:['ãŠã‚„ã€ç—›ã„ã§ã™ã­...å½“ç„¶ã§ã™ãŒ','ç¥ã¯è©¦ç·´ãŒãŠå¥½ãã§...','ã“ã‚Œã‚‚ä¿®è¡Œã¨æ€ãˆã°...ã„ãˆã€æ™®é€šã«ç—›ã„ã§ã™'],
    restLine:['ãŠç¥ˆã‚Šã®æ™‚é–“ã§ã™ã‚ˆã€‚...å†—è«‡ã§ã™ãŒ','ç¥ã¯è¨€ã£ã¦ã„ã¾ã™ã€‚ã€Œå¯ã‚ã€ã¨','æ•™ä¼šã®é£Ÿäº‹ã‚ˆã‚Šã¯ãƒã‚·ã§ã™ã­...ã‚ã‚Œã¯ç½°ã‚²ãƒ¼ãƒ ã§ã—ãŸã‹ã‚‰'],
    trapLine:['ç¥ã®ãŠå°ãã§å›é¿...ã§ãã‚Œã°ã„ã„ã§ã™ã­','ç½ ã§ã™ã‹ã€‚ç¥ã¯ç½ ãŒå¥½ãã§ã™ã‹ã‚‰ã­'],
  },
  priest_f: {
    name:'ãƒªãƒªã‚¢ãƒ¼ãƒ', trait:'ä¸–è©±ç„¼ããƒ»ãŠå§‰ã•ã‚“æ°—è³ª', traitShort:'ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ã®æ¯', quote:'ã‚ãªãŸãŸã¡ã«ã¯ç§ãŒã„ã‚‹ã§ã—ã‚‡ã†ï¼Ÿ', tone:'åŒ…å®¹åŠ›ã®ã‚ã‚‹å§‰å¾¡è‚Œ',
    backstory:'ç¥æ®¿ã®ã‚·ã‚¹ã‚¿ãƒ¼é•·ã€‚é¢å€’è¦‹ãŒè‰¯ã™ãã¦ã€Œãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ã®æ¯ã€ã¨å‘¼ã°ã‚Œã‚‹ã€‚',
    battleCry:['ã»ã‚‰ã€å‰ã‚’å‘ã„ã¦','ã‚ãªãŸãŸã¡ã«ã¯ç§ãŒã„ã‚‹ã§ã—ã‚‡ã†ï¼Ÿ','å¤§ä¸ˆå¤«ã€ã¿ã‚“ãªã‚’å®ˆã‚‹ã‚','æ€–ãŒã‚‰ãªã„ã§ã€‚ç§ãŒç¥ˆã‚Šã§åŒ…ã‚€ã‹ã‚‰'],
    battleWin:['ã¿ã‚“ãªé ‘å¼µã£ãŸã‚ã­','æ€ªæˆ‘ã¯ï¼Ÿè¦‹ã›ã¦ã”ã‚‰ã‚“','ã•ã‚ã€å…ˆã«é€²ã¿ã¾ã—ã‚‡ã†'],
    battleHurt:['ã‚ã‚‰ã€ã‚„ã‚‹ã˜ã‚ƒãªã„...','ç§ãŒå€’ã‚ŒãŸã‚‰èª°ãŒã¿ã‚“ãªã‚’ä¸–è©±ã™ã‚‹ã®','ç—›ã„...ã‘ã©ã€ã¿ã‚“ãªã®å‰ã§ã¯æ³£ã‹ãªã„ã‚'],
    restLine:['ã¯ã„ã€åŒ…å¸¯æ›¿ãˆã‚‹ã‚ã‚ˆã€‚ã˜ã£ã¨ã—ã¦','ã¿ã‚“ãªã¡ã‚ƒã‚“ã¨é£Ÿã¹ãŸï¼Ÿæ®‹ã—ã¡ã‚ƒãƒ€ãƒ¡ã‚ˆ','æ•…éƒ·ã®å­ä¾›ãŸã¡ã«ãŠåœŸç”£ã‚’è²·ã‚ãªãã‚ƒ'],
    trapLine:['è¶³å…ƒæ°—ã‚’ã¤ã‘ã¦ï¼ã»ã‚‰ã€ã¡ã‚ƒã‚“ã¨å‰ã‚’è¦‹ã‚‹ï¼','ã¿ã‚“ãªç§ã®å¾Œã‚ã«ã€‚...ã„ãˆã€ç§ã®å‰ã«'],
  },
};

// ===== æ›ã‘åˆã„ä¼šè©±ãƒ‡ãƒ¼ã‚¿ =====
const BANTER = {
  // === æ±ç”¨é›‘è«‡ï¼ˆãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼å†…ã€ä»»æ„2äººï¼‰ ===
  generic: [
    {lines:['{a}ã€Œã“ã®å…ˆã€ã¾ã é•·ã„ã®ã‹ãª...ã€','{b}ã€Œå¼±éŸ³ã‚’åããªã€‚...ä¿ºã‚‚å°‘ã—æ€ã£ãŸãŒã€']},
    {lines:['{a}ã€Œè…¹æ¸›ã£ãŸãªã...ã€','{b}ã€Œæˆ‘æ…¢ã—ãªã•ã„ã€‚ã‚‚ã†å°‘ã—ã§ä¼‘æ†©ã§ãã‚‹ã¯ãšã‚ˆã€']},
    {lines:['{a}ã€Œã“ã“ã®å£ã€ãªã‚“ã‹å…‰ã£ã¦ãªã„ï¼Ÿã€','{b}ã€Œè§¦ã‚‹ãªï¼...è§¦ã‚‹ãªã‚ˆï¼Ÿçµ¶å¯¾ã ãï¼Ÿã€','{a}ã€Œè§¦ã£ã¦ã¿ãŸã€','{b}ã€ŒãŠã„ï¼ï¼ã€']},
    {lines:['{a}ã€Œåœ°ä¸Šã«æˆ»ã£ãŸã‚‰ä½•é£Ÿã¹ãŸã„ï¼Ÿã€','{b}ã€Œ...è‚‰ã€','{a}ã€Œå³ç­”ã˜ã‚ƒã‚“ã€']},
    {lines:['{a}ã€Œãªã‚“ã§ã“ã‚“ãªä»•äº‹é¸ã‚“ã ã‚“ã ã‚ã†ãª...ã€','{b}ã€Œä»Šãã‚Œè¨€ã†ï¼Ÿã€','{a}ã€Œã„ã‚„ã€ãµã¨...ã€']},
    {lines:['{a}ã€Œã•ã£ãã®æˆ¦é—˜ã€ã‹ã£ã“ã‚ˆã‹ã£ãŸãã€','{b}ã€Œãˆ...ãã€ãã†ã‹ï¼Ÿã‚ã‚ŠãŒã¨ã†ã€']},
    {lines:['{a}ã€Œã­ã‡ã€ã‚ã®è§’ã®å…ˆã«ä½•ãŒã‚ã‚‹ã¨æ€ã†ï¼Ÿã€','{b}ã€Œ...æ•µã˜ã‚ƒãªã„ã“ã¨ã‚’ç¥ˆã‚‹ã€']},
    {lines:['{a}ã€Œè¶³éŸ³ã‚’ç«‹ã¦ã‚‹ãª...é™ã‹ã«...ã€','{b}ã€ŒãŠå‰ã®å£°ã®æ–¹ãŒã†ã‚‹ã•ã„ã€']},
    {lines:['{a}ã€Œãªã‚“ã‹ä»Šæ—¥ã€ãƒ„ã‚¤ã¦ã‚‹æ°—ãŒã™ã‚‹ã‚“ã ã‚ˆãªã€','{b}ã€Œãƒ•ãƒ©ã‚°ã‚’ç«‹ã¦ã‚‹ã®ã¯ã‚„ã‚ã¦ãã‚Œã€']},
    {lines:['{a}ã€Œå¸°ã£ãŸã‚‰é¢¨å‘‚å…¥ã‚ŠãŸã„...ã€','{b}ã€ŒåŒæ„Ÿã ã€‚ã‚‚ã†3æ—¥å…¥ã£ã¦ãªã„ã€','{a}ã€Œ...è¿‘å¯„ã‚‰ãªã„ã§ã€']},
    {lines:['{a}ã€Œã•ã£ãä½•ã‹å‹•ã‹ãªã‹ã£ãŸï¼Ÿã€','{b}ã€Œ...æ°—ã®ã›ã„ã ã‚ã€','{a}ã€Œ...ã ã‚ˆã­ã€‚ã†ã‚“ã€‚æ°—ã®ã›ã„ã€']},
    {lines:['{a}ã€Œå†’é™ºè€…ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã¨ã‹ã‚ã£ãŸã‚‰ã€ä¿ºã‚‰ä½•ä½ã‹ãªã€','{b}ã€Œç”Ÿãã¦å¸°ã‚ŒãŸã‚‰ãƒ©ãƒ³ã‚­ãƒ³ã‚°å…¥ã‚Šã˜ã‚ƒãªã„ï¼Ÿã€']},
    {lines:['{a}ã€Œãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ã®ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã£ã¦æ™®æ®µä½•ã—ã¦ã‚‹ã‚“ã ã‚ã€','{b}ã€Œ...è€ƒãˆãŸã“ã¨ã‚‚ãªã‹ã£ãŸãªã€']},
    {lines:['{a}ã€Œã“ã®æ¾æ˜ã€ã‚ã¨ã©ã‚Œãã‚‰ã„æŒã¤ã‹ãªã€','{b}ã€Œè€ƒãˆãªã„ã“ã¨ã«ã—ã¦ã‚‹ã€']},
    {lines:['{a}ã€Œå‰ã®ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã¯ã“ã“ã¾ã§æ¥ã‚ŒãŸã®ã‹ãª...ã€','{b}ã€Œ...ã‚ã®éª¨ã‚’è¦‹ã‚‹é™ã‚Šã€æ¥ã‚ŒãŸã‚“ã ã‚ã†ãªã€','{a}ã€Œã‚„ã‚ã¦ã€']},
    {lines:['{a}ã€Œã¡ã‚‡ã£ã¨ä¼‘æ†©ã—ãªã„ï¼Ÿã€','{b}ã€Œæ•µã®å‰ã§è¨€ã†ã‚»ãƒªãƒ•ã˜ã‚ƒãªã„ã§ã—ã‚‡ã€']},
    {lines:['{a}ã€Œãªãã€ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼åæ±ºã‚ã‚ˆã†ãœã€','{b}ã€Œä»Šï¼Ÿã€','{a}ã€Œæš‡ã˜ã‚ƒã‚“ã€']},
    {lines:['{a}ã€Œæ°´ã®éŸ³ãŒã™ã‚‹...æ³‰ã‹ãªã€','{b}ã€Œç½ ã‹ã‚‚ã—ã‚Œãªã„ãã€','{a}ã€Œå¤¢ãŒãªã„ãªãã€']},
    {lines:['{a}ã€Œã“ã“ã€å‰ã«æ¥ãŸã“ã¨ã‚ã‚‹ã‚ˆã†ãª...ã€','{b}ã€Œãƒ‡ã‚¸ãƒ£ãƒ–ã£ã¦ã‚„ã¤ï¼Ÿãã‚Œã¨ã‚‚è¿·ã£ã¦ã‚‹ï¼Ÿã€','{a}ã€Œ...è¿·ã£ã¦ã‚‹ã‹ã‚‚ã€']},
    {lines:['{a}ã€Œã¿ã‚“ãªã®ãŠã‹ã’ã§ã“ã“ã¾ã§æ¥ã‚ŒãŸãªã€','{b}ã€Œæ€¥ã«ã©ã†ã—ãŸã€‚æ­»äº¡ãƒ•ãƒ©ã‚°ã‹ï¼Ÿã€','{a}ã€Œé•ã†ã‚ˆï¼ç´ ç›´ã«æ„Ÿè¬ã—ãŸã‚“ã ã‚ˆï¼ã€']},
  ],

  // === æˆ¦é—˜ä¸­ã®æ›ã‘åˆã„ ===
  battleGeneric: [
    {lines:['{a}ã€Œä»Šã ï¼ã€','{b}ã€Œä»»ã›ã‚ï¼ã€']},
    {lines:['{a}ã€Œæ´è­·ã™ã‚‹ï¼ã€','{b}ã€ŒåŠ©ã‹ã‚‹ï¼ã€']},
    {lines:['{a}ã€Œãƒ¤ãƒã„ã£ã¦ï¼ã€','{b}ã€Œã¾ã ã‚„ã‚Œã‚‹...ï¼ã€']},
    {lines:['{a}ã€Œå³ã‹ã‚‰æ¥ã‚‹ãï¼ã€','{b}ã€Œã‚ã‹ã£ã¦ã‚‹ï¼ã€']},
    {lines:['{a}ã€Œç„¡èŒ¶ã™ã‚‹ãªï¼ã€','{b}ã€Œç„¡èŒ¶ã—ãªã„ã¨æ­»ã¬ã ã‚ï¼ã€']},
    {lines:['{a}ã€Œã“ã£ã¡ã¯ç‰‡ä»˜ã„ãŸï¼ãã£ã¡ã¯ï¼ï¼Ÿã€','{b}ã€Œã‚‚ã†ã¡ã‚‡ã£ã¨...ï¼ã€']},
    {lines:['{a}ã€Œé€£æºã„ããï¼ã€','{b}ã€Œåˆã‚ã›ã‚‹ï¼ã€']},
    {lines:['{a}ã€Œä¸‹ãŒã‚Œï¼äº¤ä»£ã ï¼ã€','{b}ã€Œã¾ã ã‚„ã‚Œ...ã„ã‚„ã€é ¼ã‚€ã€']},
  ],

  // === ä¼‘æ†©ä¸­ã®æ›ã‘åˆã„ ===
  restGeneric: [
    {lines:['{a}ã€Œç„šãç«ãŒã‚ã‚‹ã¨ã»ã£ã¨ã™ã‚‹ãª...ã€','{b}ã€Œã†ã‚“...ä¸€ç¬ã ã‘ã€å†’é™ºã—ã¦ã‚‹ã“ã¨å¿˜ã‚Œã‚‹ã­ã€']},
    {lines:['{a}ã€Œæ•…éƒ·ã€ã©ã‚“ãªã¨ã“ï¼Ÿã€','{b}ã€Œ...æµ·ãŒè¦‹ãˆã‚‹å°ã•ãªæ‘ã€‚å¸°ã‚ŠãŸã„ãªã€ãŸã¾ã«ã€']},
    {lines:['{a}ã€Œå°†æ¥ã®å¤¢ã¨ã‹ã‚ã‚‹ï¼Ÿã€','{b}ã€Œç”Ÿãã¦å¸°ã‚‹ã“ã¨ã€','{a}ã€Œåˆ‡å®Ÿã™ãã‚‹ã€']},
    {lines:['{a}ã€Œä¿å­˜é£Ÿã°ã£ã‹ã§é£½ããŸãª...ã€','{b}ã€Œè´…æ²¢è¨€ã†ãªã€‚é£Ÿãˆã‚‹ã ã‘ãƒã‚·ã ã€']},
    {lines:['{a}ã€Œæ˜ŸãŒè¦‹ãŸã„ãª...ã€','{b}ã€Œåœ°ä¸Šã«å‡ºãŸã‚‰ã€ä¸€ç·’ã«è¦‹ã‚ˆã†ãªã€']},
  ],

  // === ã‚­ãƒ£ãƒ©å›ºæœ‰ãƒšã‚¢æ›ã‘åˆã„ ===
  pair: {
    // ã‚«ã‚¤ãƒˆ Ã— ã‚¬ãƒ¬ã‚¹
    'thief_m:knight_m': [
      {lines:['ã‚«ã‚¤ãƒˆã€Œãªã‚ã€ã“ã®ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ã®å®ã£ã¦èª°ã®ã‚‚ã‚“ã ï¼Ÿã€','ã‚¬ãƒ¬ã‚¹ã€Œ...å‡ç­‰ã«åˆ†é…ã™ã‚‹ã«æ±ºã¾ã£ã¦ã„ã‚‹ã€','ã‚«ã‚¤ãƒˆã€Œã¤ã¾ã‚“ã­ãƒ¼ã®ã€']},
      {lines:['ã‚«ã‚¤ãƒˆã€Œã‚¬ãƒ¬ã‚¹ã£ã¦å …ã™ããªã„ï¼ŸãŸã¾ã«ã¯å†—è«‡è¨€ãˆã‚ˆã€','ã‚¬ãƒ¬ã‚¹ã€Œå†—è«‡ã‹...ã§ã¯ä¸€ã¤ã€‚ãŠå‰ã®æˆ¦ã„æ–¹ã¯å†—è«‡ã¿ãŸã„ã ãªã€','ã‚«ã‚¤ãƒˆã€Œãã‚Œå†—è«‡ã˜ã‚ƒãªãã¦æ‚ªå£ã ã‚ï¼ã€']},
      {lines:['ã‚«ã‚¤ãƒˆã€Œãªãã€ä¿ºãŒãƒ”ãƒ³ãƒã®æ™‚ã¯åŠ©ã‘ã¦ãã‚Œã‚‹ã‚ˆãªï¼Ÿã€','ã‚¬ãƒ¬ã‚¹ã€Œå½“ç„¶ã ã€‚ä»²é–“ã‚’è¦‹æ¨ã¦ã‚‹é¨å£«ãŒã„ã‚‹ã‹ã€','ã‚«ã‚¤ãƒˆã€Œ...ãŠå‰ã€ãŸã¾ã«ã‚«ãƒƒã‚³ã„ã„ã“ã¨è¨€ã†ã‚ˆãªã€']},
      {lines:['ã‚¬ãƒ¬ã‚¹ã€Œã‚«ã‚¤ãƒˆã€åµå¯Ÿã‚’é ¼ã‚€ã€','ã‚«ã‚¤ãƒˆã€Œã¸ã„ã¸ã„ã€‚ä¿ºã¯ãƒ‘ã‚·ãƒªã‹ï¼Ÿã€','ã‚¬ãƒ¬ã‚¹ã€Œæœ€ã‚‚é©ä»»ã ã¨è¨€ã£ã¦ã„ã‚‹ã€','ã‚«ã‚¤ãƒˆã€Œ...è¤’ã‚ã¦ã‚“ã®ã‹è²¶ã—ã¦ã‚“ã®ã‹ã€']},
    ],
    // ã‚¼ãƒãƒ³ Ã— ãƒ«ã‚·ã‚¨ãƒ©
    'mage_m:mage_f': [
      {lines:['ã‚¼ãƒãƒ³ã€Œãƒ«ã‚·ã‚¨ãƒ©ã€ã•ã£ãã®é­”æ³•ã®å±æ€§ã¯ä½•ã ï¼Ÿã€','ãƒ«ã‚·ã‚¨ãƒ©ã€Œãˆãƒ¼ã£ã¨...ãƒ‰ã‚«ãƒ¼ãƒ³ç³»ï¼Ÿã€','ã‚¼ãƒãƒ³ã€Œ...å­¦è¡“çš„ã«é ¼ã‚€ã€']},
      {lines:['ãƒ«ã‚·ã‚¨ãƒ©ã€Œã‚¼ãƒãƒ³ã£ã¦é›£ã—ã„æœ¬ã°ã£ã‹ã‚Šèª­ã‚“ã§ã‚‹ã‚ˆã­ã€','ã‚¼ãƒãƒ³ã€ŒçŸ¥è­˜ã¯åŠ›ã ã€','ãƒ«ã‚·ã‚¨ãƒ©ã€Œã‚ãŸã—ã¯æ„Ÿè¦šæ´¾ã ã‹ã‚‰ãªãã€œã€','ã‚¼ãƒãƒ³ã€Œãã‚Œã§å¤©æ‰ã¨ã„ã†ã®ãŒä¸€ç•ªè…¹ç«‹ã¤ã‚“ã ãŒã€']},
      {lines:['ã‚¼ãƒãƒ³ã€Œãã®æ‰èƒ½ã‚’ç„¡é§„é£ã„ã™ã‚‹ãªã€','ãƒ«ã‚·ã‚¨ãƒ©ã€Œç„¡é§„é£ã„ã—ã¦ãªã„ã‚ˆï¼Ÿã»ã‚‰ã€ã´ã‹ãƒ¼ã€','ã‚¼ãƒãƒ³ã€Œãã‚Œç…§æ˜é­”æ³•ã ã‚ã†ã€‚æˆ¦é—˜ä¸­ã«ä½¿ãˆã€']},
    ],
    // ã‚¨ãƒ«ãƒãƒ¼ Ã— ãƒ•ã‚£ã‚ªãƒŠ
    'healer_m:healer_f': [
      {lines:['ã‚¨ãƒ«ãƒãƒ¼ã€Œãƒ•ã‚£ã‚ªãƒŠã€ç„¡ç†ã—ã¦ãªã„ã‹ï¼Ÿã€','ãƒ•ã‚£ã‚ªãƒŠã€Œã‚¨ãƒ«ãƒãƒ¼ã•ã‚“ã“ã...ã„ã¤ã‚‚äººã®å¿ƒé…ã°ã‹ã‚Šã€','ã‚¨ãƒ«ãƒãƒ¼ã€ŒãŠäº’ã„æ§˜ã ãªã€‚ãƒ’ãƒ¼ãƒ©ãƒ¼ã®æ€§åˆ†ã ã€']},
      {lines:['ãƒ•ã‚£ã‚ªãƒŠã€Œã‚¨ãƒ«ãƒãƒ¼ã•ã‚“ã€ã“ã®è–¬è‰ã®é…åˆè¦‹ã¦ã‚‚ã‚‰ãˆã¾ã™ã‹ï¼Ÿã€','ã‚¨ãƒ«ãƒãƒ¼ã€Œã‚ã‚ã€ã„ã„ãã€‚...ã“ã‚Œã€ãƒ•ã‚£ã‚ªãƒŠã®æ–¹ãŒä¸Šæ‰‹ã„ã ã‚ã€','ãƒ•ã‚£ã‚ªãƒŠã€Œãã‚“ãªã“ã¨ãªã„ã§ã™...ãˆã¸ã¸ã€']},
      {lines:['ã‚¨ãƒ«ãƒãƒ¼ã€Œå›å¾©ã¯ä¿ºã«ä»»ã›ã¦ã€ãƒ•ã‚£ã‚ªãƒŠã¯å°‘ã—ä¼‘ã‚ã€','ãƒ•ã‚£ã‚ªãƒŠã€Œã§ã‚‚...ã€','ã‚¨ãƒ«ãƒãƒ¼ã€Œãƒ’ãƒ¼ãƒ©ãƒ¼ãŒå€’ã‚ŒãŸã‚‰å…ƒã‚‚å­ã‚‚ãªã„ã ã‚ï¼Ÿã€']},
    ],
    // ã‚«ã‚¤ãƒˆ Ã— ã‚·ãƒ£ãƒ¼ãƒªã‚£
    'thief_m:thief_f': [
      {lines:['ã‚«ã‚¤ãƒˆã€Œãªãã‚·ãƒ£ãƒ¼ãƒªã‚£ã€ãŸã¾ã«ã¯ç¬‘ãˆã‚ˆã€','ã‚·ãƒ£ãƒ¼ãƒªã‚£ã€Œ...å¿…è¦ãªã„ã€','ã‚«ã‚¤ãƒˆã€Œã¤ã‚Œãªã„ã­ã‡ã€‚å¯æ„›ã„é¡”ã—ã¦ã‚“ã®ã«ã‚‚ã£ãŸã„ãªã„ã€','ã‚·ãƒ£ãƒ¼ãƒªã‚£ã€Œ...ã†ã‚‹ã•ã„ã€']},
      {lines:['ã‚«ã‚¤ãƒˆã€Œã“ã®ç½ ã€ä¿ºã¨ãŠå‰ã©ã£ã¡ãŒæ—©ãè§£é™¤ã§ãã‚‹ã‹å‹è² ã—ã­ï¼Ÿã€','ã‚·ãƒ£ãƒ¼ãƒªã‚£ã€Œ...ã‚‚ã†è§£é™¤ã—ãŸã€','ã‚«ã‚¤ãƒˆã€Œã¯ï¼Ÿæ—©ã£ï¼ã€']},
      {lines:['ã‚·ãƒ£ãƒ¼ãƒªã‚£ã€Œ...ã‚ã‚“ãŸã®è¶³éŸ³ã€ã†ã‚‹ã•ã„ã€','ã‚«ã‚¤ãƒˆã€Œãˆã£ã€ä¿ºãã‚“ãªã«éŸ³ç«‹ã¦ã¦ã‚‹ï¼Ÿã€','ã‚·ãƒ£ãƒ¼ãƒªã‚£ã€Œç›—è³Šå¤±æ ¼ã€','ã‚«ã‚¤ãƒˆã€Œæ‰‹å³ã—ã„ãªï¼ã€']},
    ],
    // ãƒ­ã‚¤ãƒ‰ Ã— ã‚¨ãƒ¬ãƒŠ
    'archer_m:archer_f': [
      {lines:['ã‚¨ãƒ¬ãƒŠã€Œã­ãˆãƒ­ã‚¤ãƒ‰ã€ã•ã£ãã®å°„æ’ƒã©ã†ã ã£ãŸï¼Ÿã€','ãƒ­ã‚¤ãƒ‰ã€Œã™ã€ã™ã”ã‹ã£ãŸã‚ˆ...åƒ•ã«ã¯ã‚ã‚“ãªé€Ÿå°„ã§ããªã„ã€','ã‚¨ãƒ¬ãƒŠã€Œã§ã—ã‚‡ï¼ã§ã‚‚ãƒ­ã‚¤ãƒ‰ã®ç²¾å¯†å°„æ’ƒã‚‚ã™ã”ã„ã¨æ€ã†ã‚ˆã€','ãƒ­ã‚¤ãƒ‰ã€Œãˆ...ã‚ã‚ŠãŒã¨ã†ã€']},
      {lines:['ãƒ­ã‚¤ãƒ‰ã€Œã‚¨ãƒ¬ãƒŠã€çŸ¢ã®æ®‹ã‚Šå¤§ä¸ˆå¤«ï¼Ÿã€','ã‚¨ãƒ¬ãƒŠã€Œä½™è£•ã‚ˆï¼ãƒ­ã‚¤ãƒ‰ã“ãã€å¼“å¼¦åˆ‡ã‚Œãã†ã˜ã‚ƒãªã„ï¼Ÿã€','ãƒ­ã‚¤ãƒ‰ã€Œã‚ã£...æœ¬å½“ã ã€‚ã‚ã‚ŠãŒã¨ã†ã€æ°—ã¥ã‹ãªã‹ã£ãŸã€']},
      {lines:['ã‚¨ãƒ¬ãƒŠã€Œã‚ãŸã—ã¨ã©ã£ã¡ãŒä¸Šæ‰‹ã„ã‹ã€æ±ºç€ã¤ã‘ã‚ˆã†ã‚ˆï¼ã€','ãƒ­ã‚¤ãƒ‰ã€Œãˆã€é æ…®ã—ã¨ã...çµ¶å¯¾ã‚¨ãƒ¬ãƒŠã®æ–¹ãŒä¸Šæ‰‹ã„ã—...ã€','ã‚¨ãƒ¬ãƒŠã€Œã‚‚ã†ï¼ãã†ã„ã†ã¨ã“ï¼è‡ªä¿¡æŒã¡ãªã‚ˆï¼ã€']},
    ],
    // ã‚»ãƒ‰ãƒªãƒƒã‚¯ Ã— ãƒªãƒªã‚¢ãƒ¼ãƒ
    'priest_m:priest_f': [
      {lines:['ã‚»ãƒ‰ãƒªãƒƒã‚¯ã€Œãƒªãƒªã‚¢ãƒ¼ãƒæ®¿ã¯ç›¸å¤‰ã‚ã‚‰ãšä¸–è©±ç„¼ãã§ã™ã­ã€','ãƒªãƒªã‚¢ãƒ¼ãƒã€Œã‚ãªãŸã¯ç›¸å¤‰ã‚ã‚‰ãšæ¯’èˆŒã­ã€ã‚»ãƒ‰ãƒªãƒƒã‚¯ã€','ã‚»ãƒ‰ãƒªãƒƒã‚¯ã€Œã“ã‚Œã§ã‚‚æŠ‘ãˆã¦ã‚‹ã‚“ã§ã™ã‚ˆã€','ãƒªãƒªã‚¢ãƒ¼ãƒã€Œ...ã‚‚ã£ã¨æŠ‘ãˆã¦ï¼Ÿã€']},
      {lines:['ãƒªãƒªã‚¢ãƒ¼ãƒã€Œã‚»ãƒ‰ãƒªãƒƒã‚¯ã€ã¡ã‚ƒã‚“ã¨é£Ÿã¹ãŸï¼Ÿã€','ã‚»ãƒ‰ãƒªãƒƒã‚¯ã€Œã¯ã„ã¯ã„ã€æ¯ä¸Šã€','ãƒªãƒªã‚¢ãƒ¼ãƒã€Œæ¯ä¸Šã£ã¦è¨€ã‚ãªã„ã§ï¼ãŠå§‰ã•ã‚“ã‚ˆï¼ã€']},
      {lines:['ã‚»ãƒ‰ãƒªãƒƒã‚¯ã€Œç¥ã¯äºŒäººã‚‚åƒ§ä¾¶ã‚’é€ã£ã¦ã©ã†ã™ã‚‹ã¤ã‚‚ã‚Šã§ã™ã‹ã­ã€','ãƒªãƒªã‚¢ãƒ¼ãƒã€ŒäºŒäººã„ãŸæ–¹ãŒå®‰å¿ƒã§ã—ã‚‡ã†ï¼Ÿã€','ã‚»ãƒ‰ãƒªãƒƒã‚¯ã€Œã¾ã‚...å¦å®šã¯ã—ã¾ã›ã‚“ã€']},
    ],
    // ã‚¬ãƒ¬ã‚¹ Ã— ãƒ•ã‚£ã‚ªãƒŠï¼ˆæ‹æ„›ãƒšã‚¢ï¼‰
    'knight_m:healer_f': [
      {lines:['ã‚¬ãƒ¬ã‚¹ã€Œãƒ•ã‚£ã‚ªãƒŠã€å¾Œã‚ã«ä¸‹ãŒã£ã¦ã„ã‚ã€','ãƒ•ã‚£ã‚ªãƒŠã€Œã§ã‚‚ã€ã‚¬ãƒ¬ã‚¹ã•ã‚“ã®å‚·ãŒ...ã€','ã‚¬ãƒ¬ã‚¹ã€Œã“ã®ç¨‹åº¦...æ°—ã«ã™ã‚‹ãªã€','ãƒ•ã‚£ã‚ªãƒŠã€Œæ°—ã«ã—ã¾ã™ï¼ã˜ã£ã¨ã—ã¦ãã ã•ã„ï¼ã€']},
      {lines:['ãƒ•ã‚£ã‚ªãƒŠã€Œã‚¬ãƒ¬ã‚¹ã•ã‚“ã€ã„ã¤ã‚‚ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€','ã‚¬ãƒ¬ã‚¹ã€Œ...ç¤¼ã‚’è¨€ã†ã®ã¯ä¿ºã®æ–¹ã ã€‚ãŠå‰ã®å›å¾©ãŒãªã‘ã‚Œã°...ã€','ãƒ•ã‚£ã‚ªãƒŠã€Œãµãµã€ãŠäº’ã„æ§˜ã§ã™ã­ã€']},
      {lines:['ã‚¬ãƒ¬ã‚¹ã€Œ...ãã‚Œã„ã ãªã€','ãƒ•ã‚£ã‚ªãƒŠã€Œãˆï¼Ÿã€','ã‚¬ãƒ¬ã‚¹ã€Œã„ã€ã„ã‚„ï¼ã“ã®...è‹”ãŒï¼è‹”ãŒç™ºå…‰ã—ã¦ãã‚Œã„ã ãªã¨ï¼ã€','ãƒ•ã‚£ã‚ªãƒŠã€Œ...ãµãµã€ãã†ã§ã™ã­ã€']},
    ],
    // ã‚¼ãƒãƒ³ Ã— ã‚¨ãƒ¬ãƒŠï¼ˆæ‹æ„›ãƒšã‚¢ï¼‰
    'mage_m:archer_f': [
      {lines:['ã‚¨ãƒ¬ãƒŠã€Œã‚¼ãƒãƒ³ã€ã¾ãŸé›£ã—ã„é¡”ã—ã¦ã‚‹ï¼ã€','ã‚¼ãƒãƒ³ã€Œè€ƒãˆäº‹ã‚’ã—ã¦ã„ã‚‹ã€‚é™ã‹ã«ã—ã¦ãã‚Œã€','ã‚¨ãƒ¬ãƒŠã€Œãˆãƒ¼ã€ã¤ã¾ã‚“ãªã„ï¼ã­ã‡è©±ãã†ã‚ˆï¼ã€','ã‚¼ãƒãƒ³ã€Œ...ã‚„ã‚Œã‚„ã‚Œã€']},
      {lines:['ã‚¼ãƒãƒ³ã€Œãã®å°„æ’ƒç²¾åº¦...èˆˆå‘³æ·±ã„ãªã€‚ç­‹åŠ›ã¨é¢¨ã®è¨ˆç®—ã¯ï¼Ÿã€','ã‚¨ãƒ¬ãƒŠã€Œè¨ˆç®—ï¼Ÿå‹˜ã‚ˆå‹˜ï¼ã€','ã‚¼ãƒãƒ³ã€Œ...å¤©æ‰ã‹é¦¬é¹¿ã‹åˆ¤æ–­ã«å›°ã‚‹ã€','ã‚¨ãƒ¬ãƒŠã€Œè¤’ã‚è¨€è‘‰ã¨ã—ã¦å—ã‘å–ã£ã¨ãï¼ã€']},
      {lines:['ã‚¨ãƒ¬ãƒŠã€Œã‚¼ãƒãƒ³ã£ã¦æ„å¤–ã¨å„ªã—ã„ã‚ˆã­ã€','ã‚¼ãƒãƒ³ã€Œ...æ ¹æ‹ ã¯ï¼Ÿã€','ã‚¨ãƒ¬ãƒŠã€Œã•ã£ãã€ã‚ãŸã—ãŒè»¢ã³ãã†ã«ãªã£ãŸæ™‚æ”¯ãˆã¦ãã‚ŒãŸã˜ã‚ƒã‚“ã€','ã‚¼ãƒãƒ³ã€Œ...åå°„ã ã€‚ãƒ‡ãƒ¼ã‚¿çš„ã«è»¢å€’ã¯éåŠ¹ç‡ã ã‹ã‚‰ãªã€']},
    ],
    // ã‚«ã‚¤ãƒˆ Ã— ãƒ«ã‚·ã‚¨ãƒ©ï¼ˆæ‹æ„›ãƒšã‚¢ï¼‰
    'thief_m:mage_f': [
      {lines:['ã‚«ã‚¤ãƒˆã€Œãƒ«ã‚·ã‚¨ãƒ©ã£ã¦è¦‹ã¦ã¦é£½ããªã„ã‚ˆãªã€','ãƒ«ã‚·ã‚¨ãƒ©ã€Œãˆï¼Ÿãªã«ãªã«ï¼Ÿã€','ã‚«ã‚¤ãƒˆã€Œã„ã‚„ã€æ¬¡ä½•ã‚„ã‚‰ã‹ã™ã‹äºˆæ¸¬ã§ããªãã¦ã€','ãƒ«ã‚·ã‚¨ãƒ©ã€Œã‚„ã‚‰ã‹ã™ã£ã¦ä½•ï¼ï¼Ÿã€']},
      {lines:['ãƒ«ã‚·ã‚¨ãƒ©ã€Œã‚«ã‚¤ãƒˆã€ã“ã®å®çŸ³ãã‚Œã„ã ã­ã€œã€','ã‚«ã‚¤ãƒˆã€ŒãŠã€è¦‹ã‚‹ç›®ã‚ã‚‹ã˜ã‚ƒã‚“ã€‚ã“ã‚Œçµæ§‹ãªå€¤æ‰“ã¡ã ãœã€','ãƒ«ã‚·ã‚¨ãƒ©ã€Œã‚ãŸã—æŒã£ã¦ã¦ã„ã„ï¼Ÿã€','ã‚«ã‚¤ãƒˆã€Œ...ã¾ã‚ã€ã„ã„ã‘ã©ã‚ˆã€']},
      {lines:['ã‚«ã‚¤ãƒˆã€ŒãŠå‰ã•ã€ã‚‚ã†ã¡ã‚‡ã„å‘¨ã‚Šè¦‹ã¦é­”æ³•æ’ƒã¦ã‚ˆã€‚å·»ãè¾¼ã¾ã‚Œã‚‹ã ã‚ã€','ãƒ«ã‚·ã‚¨ãƒ©ã€Œã”ã‚ã‚“ã­ã€œã€‚ã§ã‚‚ã‚«ã‚¤ãƒˆãªã‚‰é¿ã‘ã‚‰ã‚Œã‚‹ã§ã—ã‚‡ï¼Ÿã€','ã‚«ã‚¤ãƒˆã€Œä¿¡é ¼ã•ã‚Œã¦ã‚“ã®ã‹é›‘ã«æ‰±ã‚ã‚Œã¦ã‚“ã®ã‹...ã€']},
    ],
    // ãƒ­ã‚¤ãƒ‰ Ã— ãƒªãƒªã‚¢ãƒ¼ãƒï¼ˆæ‹æ„›ãƒšã‚¢ï¼‰
    'archer_m:priest_f': [
      {lines:['ãƒªãƒªã‚¢ãƒ¼ãƒã€Œãƒ­ã‚¤ãƒ‰ã€ã•ã£ãã®å°„æ’ƒã™ã”ã‹ã£ãŸã‚ã‚ˆã€','ãƒ­ã‚¤ãƒ‰ã€Œãˆ...æœ¬å½“ã§ã™ã‹ï¼ŸãŸã¾ãŸã¾ã§ã™...ã€','ãƒªãƒªã‚¢ãƒ¼ãƒã€Œã‚‚ã†ã€ç´ ç›´ã«å–œã³ãªã•ã„ã€','ãƒ­ã‚¤ãƒ‰ã€Œã¯ã€ã¯ã„...ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€']},
      {lines:['ãƒ­ã‚¤ãƒ‰ã€Œãƒªãƒªã‚¢ãƒ¼ãƒã•ã‚“ã€ã„ã¤ã‚‚æ°—ã«ã‹ã‘ã¦ãã‚Œã¦...ã€','ãƒªãƒªã‚¢ãƒ¼ãƒã€Œå½“ç„¶ã‚ˆã€‚ã‚ãªãŸã¯ç§ã®å¤§äº‹ãªä»²é–“ãªã‚“ã ã‹ã‚‰ã€','ãƒ­ã‚¤ãƒ‰ã€Œï¼ˆå¤§äº‹...ï¼‰...ã¯ã€ã¯ã„ï¼ã€']},
      {lines:['ãƒªãƒªã‚¢ãƒ¼ãƒã€Œã»ã‚‰ã€è‚©å‡ã£ã¦ã‚‹ã§ã—ã‚‡ï¼Ÿå¼“ä½¿ã„ã¯è‚©ãŒå‘½ã‚ˆã€','ãƒ­ã‚¤ãƒ‰ã€Œãˆã€ã‚ã€å¤§ä¸ˆå¤«ã§...ã„ãŸãŸãŸï¼ã€','ãƒªãƒªã‚¢ãƒ¼ãƒã€Œã»ã‚‰ã­ã€‚ã˜ã£ã¨ã—ã¦ã€']},
    ],
    // ã‚»ãƒ‰ãƒªãƒƒã‚¯ Ã— ã‚·ãƒ£ãƒ¼ãƒªã‚£ï¼ˆæ‹æ„›ãƒšã‚¢ï¼‰
    'priest_m:thief_f': [
      {lines:['ã‚»ãƒ‰ãƒªãƒƒã‚¯ã€Œã‚·ãƒ£ãƒ¼ãƒªã‚£æ®¿ã¯å¯¡é»™ã§ã™ã­ã€‚å«Œã„ã˜ã‚ƒãªã„ã§ã™ã‚ˆã€','ã‚·ãƒ£ãƒ¼ãƒªã‚£ã€Œ...ãã†ã€','ã‚»ãƒ‰ãƒªãƒƒã‚¯ã€Œã“ã†ã„ã†åå¿œã‚‚å«ã‚ã¦ã­ã€']},
      {lines:['ã‚·ãƒ£ãƒ¼ãƒªã‚£ã€Œ...ã‚ã‚“ãŸã€åƒ§ä¾¶ã®ãã›ã«æ¯’èˆŒã€','ã‚»ãƒ‰ãƒªãƒƒã‚¯ã€ŒãŠã‚„ã€çã—ãè©±ã—ã‹ã‘ã¦ãã‚Œã¾ã—ãŸã­ã€','ã‚·ãƒ£ãƒ¼ãƒªã‚£ã€Œ...å¾Œæ‚”ã—ãŸã€','ã‚»ãƒ‰ãƒªãƒƒã‚¯ã€Œã²ã©ã„ã€']},
      {lines:['ã‚»ãƒ‰ãƒªãƒƒã‚¯ã€Œæ€ªæˆ‘ã—ã¦ã„ã¾ã™ã­ã€‚è¦‹ã›ã¦ãã ã•ã„ã€','ã‚·ãƒ£ãƒ¼ãƒªã‚£ã€Œ...å¹³æ°—ã€','ã‚»ãƒ‰ãƒªãƒƒã‚¯ã€Œå¹³æ°—ãªé¡”ã—ã¦è¡€ãŒå‡ºã¦ã¾ã™ã‚ˆã€‚ã¯ã„ã€æ‰‹ã€','ã‚·ãƒ£ãƒ¼ãƒªã‚£ã€Œ............ã©ã†ã‚‚ã€']},
    ],
    // ã‚¢ãƒ‡ãƒ©ã‚¤ãƒ³ Ã— ã‚¨ãƒ«ãƒãƒ¼
    'knight_f:healer_m': [
      {lines:['ã‚¢ãƒ‡ãƒ©ã‚¤ãƒ³ã€Œã‚¨ãƒ«ãƒãƒ¼ã€ã‚ãŸãã—ã®é§ã«å‚·ãŒ...ç›´ã›ã¾ã™ã‹ï¼Ÿã€','ã‚¨ãƒ«ãƒãƒ¼ã€Œå‚·ã¯æ²»ã›ã‚‹ãŒé§ã¯å°‚é–€å¤–ã ãª...ã€','ã‚¢ãƒ‡ãƒ©ã‚¤ãƒ³ã€Œã¾ã‚...å†—è«‡ã§ã™ã‚ã€‚ãµãµã€']},
      {lines:['ã‚¨ãƒ«ãƒãƒ¼ã€Œã‚¢ãƒ‡ãƒ©ã‚¤ãƒ³ã€ç„¡èŒ¶ãªçªæ’ƒã¯ã‚„ã‚ã¦ãã‚Œã€‚å¿ƒè‡“ã«æ‚ªã„ã€','ã‚¢ãƒ‡ãƒ©ã‚¤ãƒ³ã€Œã‚ã‚‰ã€å¿ƒé…ã—ã¦ãã ã•ã‚‹ã®ï¼Ÿå¬‰ã—ã„ã§ã™ã‚ã€','ã‚¨ãƒ«ãƒãƒ¼ã€Œå…¨å“¡ã«è¨€ã£ã¦ã‚‹ã‚“ã ãŒ...ã€']},
    ],
    // ã‚¬ãƒ¬ã‚¹ Ã— ã‚¢ãƒ‡ãƒ©ã‚¤ãƒ³ï¼ˆåŒè·ï¼‰
    'knight_m:knight_f': [
      {lines:['ã‚¢ãƒ‡ãƒ©ã‚¤ãƒ³ã€Œã‚ãŸãã—ã®æ–¹ãŒä¸Šæ‰‹ãã‚„ã‚Œã¾ã™ã‚ã€','ã‚¬ãƒ¬ã‚¹ã€Œã»ã†ã€ã‚„ã£ã¦ã¿ã‚‹ãŒã„ã„ã€','ã‚¢ãƒ‡ãƒ©ã‚¤ãƒ³ã€Œæœ›ã‚€ã¨ã“ã‚ã§ã™ã‚ï¼ã€']},
      {lines:['ã‚¬ãƒ¬ã‚¹ã€Œã‚¢ãƒ‡ãƒ©ã‚¤ãƒ³ã€ãƒ•ã‚©ãƒ¼ãƒ ãŒç”˜ã„ã€','ã‚¢ãƒ‡ãƒ©ã‚¤ãƒ³ã€Œã‚ãªãŸã«è¨€ã‚ã‚ŒãŸãã‚ã‚Šã¾ã›ã‚“ã‚ã€‚åŠ›ä»»ã›ã®å‰£æŠ€ã®ãã›ã«ã€','ã‚¬ãƒ¬ã‚¹ã€Œ...ãã£ã€']},
      {lines:['ã‚¢ãƒ‡ãƒ©ã‚¤ãƒ³ã€ŒåŒã˜é¨å£«ã¨ã—ã¦ã€è² ã‘ãŸãã‚ã‚Šã¾ã›ã‚“ã®ã€','ã‚¬ãƒ¬ã‚¹ã€Œ...ä¿ºã‚‚ã ã€‚åˆ‡ç£‹ç¢ç£¨ã—ã‚ˆã†ã€','ã‚¢ãƒ‡ãƒ©ã‚¤ãƒ³ã€Œã¾ã‚...æ„å¤–ã¨ç´ ç›´ã§ã™ã®ã­ã€']},
    ],
  },

  // === æ‹æ„›æ®µéšåˆ¥æ›ã‘åˆã„ ===
  loveStage: {
    1: [ // æ°—ã«ãªã‚Šå§‹ã‚
      {lines:['{a}ã€Œ...ã•ã£ãã®æˆ¦é—˜ã€å¤§ä¸ˆå¤«ã ã£ãŸï¼Ÿã€','{b}ã€Œãˆï¼Ÿã†ã‚“...ã‚ã‚ŠãŒã¨ã†ã€æ°—ã«ã‹ã‘ã¦ãã‚Œã¦ã€']},
      {lines:['{a}ã€Œï¼ˆ...ãªã‚“ã‹æ°—ã«ãªã‚‹ãªã€ã‚ã„ã¤ã®ã“ã¨ï¼‰ã€','{b}ã€Œã©ã†ã—ãŸã®ï¼Ÿã¼ãƒ¼ã£ã¨ã—ã¦ã€','{a}ã€Œãªã€ãªã‚“ã§ã‚‚ãªã„ï¼ã€']},
      {lines:['{a}ã€Œã¯ã„ã€æ°´ã€‚å–‰ä¹¾ã„ãŸã§ã—ã‚‡ã€','{b}ã€Œ...ã‚ã‚ŠãŒã¨ã†ã€‚å„ªã—ã„ã­ã€','{a}ã€Œã¹ã€åˆ¥ã«æ™®é€šã ã‚ã€']},
    ],
    2: [ // æ„è­˜ã—ã¦ã„ã‚‹
      {lines:['{a}ã€Œãªã‚“ã‹æœ€è¿‘ã€{b}ã®ã“ã¨ç›®ã§è¿½ã£ã¡ã‚ƒã†ã‚“ã ã‚ˆãª...ã€','ä»–ãƒ¡ãƒ³ãƒãƒ¼ã€ŒçŸ¥ã£ã¦ã‚‹ã€','{a}ã€Œãˆ!?ã€']},
      {lines:['{a}ã€Œ{b}ã®éš£ã€ã„ã„ï¼Ÿã€','{b}ã€Œã‚‚ã¡ã‚ã‚“ã€‚...æœ€è¿‘ã„ã¤ã‚‚éš£ã ã­ã€','{a}ã€Œ...ãã†ã‹ãªã€']},
      {lines:['{b}ã€Œã‚ã®...{a}ã£ã¦ã€å¥½ããªäººã¨ã‹ã„ã‚‹ã®ï¼Ÿã€','{a}ã€Œãˆ...ï¼Ÿã„ããªã‚Šä½•...ã€','{b}ã€Œãªã€ãªã‚“ã§ã‚‚ãªã„ï¼å¿˜ã‚Œã¦ï¼ã€']},
    ],
    3: [ // æ‹ã«è½ã¡ãŸ
      {lines:['{a}ã€Œ{b}...å¥½ãã ã€','{b}ã€Œ...ã†ã‚“ã€‚çŸ¥ã£ã¦ãŸã€','ä»–ãƒ¡ãƒ³ãƒãƒ¼ã€ŒãŠå‰ã‚‰...ã„ã¡ã‚ƒã¤ããªã€']},
      {lines:['{a}ã€Œ{b}ã‚’å®ˆã‚‹ãŸã‚ãªã‚‰ä½•ã§ã‚‚ã™ã‚‹ã€','{b}ã€Œãƒã‚«...ä¸€ç·’ã«ç”Ÿãæ®‹ã‚‹ã®ã€','ä»–ãƒ¡ãƒ³ãƒãƒ¼ã€Œèã„ã¦ã‚‹ã“ã£ã¡ãŒæ¥ãšã‹ã—ã„ã‚“ã ã‘ã©ã€']},
    ],
  },

  // === åŒè·ãƒ©ã‚¤ãƒãƒ«æ›ã‘åˆã„ ===
  rivalry: {
    knight: [
      {lines:['{a}ã€Œé¨å£«ã®èª‡ã‚Šã«ã‹ã‘ã¦ã€ãŠå‰ã«ã¯è² ã‘ã‚“ã€','{b}ã€Œæœ›ã‚€ã¨ã“ã‚ã§ã™ã‚ã€‚ã“ã®å‰£ã«ã‹ã‘ã¦ã€']},
      {lines:['{a}ã€Œå‰è¡›ã¯ä¿ºãŒå®ˆã‚‹ã€','{b}ã€Œã„ã„ãˆã€ã‚ãŸãã—ãŒã€','{a}ã€Œ...äºŒäººã§å®ˆã‚Œã°ã„ã„ã ã‚ã†ã€','{b}ã€Œ...ãã‚Œã‚‚ãã†ã§ã™ã‚ã­ã€']},
    ],
    mage: [
      {lines:['{a}ã€Œé­”åŠ›åˆ¶å¾¡ã®ç²¾åº¦ã§ã¯è² ã‘ã‚“ãã€','{b}ã€Œãˆãƒ¼ã€ã§ã‚‚ã‚ãŸã—ã®æ–¹ãŒå¨åŠ›ã‚ã‚‹ã‚ˆï¼Ÿã€','{a}ã€Œå¨åŠ›ã ã‘ãŒé­”æ³•ã§ã¯ãªã„ã€']},
      {lines:['{a}ã€Œãƒ«ã‚·ã‚¨ãƒ©ã€è© å”±ã‚’ã¡ã‚ƒã‚“ã¨è¦šãˆã‚ã€','{b}ã€Œè¦šãˆã¦ã‚‹ã‚ˆï¼ãˆãƒ¼ã£ã¨...ã‚ã‚Œï¼Ÿã€','{a}ã€Œã»ã‚‰è¦‹ã‚ã€']},
    ],
    healer: [
      {lines:['{a}ã€Œå›å¾©é€Ÿåº¦ãªã‚‰ä¿ºã®æ–¹ãŒä¸Šã ã€','{b}ã€Œã§ã‚‚è–¬è‰ã®èª¿åˆã¯ã‚ãŸã—ã®æ–¹ãŒ...ã€','{a}ã€Œ...èªã‚ã‚‹ã€‚æ•™ãˆã¦ãã‚Œã€']},
      {lines:['{a}ã€Œãƒ•ã‚£ã‚ªãƒŠã€å°‘ã—ä¼‘ã‚ã€‚å›å¾©ã¯ä¿ºãŒã‚„ã‚‹ã€','{b}ã€Œã‚¨ãƒ«ãƒãƒ¼ã•ã‚“ã“ã...ãŠäº’ã„é ‘å›ºã§ã™ã­ã€']},
    ],
    thief: [
      {lines:['{a}ã€Œéµé–‹ã‘ã€ä¿ºã®æ–¹ãŒé€Ÿã„ãœã€','{b}ã€Œ...3ç§’ã€','{a}ã€Œã¯ï¼Ÿ3ç§’ã£ã¦...ãƒã‚¸ã‹ã‚ˆã€']},
      {lines:['{a}ã€Œã‚·ãƒ£ãƒ¼ãƒªã‚£ã€ãŸã¾ã«ã¯çµ„ã¾ã­ï¼Ÿé€£æºç›—è³Šã£ã¦ã‚„ã¤ã€','{b}ã€Œ...ä¸€äººã®æ–¹ãŒæ—©ã„ã€','{a}ã€Œãã•ã£ã€']},
    ],
    archer: [
      {lines:['{a}ã€Œã‚ã®çš„...ã„ã‚„ã€ã‚ã®æ•µã«å½“ã¦ã‚‰ã‚Œã‚‹ï¼Ÿã€','{b}ã€Œå½“ç„¶ï¼ã‚ãŸã—ã‚’èª°ã ã¨æ€ã£ã¦ã‚“ã®ï¼ã€','{a}ã€Œã˜ã‚ƒã‚åƒ•ã‚‚...å¤–ã•ãªã„ã€']},
      {lines:['{a}ã€Œã‚¨ãƒ¬ãƒŠã®é€Ÿå°„ã€ã™ã”ã„ã¨æ€ã†...ã€','{b}ã€Œãƒ­ã‚¤ãƒ‰ã®ç²¾å¯†ã•ã«ã¯ã‹ãªã‚ãªã„ã‚ã‚ˆã€‚ç´ ç›´ã«èªã‚ã‚‹ã€']},
    ],
    priest: [
      {lines:['{a}ã€Œç¥ˆã‚Šã®æ·±ã•ã§ã¯ç§ãŒä¸Šã§ã™ã‚ˆã€','{b}ã€Œã§ã‚‚ä¿¡è€…ã®æ•°ã§ã¯ç§ã®æ–¹ãŒå¤šã„ã‚ã‚ˆï¼Ÿã€','{a}ã€Œæ•°ã˜ã‚ƒãªã„ã‚“ã§ã™ã‘ã©ã­...ã€']},
      {lines:['{a}ã€Œãƒªãƒªã‚¢ãƒ¼ãƒæ®¿ã®ä¸–è©±ç„¼ãã€å¸ƒæ•™æ´»å‹•ã§ã™ã‹ï¼Ÿã€','{b}ã€Œã‚ãªãŸã®æ¯’èˆŒã“ãã€ä¿¡è€…æ¸›ã‚‰ã—ã¦ãªã„ï¼Ÿã€','{a}ã€Œ...ç—›ã„ã¨ã“ã‚ã‚’ã€']},
    ],
  },
};


// 12ã‚­ãƒ£ãƒ©ç”Ÿæˆ
const characters = [];
CLASSES.forEach(c => {
  GENDERS.forEach(g => {
    characters.push({
      uid: c.id+'_'+g.id,
      classId: c.id,
      className: c.name,
      icon: c.icon,
      gender: g.id,
      genderLabel: g.label,
      name: NAMES[c.id][g.id],
      baseHp: c.hp, atk: c.atk, def: c.def, spd: c.spd,
      desc: c.desc,
      personality: PERSONALITIES[c.id+'_'+g.id] || {},
    });
  });
});

// ===== éš ã—ç›¸æ€§ã‚·ã‚¹ãƒ†ãƒ  =====
// æ‹æ„›ãƒšã‚¢ï¼ˆç”·,å¥³ï¼‰â†’æ‹ã«è½ã¡ã‚„ã™ã„çµ„ã¿åˆã‚ã›
const LOVE_PAIRS = [
  ['knight_m','healer_f', 0.9],   // ã‚¬ãƒ¬ã‚¹Ã—ãƒ•ã‚£ã‚ªãƒŠï¼šè¶…é«˜ç¢ºç‡
  ['mage_m','archer_f', 0.8],     // ã‚¼ãƒãƒ³Ã—ã‚¨ãƒ¬ãƒŠ
  ['thief_m','mage_f', 0.75],     // ã‚«ã‚¤ãƒˆÃ—ãƒ«ã‚·ã‚¨ãƒ©
  ['archer_m','priest_f', 0.7],   // ãƒ­ã‚¤ãƒ‰Ã—ãƒªãƒªã‚¢ãƒ¼ãƒ
  ['priest_m','thief_f', 0.65],   // ã‚»ãƒ‰ãƒªãƒƒã‚¯Ã—ã‚·ãƒ£ãƒ¼ãƒªã‚£
  ['knight_m','mage_f', 0.5],     // ã‚¬ãƒ¬ã‚¹Ã—ãƒ«ã‚·ã‚¨ãƒ©ï¼ˆä½ã‚ï¼‰
];

// ã‚·ãƒŠã‚¸ãƒ¼ãƒœãƒ¼ãƒŠã‚¹
const SYNERGIES = [
  {members:['knight','healer'], name:'é‰„å£ã®å®ˆè­·', effect:'defUp', value:15, msg:'ã®é˜²å¾¡ãŒé€£æºã§å¼·åŒ–ã•ã‚ŒãŸï¼'},
  {members:['mage','priest'], name:'é­”åŠ›å¢—å¹…', effect:'atkUp', value:20, msg:'ã®é­”åŠ›ãŒå…±é³´ã—ã¦å¢—å¹…ã•ã‚ŒãŸï¼'},
  {members:['thief','archer'], name:'ç–¾é¢¨ã®é€£æ’ƒ', effect:'spdUp', value:10, msg:'ã®é€£æºæ”»æ’ƒãŒç‚¸è£‚ï¼'},
  {members:['knight','priest'], name:'è–ãªã‚‹ç›¾', effect:'defUp', value:10, msg:'ã«è–ãªã‚‹åŠ è­·ãŒå®¿ã£ãŸï¼'},
  {members:['healer','priest'], name:'ç¥ç¦ã®äºŒé‡å¥', effect:'healUp', value:1.5, msg:'ã®å›å¾©åŠ›ãŒå€å¢—ã—ãŸï¼'},
];

// ===== ãƒ†ã‚­ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ =====
function pick(arr) { return arr[Math.floor(Math.random()*arr.length)]; }

const TEXTS = {
  // === æ•µå‡ºç¾ ===
  monsterAppear: {
    'ã‚´ãƒ–ãƒªãƒ³ã®ç¾¤ã‚Œ': [
      'è–„æš—ã„é€šè·¯ã‹ã‚‰ã‚´ãƒ–ãƒªãƒ³ã®ç¾¤ã‚ŒãŒé£›ã³å‡ºã—ã¦ããŸï¼',
      'ã‚²ãƒ©ã‚²ãƒ©ã¨ä¸‹å“ãªç¬‘ã„å£°ãŒéŸ¿ãã€‚ã‚´ãƒ–ãƒªãƒ³ã®ç¾¤ã‚Œã ï¼',
      'è¶³å…ƒã®ã‚´ãƒŸã‚’æ¼ã£ã¦ã„ãŸã‚´ãƒ–ãƒªãƒ³ãŸã¡ãŒã“ã¡ã‚‰ã«æ°—ã¥ã„ãŸï¼',
      'ã„ãŸã‚‹ã¨ã“ã‚ã‹ã‚‰ã‚´ãƒ–ãƒªãƒ³ãŒæ¹§ã„ã¦å‡ºãŸï¼å›²ã¾ã‚Œã¦ã„ã‚‹ï¼',
      'ã€Œã‚®ã‚®ã‚®ãƒƒï¼ã€ã‚´ãƒ–ãƒªãƒ³ã®ç¾¤ã‚ŒãŒæ­¦å™¨ã‚’æ§‹ãˆã¦ç¾ã‚ŒãŸï¼',
      'è…ã£ãŸé£Ÿã¹ç‰©ã®è‡­ã„ã¨ã¨ã‚‚ã«ã‚´ãƒ–ãƒªãƒ³ã®ç¾¤ã‚ŒãŒç¾ã‚ŒãŸï¼',
    ],
    'ã‚¹ã‚±ãƒ«ãƒˆãƒ³æˆ¦å£«': [
      'éª¨ã®è»‹ã‚€éŸ³ã¨ã¨ã‚‚ã«ã‚¹ã‚±ãƒ«ãƒˆãƒ³æˆ¦å£«ãŒç«‹ã¡ä¸ŠãŒã£ãŸï¼',
      'å£ã«å¯„ã‚Šã‹ã‹ã£ã¦ã„ãŸéª¸éª¨ãŒçªç„¶å‹•ãå‡ºã—ãŸï¼',
      'å¤ã³ãŸé§ã‚’ã¾ã¨ã£ãŸã‚¹ã‚±ãƒ«ãƒˆãƒ³æˆ¦å£«ãŒå‰£ã‚’æŠœã„ãŸï¼',
      'åœ°é¢ã®éª¨ãŒé›†ã¾ã‚Šã€ã‚¹ã‚±ãƒ«ãƒˆãƒ³æˆ¦å£«ãŒå½¢ã‚’æˆã—ãŸï¼',
      'ã€Œã‚«ã‚¿ã‚«ã‚¿ã‚«ã‚¿...ã€ä¸æ°—å‘³ãªéŸ³ã‚’ç«‹ã¦ã¦ã‚¹ã‚±ãƒ«ãƒˆãƒ³æˆ¦å£«ãŒè¿‘ã¥ã„ã¦ãã‚‹ï¼',
      'ã‹ã¤ã¦ã®å†’é™ºè€…ã ã£ãŸã®ã‹ã€ã‚¹ã‚±ãƒ«ãƒˆãƒ³æˆ¦å£«ãŒè¡Œãæ‰‹ã‚’é˜»ã‚€ï¼',
    ],
    'ã‚ªãƒ¼ã‚¯': [
      'å·¨å¤§ãªã‚ªãƒ¼ã‚¯ãŒé›„å«ã³ã‚’ä¸Šã’ã¦çªé€²ã—ã¦ããŸï¼',
      'ãƒ‰ã‚¹ãƒ³ãƒ‰ã‚¹ãƒ³ã¨åœ°éŸ¿ããŒï¼ã‚ªãƒ¼ã‚¯ã ï¼',
      'ã€Œã‚°ã‚ªã‚ªã‚©ã‚©ï¼ã€ç­‹éª¨éš†ã€…ã®ã‚ªãƒ¼ã‚¯ãŒæ£æ£’ã‚’æŒ¯ã‚Šå›ã—ã¦ã„ã‚‹ï¼',
      'é£Ÿäº‹ä¸­ã ã£ãŸã‚ªãƒ¼ã‚¯ãŒã“ã¡ã‚‰ã«æ°—ã¥ãã€æ€’ã‚Šã®å½¢ç›¸ã§ç«‹ã¡ä¸ŠãŒã£ãŸï¼',
      'å£ã®é™°ã‹ã‚‰å·¨ä½“ã®ã‚ªãƒ¼ã‚¯ãŒã¬ã£ã¨ç¾ã‚ŒãŸï¼',
      'ã‚ªãƒ¼ã‚¯ãŒé¼»ã‚’ã²ãã²ãã•ã›ãªãŒã‚‰è¿‘ã¥ã„ã¦ãã‚‹ã€‚ç²ç‰©ã‚’è¦‹ã¤ã‘ãŸã‚ˆã†ã ï¼',
    ],
    'ãƒ€ãƒ¼ã‚¯ã‚¨ãƒ«ãƒ•': [
      'é—‡ã®ä¸­ã‹ã‚‰å¦–ã—ãå…‰ã‚‹ç³ã€‚ãƒ€ãƒ¼ã‚¯ã‚¨ãƒ«ãƒ•ã ï¼',
      'å£ã¨ä¸€ä½“åŒ–ã—ã¦ã„ãŸãƒ€ãƒ¼ã‚¯ã‚¨ãƒ«ãƒ•ãŒå§¿ã‚’ç¾ã—ãŸï¼',
      'å˜²ç¬‘ã†ã‚ˆã†ã«ãƒ€ãƒ¼ã‚¯ã‚¨ãƒ«ãƒ•ãŒçŸ­å‰£ã‚’æ§‹ãˆã¦ã„ã‚‹ï¼',
      'ã€Œæ„šã‹ãªåœ°ä¸Šã®è€…ã‚...ã€ãƒ€ãƒ¼ã‚¯ã‚¨ãƒ«ãƒ•ãŒå†·ãŸãç¬‘ã£ãŸï¼',
      'å¤©äº•ã‹ã‚‰éŸ³ã‚‚ãªããƒ€ãƒ¼ã‚¯ã‚¨ãƒ«ãƒ•ãŒé™ã‚Šç«‹ã£ãŸï¼',
      'é­”æ³•ã®æ°—é…ã¨ã¨ã‚‚ã«ãƒ€ãƒ¼ã‚¯ã‚¨ãƒ«ãƒ•ãŒé—‡ã‹ã‚‰æµ®ã‹ã³ä¸ŠãŒã£ãŸï¼',
    ],
    'ãƒŸãƒã‚¿ã‚¦ãƒ­ã‚¹': [
      'å·¨å¤§ãªãƒŸãƒã‚¿ã‚¦ãƒ­ã‚¹ãŒé€šè·¯ã‚’å¡ã„ã§ã„ã‚‹ï¼',
      'è¹„ã®éŸ³ãŒè¿‘ã¥ã„ã¦ãã‚‹...ãƒŸãƒã‚¿ã‚¦ãƒ­ã‚¹ã ï¼é€ƒã’å ´ã¯ãªã„ï¼',
      'ã€Œãƒ–ãƒ¢ã‚ªã‚ªã‚ªï¼ã€ãƒŸãƒã‚¿ã‚¦ãƒ­ã‚¹ã®å’†å“®ãŒæ´çªŸã«éŸ¿ãæ¸¡ã£ãŸï¼',
      'è¡€ã¾ã¿ã‚Œã®å¤§æ–§ã‚’æŒã£ãŸãƒŸãƒã‚¿ã‚¦ãƒ­ã‚¹ãŒå¾…ã¡æ§‹ãˆã¦ã„ãŸï¼',
      'è§’ã‚’å…‰ã‚‰ã›ãŸãƒŸãƒã‚¿ã‚¦ãƒ­ã‚¹ãŒã“ã¡ã‚‰ã‚’ç¨ã¿ã¤ã‘ã¦ã„ã‚‹ï¼',
    ],
    'ãƒ¯ã‚¤ãƒãƒ¼ãƒ³': [
      'ç¿¼ã‚’åºƒã’ãŸãƒ¯ã‚¤ãƒãƒ¼ãƒ³ãŒä¸Šç©ºã‹ã‚‰æ€¥é™ä¸‹ã—ã¦ããŸï¼',
      'ã€Œã‚®ãƒ£ã‚¢ã‚¢ã‚¢ï¼ã€ãƒ¯ã‚¤ãƒãƒ¼ãƒ³ã®ç”²é«˜ã„å«ã³ãŒé¼“è†œã‚’çªãï¼',
      'å¤©äº•ã®å¤§ç©´ã‹ã‚‰ãƒ¯ã‚¤ãƒãƒ¼ãƒ³ãŒé£›æ¥ã—ãŸï¼',
      'æ¯’ã®æ»´ã‚‹å°¾ã‚’æŒ¯ã‚Šå›ã™ãƒ¯ã‚¤ãƒãƒ¼ãƒ³ãŒè¡Œãæ‰‹ã‚’é®ã‚‹ï¼',
      'å·£ã‚’è’ã‚‰ã•ã‚ŒãŸã¨æ€ã£ãŸã®ã‹ã€ãƒ¯ã‚¤ãƒãƒ¼ãƒ³ãŒæ€’ã‚Šã«ç‡ƒãˆã¦ã„ã‚‹ï¼',
    ],
    'ãƒªãƒƒãƒ': [
      'ç©ºæ°—ãŒå‡ã‚Šã¤ãã€‚ãƒªãƒƒãƒã®ç¦ã€…ã—ã„ã‚ªãƒ¼ãƒ©ãŒå……æº€ã—ã¦ã„ã‚‹ï¼',
      'ã€Œç”Ÿè€…ã‚ˆ...æ°¸é ã®çœ ã‚Šã‚’æˆã‘ã‚ˆã†ã€ãƒªãƒƒãƒãŒæ–ã‚’æ²ã’ãŸï¼',
      'æœ½ã¡ãŸç‹å† ã‚’è¢«ã£ãŸãƒªãƒƒãƒãŒè™šã‚ãªç›®ã§ã“ã¡ã‚‰ã‚’è¦‹ã¦ã„ã‚‹ï¼',
      'é­”åŠ›ã®å¥”æµã¨ã¨ã‚‚ã«ãƒªãƒƒãƒãŒç©ºé–“ã‚’æ­ªã‚ã¦ç¾ã‚ŒãŸï¼',
      'æ­»ã®æ°—é…ãŒæ¿ƒããªã‚‹...ãƒªãƒƒãƒã ï¼ç”Ÿå‘½åŠ›ãŒå¸ã„å–ã‚‰ã‚Œãã†ã ï¼',
    ],
    'ãƒ‰ãƒ©ã‚´ãƒ³': [
      'ã€Œã‚°ã‚ªã‚ªã‚ªã‚ªï¼ã€æ´çªŸå…¨ä½“ãŒæºã‚Œã‚‹ã€‚ãƒ‰ãƒ©ã‚´ãƒ³ã ï¼ï¼',
      'ç¼ç†±ã®æ¯å¹ãŒé€šè·¯ã‚’ç„¦ãŒã™ã€‚ãƒ‰ãƒ©ã‚´ãƒ³ãŒç¾ã‚ŒãŸï¼',
      'ä¼èª¬ã®å¤ç«œãŒé»„é‡‘ã®ç³ã§ã“ã¡ã‚‰ã‚’è¦‹æ®ãˆã¦ã„ã‚‹ï¼',
      'åœ§å€’çš„ãªå­˜åœ¨æ„Ÿã€‚ãƒ‰ãƒ©ã‚´ãƒ³ãŒç¿¼ã‚’åºƒã’ã¦å¨åš‡ã—ã¦ã„ã‚‹ï¼',
      'å…¨èº«ã‚’è¦†ã†é‹¼ã®ã‚ˆã†ãªé±—ã€‚ãƒ‰ãƒ©ã‚´ãƒ³ã¨ã®æ­»é—˜ãŒå§‹ã¾ã‚‹ï¼',
    ],
    'ãƒ‡ãƒ¼ãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ‰': [
      'åœ°ç„ã®è£‚ã‘ç›®ã‹ã‚‰ãƒ‡ãƒ¼ãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ‰ãŒé™è‡¨ã—ãŸï¼',
      'ã€Œãƒãƒãƒãƒ...é¢ç™½ã„ç©å…·ãŒæ¥ãŸã‚‚ã®ã ã€ãƒ‡ãƒ¼ãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ‰ãŒå—¤ã†ï¼',
      'ç¦ã€…ã—ã„ã‚ªãƒ¼ãƒ©ã«å…¨èº«ãŒéœ‡ãˆã‚‹ã€‚ãƒ‡ãƒ¼ãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ‰ã ï¼',
      'é—‡ã®ç‚ã‚’çºã£ãŸãƒ‡ãƒ¼ãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ‰ãŒç‰åº§ã‹ã‚‰ç«‹ã¡ä¸ŠãŒã£ãŸï¼',
      'ç©ºé–“ãŒæ­ªã¿ã€ç•°ç•Œã‹ã‚‰ãƒ‡ãƒ¼ãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ‰ãŒå¬å–šã•ã‚ŒãŸï¼',
    ],
    'æ·±æ·µã®ä½¿å¾’': [
      'å­˜åœ¨ãã®ã‚‚ã®ãŒæ­ªã‚“ã§ã„ã‚‹...æ·±æ·µã®ä½¿å¾’ã ï¼æ­£æ°—ã‚’ä¿ã¦ï¼',
      'ã€Œæˆ‘ã¯è™šç„¡ãªã‚Šã€æ·±æ·µã®ä½¿å¾’ã®å£°ãŒç›´æ¥é ­ã«éŸ¿ãï¼',
      'ç¾å®ŸãŒå´©å£Šã—ã¦ã„ãæ„Ÿè¦š...æ·±æ·µã®ä½¿å¾’ãŒé¡•ç¾ã—ãŸï¼',
      'è¦‹ã¦ã¯ã„ã‘ãªã„ã‚‚ã®ã‚’è¦‹ã¦ã—ã¾ã£ãŸã€‚æ·±æ·µã®ä½¿å¾’ãŒãã“ã«ã„ã‚‹ï¼',
      'ä¸–ç•Œã®è£å´ã‹ã‚‰é€™ã„å‡ºã‚‹ã‚ˆã†ã«ã€æ·±æ·µã®ä½¿å¾’ãŒå§¿ã‚’ç¾ã—ãŸï¼',
    ],
    _default: [
      'å‰æ–¹ã«æ•µã®æ°—é…ï¼{name}ãŒç¾ã‚ŒãŸï¼',
      '{name}ã ï¼æ­¦å™¨ã‚’æ§‹ãˆã‚ï¼',
      '{name}ãŒè¡Œãæ‰‹ã‚’é˜»ã‚“ã§ã„ã‚‹ï¼',
      'é€šè·¯ã®å…ˆã«{name}ã®å§¿ãŒï¼æˆ¦é—˜é–‹å§‹ï¼',
      'ä¸æ„æ‰“ã¡ã ï¼{name}ãŒè¥²ã„ã‹ã‹ã£ã¦ããŸï¼',
    ],
  },

  // === æ”»æ’ƒãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆè·æ¥­åˆ¥ï¼‰ ===
  attack: {
    knight: [
      '{name}ãŒå¤§å‰£ã‚’åŠ›å¼·ãæŒ¯ã‚Šä¸‹ã‚ã—ãŸï¼',
      '{name}ãŒç›¾ã§æŠ¼ã—è¾¼ã¿ã€è¿”ã™åˆ€ã§æ–¬ã‚Šã¤ã‘ãŸï¼',
      '{name}ãŒæ¸¾èº«ã®çªãã‚’æ”¾ã£ãŸï¼',
      '{name}ãŒé§ã”ã¨ä½“å½“ãŸã‚Šã§å¹ãé£›ã°ã—ãŸï¼',
      '{name}ãŒéš™ã‚’è¦‹ã¦å…œå‰²ã‚Šã‚’å©ãè¾¼ã‚“ã ï¼',
      '{name}ãŒç›¾ã§å—ã‘æ­¢ã‚ã¦ã‹ã‚‰ã®ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ï¼',
      '{name}ãŒé›„å«ã³ã¨ã¨ã‚‚ã«é€£ç¶šæ–¬ã‚Šã‚’æµ´ã³ã›ãŸï¼',
      '{name}ãŒå‰£ã‚’å›è»¢ã•ã›ã€è–™ãæ‰•ã£ãŸï¼',
    ],
    mage: [
      '{name}ãŒç‚ã®é­”æ³•ã‚’æ”¾ã£ãŸï¼è½ŸéŸ³ã¨ã¨ã‚‚ã«çˆ†ç™ºï¼',
      '{name}ãŒæ°·ã®æ§ã‚’ç”Ÿæˆã—ã¦æ’ƒã¡å‡ºã—ãŸï¼',
      '{name}ãŒé›·æ’ƒã‚’å‘¼ã³å¯„ã›ãŸï¼ç¨²å¦»ãŒèµ°ã‚‹ï¼',
      '{name}ãŒé—‡ã®å¥”æµã‚’è§£ãæ”¾ã£ãŸï¼',
      '{name}ãŒé­”åŠ›ã‚’å‡ç¸®ã—ãŸå…‰å¼¾ã‚’é€£å°„ã—ãŸï¼',
      '{name}ãŒæŒ‡å…ˆã‹ã‚‰ç¼ç†±ã®ç«ç·šã‚’æ”¾ã£ãŸï¼',
      '{name}ãŒé‡åŠ›é­”æ³•ã§æ•µã‚’åœ°é¢ã«å©ãã¤ã‘ãŸï¼',
      '{name}ãŒç©ºé–“ã‚’åˆ‡ã‚Šè£‚ãé­”æ³•ã‚’å”±ãˆãŸï¼',
    ],
    healer: [
      '{name}ãŒè–ãªã‚‹å…‰ã§æ”»æ’ƒã—ãŸï¼',
      '{name}ãŒæµ„åŒ–ã®å…‰ã‚’æ”¾ã£ãŸï¼é—‡ã®å­˜åœ¨ã«åŠ¹æœæŠœç¾¤ï¼',
      '{name}ãŒè–æ–ã§æ€ã„åˆ‡ã‚Šæ®´ã£ãŸï¼æ„å¤–ã¨ç—›ã„ï¼',
      '{name}ãŒç¥ˆã‚Šã®åŠ›ã‚’æ”»æ’ƒã«å¤‰ãˆã¦æ”¾ã£ãŸï¼',
      '{name}ãŒè–æ°´ã‚’æŠ•ã’ã¤ã‘ãŸï¼ã‚¸ãƒ¥ã‚¦ãƒƒã¨éŸ³ãŒã™ã‚‹ï¼',
      '{name}ãŒç™’ã—ã®åŠ›ã‚’é€†è»¢ã•ã›ã¦è‹¦ç—›ã®æ³¢å‹•ã‚’æ”¾ã£ãŸï¼',
    ],
    thief: [
      '{name}ãŒèƒŒå¾Œã«å›ã‚Šè¾¼ã¿æ€¥æ‰€ã‚’çªã„ãŸï¼',
      '{name}ãŒç´ æ—©ã„é€£æ’ƒã‚’å©ãè¾¼ã‚“ã ï¼',
      '{name}ãŒå½±ã‹ã‚‰é£›ã³å‡ºã—ã€ä¸€é–ƒï¼',
      '{name}ãŒæ¯’ã‚’å¡—ã£ãŸçŸ­å‰£ã§æ–¬ã‚Šã¤ã‘ãŸï¼',
      '{name}ãŒç›®ã«ã‚‚æ­¢ã¾ã‚‰ã¬é€Ÿã•ã§ä¸‰é€£æ’ƒï¼',
      '{name}ãŒæ•µã®è¶³å…ƒã‚’æ¬ã„ã€ã‚ˆã‚ã‚ã„ãŸéš™ã«ä¸€çªãï¼',
      '{name}ãŒç…™å¹•ã‚’æŠ•ã’ã¦ã‹ã‚‰ã®å¥‡è¥²æ”»æ’ƒï¼',
      '{name}ãŒäºŒåˆ€æµã§é«˜é€Ÿã®ä¹±èˆã‚’ç¹°ã‚Šå‡ºã—ãŸï¼',
    ],
    archer: [
      '{name}ãŒæ­£ç¢ºãªä¸€çŸ¢ã‚’æ”¾ã£ãŸï¼æ€¥æ‰€ã«å‘½ä¸­ï¼',
      '{name}ãŒçŸ¢ã®é›¨ã‚’é™ã‚‰ã›ãŸï¼é€ƒã’å ´ã¯ãªã„ï¼',
      '{name}ãŒé¢¨ã‚’èª­ã¿ã€å®Œç’§ãªä¸€å°„ã‚’æ”¾ã£ãŸï¼',
      '{name}ãŒç«çŸ¢ã‚’æ”¾ã£ãŸï¼æ•µãŒç‡ƒãˆä¸ŠãŒã‚‹ï¼',
      '{name}ãŒè·³å¼¾ã™ã‚‹é­”æ³•ã®çŸ¢ã‚’æ”¾ã£ãŸï¼',
      '{name}ãŒä¸‰æœ¬åŒæ™‚ã«çŸ¢ã‚’ã¤ãŒãˆã¦å°„ã£ãŸï¼',
      '{name}ãŒè‡³è¿‘è·é›¢ã‹ã‚‰çŸ¢ã‚’æ”¾ã£ãŸï¼è²«é€šã—ãŸï¼',
      '{name}ãŒå¼±ç‚¹ã‚’è¦‹æŠœãã€ç²¾å¯†å°„æ’ƒã‚’å©ãè¾¼ã‚“ã ï¼',
    ],
    priest: [
      '{name}ãŒè–ãªã‚‹è£ãã‚’ä¸‹ã—ãŸï¼å…‰ãŒæ•µã‚’åŒ…ã‚€ï¼',
      '{name}ãŒçµŒå…¸ã‚’å”±ãˆã€æµ„åŒ–ã®æ³¢å‹•ã‚’æ”¾ã£ãŸï¼',
      '{name}ãŒè–å°ã‚’åˆ»ã‚“ã éŒ«æ–ã§æ‰“ã¡æ®ãˆãŸï¼',
      '{name}ãŒå¤©ç½°ã®é›·ã‚’é™ã‚Šæ³¨ãŒã›ãŸï¼',
      '{name}ãŒé­”ã‚’ç¥“ã†çµç•Œã§æ•µã‚’ç· ã‚ä¸Šã’ãŸï¼',
      '{name}ãŒç¥ç¦ã‚’åè»¢ã•ã›ã€å‘ªã„ã®è¨€è‘‰ã‚’æ”¾ã£ãŸï¼',
    ],
  },

  // === å‹åˆ© ===
  victory: [
    'ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã®å‹åˆ©ï¼{name}ã‚’æ‰“ã¡å€’ã—ãŸï¼',
    '{name}ã¯å¡µã¨ãªã£ã¦æ¶ˆãˆãŸã€‚å‹åˆ©ã ï¼',
    'è¦‹äº‹ï¼{name}ã‚’æ’ƒç ´ã—ãŸï¼',
    '{name}ã‚’é€€ã‘ãŸï¼ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã®é€£æºãŒå…‰ã‚‹ï¼',
    '{name}ã¯æ–­æœ«é­”ã‚’ä¸Šã’ã¦å´©ã‚Œè½ã¡ãŸï¼',
    'æ¿€ã—ã„æˆ¦ã„ã®æœ«ã€{name}ã‚’è¨ä¼ã—ãŸï¼',
    '{name}ã¯åŠ›å°½ãã€é—‡ã«æº¶ã‘ã¦ã„ã£ãŸ...',
    'è¾›ãã‚‚å‹åˆ©ï¼{name}ã‚’å€’ã—ãŸï¼',
  ],

  // === æ•µã®åæ’ƒ ===
  counterattack: [
    '{name}ã®å‡¶æ‚ªãªåæ’ƒï¼',
    '{name}ãŒæ€’ã‚Šã«ä»»ã›ã¦æš´ã‚Œå›ã‚‹ï¼',
    '{name}ãŒéš™ã‚’çªã„ã¦è¥²ã„ã‹ã‹ã£ã¦ããŸï¼',
    '{name}ã®çŒ›æ”»ãŒæ­¢ã¾ã‚‰ãªã„ï¼',
    '{name}ãŒç‰™ã‚’å‰¥ã„ãŸï¼',
    'æ²¹æ–­ã™ã‚‹ãªï¼{name}ãŒã¾ã å‹•ã„ã¦ã„ã‚‹ï¼',
  ],

  // === è¢«ãƒ€ãƒ¡ãƒ¼ã‚¸ ===
  takeDamage: [
    '{name}ã«{dmg}ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼ç—›æ¨ã®ä¸€æ’ƒï¼',
    '{name}ãŒ{dmg}ã®ãƒ€ãƒ¡ãƒ¼ã‚¸ã‚’å—ã‘ãŸï¼',
    '{name}ã«{dmg}ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼æ­¯ã‚’é£Ÿã„ã—ã°ã£ã¦è€ãˆã‚‹ï¼',
    '{name}ãŒå¹ãé£›ã°ã•ã‚ŒãŸï¼{dmg}ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼',
    '{name}ã«{dmg}ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼é§ãŒè»‹ã‚€éŸ³ãŒã™ã‚‹ï¼',
    '{name}ãŒ{dmg}ã®ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼ã¾ã ç«‹ã£ã¦ã„ã‚‹ï¼',
    '{name}ã«ç›´æ’ƒï¼{dmg}ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼',
    '{name}ãŒè‹¦ç—›ã«é¡”ã‚’æ­ªã‚ãŸã€‚{dmg}ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼',
  ],

  // === æ•µé€ƒèµ° ===
  monsterFlee: [
    '{name}ã¯å½¢å‹¢ä¸åˆ©ã¨è¦‹ã¦é€ƒã’å»ã£ãŸ',
    '{name}ã¯é—‡ã®ä¸­ã«å§¿ã‚’æ¶ˆã—ãŸ...',
    '{name}ã¯é€™ã†é€™ã†ã®ä½“ã§é€ƒã’ã¦ã„ã£ãŸ',
    'å‚·ã ã‚‰ã‘ã®{name}ã¯æ’¤é€€ã—ã¦ã„ã£ãŸ',
    '{name}ã¯æ¨ã¦å°è©ã‚’åã„ã¦é€ƒèµ°ã—ãŸ',
  ],

  // === å›å¾© ===
  heal: [
    '{healer}ãŒ{target}ã«ç™’ã—ã®å…‰ã‚’æ³¨ã„ã ï¼{val}å›å¾©ï¼',
    '{healer}ã®æ¸©ã‹ãªé­”æ³•ãŒ{target}ã‚’åŒ…ã‚€ã€‚{val}å›å¾©ï¼',
    '{healer}ãŒ{target}ã®å‚·ã«æ‰‹ã‚’ã‹ã–ã—ãŸã€‚{val}å›å¾©ï¼',
    'ã€Œã¾ã å€’ã‚Œãªã„ã§ï¼ã€{healer}ãŒ{target}ã‚’{val}å›å¾©ã—ãŸï¼',
    '{healer}ã®ç¥ˆã‚ŠãŒ{target}ã«å±Šã„ãŸã€‚{val}å›å¾©ï¼',
    '{healer}ãŒå›å¾©é­”æ³•ã‚’å”±ãˆãŸï¼{target}ã®HPãŒ{val}å›å¾©ï¼',
    'æŸ”ã‚‰ã‹ãªç·‘ã®å…‰ãŒ{target}ã‚’ç™’ã™ã€‚{healer}ã®å›å¾©ã§{val}å›å¾©ï¼',
    'ã€Œå¤§ä¸ˆå¤«ã€ç§ãŒã¤ã„ã¦ã‚‹ã€{healer}ãŒ{target}ã‚’{val}å›å¾©ã•ã›ãŸï¼',
  ],

  // === åƒ§ä¾¶ãƒãƒ• ===
  priestBuff: [
    '{priest}ãŒ{target}ã«å®ˆè­·ã®ç¥ˆã‚Šã‚’æ§ã’ãŸï¼é˜²å¾¡+{val}ï¼',
    '{priest}ã®è–ãªã‚‹è© å”±ãŒ{target}ã‚’å¼·åŒ–ã—ãŸï¼é˜²å¾¡+{val}ï¼',
    '{priest}ãŒ{target}ã«åŠ è­·ã®ç´‹ç« ã‚’åˆ»ã‚“ã ï¼é˜²å¾¡+{val}ï¼',
    'ã€Œç¥ã‚ˆã€ã“ã®è€…ã‚’ãŠå®ˆã‚Šãã ã•ã„ã€{priest}ã®ç¥ç¦ã§{target}ã®é˜²å¾¡+{val}ï¼',
    '{priest}ãŒ{target}ã®é§ã«è–åˆ¥ã®å„€å¼ã‚’æ–½ã—ãŸï¼é˜²å¾¡+{val}ï¼',
    '{priest}ãŒè–æ°´ã‚’æŒ¯ã‚Šã‹ã‘ã€{target}ã®é˜²å¾¡åŠ›ã‚’+{val}é«˜ã‚ãŸï¼',
    'ã€Œæ±ã«é‰„å£ã®å®ˆã‚Šã‚’ã€{priest}ã®è© å”±ã§{target}ã®é˜²å¾¡+{val}ï¼',
    '{priest}ãŒå…‰ã®éšœå£ã‚’{target}ã®å‘¨å›²ã«å±•é–‹ã—ãŸï¼é˜²å¾¡+{val}ï¼',
  ],

  // === ç½ ç™ºè¦‹ ===
  trapFound: [
    'ç½ ã ï¼{trap}ã‚’ç™ºè¦‹ï¼{thief}ãŒé®®ã‚„ã‹ãªæ‰‹ã¤ãã§è§£é™¤ã—ãŸï¼',
    '{thief}ãŒ{trap}ã«ã„ã¡æ—©ãæ°—ã¥ã„ãŸï¼ã€Œä»»ã›ã¦ï¼ã€è¯éº—ã«è§£é™¤ï¼',
    '{thief}ã®é‹­ã„ç›®ãŒ{trap}ã‚’è¦‹æŠœã„ãŸã€‚æ…£ã‚ŒãŸæ‰‹ã¤ãã§è§£é™¤å®Œäº†ï¼',
    'ã€Œå±ãªã„ï¼ã€{thief}ãŒãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã‚’æ­¢ã‚ãŸã€‚{trap}ã ï¼å³åº§ã«è§£é™¤ï¼',
    '{thief}ãŒåœ°é¢ã®å¾®å¦™ãªé•å’Œæ„Ÿã«æ°—ã¥ã„ãŸã€‚{trap}ã‚’è¦‹äº‹ã«è§£é™¤ï¼',
    'ã€Œã“ã†ã„ã†ã®ã¯å¾—æ„ãªã‚“ã ã€{thief}ãŒ{trap}ã‚’ã‚ã£ã•ã‚Šè§£é™¤ã—ãŸï¼',
    '{thief}ãŒé“å…·ã‚’å–ã‚Šå‡ºã—ã€{trap}ã‚’æ‰‹éš›ã‚ˆãç„¡åŠ›åŒ–ã—ãŸï¼',
    'ã€Œãµãµã‚“ã€ã“ã‚“ãªã®æœé£¯å‰ã€{thief}ãŒ{trap}ã‚’è§£é™¤ã—ã¦ãƒ‰ãƒ¤é¡”ï¼',
  ],

  // === ç½ ç™ºå‹• ===
  trapTriggered: [
    'ğŸ’¥ {trap}ãŒä½œå‹•ã—ãŸï¼é€ƒã’ã‚ï¼',
    'ğŸ’¥ ã‚«ãƒãƒƒ...ã¾ãšã„ï¼{trap}ã ï¼',
    'ğŸ’¥ ã€Œã—ã¾ã£ãŸï¼ã€{trap}ã«å¼•ã£ã‹ã‹ã£ãŸï¼',
    'ğŸ’¥ åœ°é¢ãŒå…‰ã£ãŸç¬é–“ã€{trap}ãŒç™ºå‹•ï¼',
    'ğŸ’¥ èª°ã‹ãŒè¸ã‚“ã§ã—ã¾ã£ãŸï¼{trap}ãŒèµ·å‹•ï¼',
    'ğŸ’¥ å£ã‹ã‚‰{trap}ãŒé£›ã³å‡ºã—ãŸï¼',
    'ğŸ’¥ å¤©äº•ã«ä»•æ›ã‘ã‚‰ã‚Œã¦ã„ãŸ{trap}ãŒä½œå‹•ã—ãŸï¼',
  ],

  // === ç½ ãƒ€ãƒ¡ãƒ¼ã‚¸ ===
  trapDamage: [
    '{name}ãŒå·»ãè¾¼ã¾ã‚ŒãŸï¼{dmg}ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼',
    '{name}ã«{trap}ã®ç›´æ’ƒï¼{dmg}ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼',
    'é€ƒã’é…ã‚ŒãŸ{name}ã«{dmg}ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼',
    '{name}ãŒ{dmg}ã®ãƒ€ãƒ¡ãƒ¼ã‚¸ã‚’å—ã‘ãŸï¼ç—›ãã†ã ï¼',
    '{name}ã‚’ã‹ã™ã‚ã¦{dmg}ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼',
  ],

  // === ä¼‘æ†© ===
  restScene: [
    'ğŸ• å®‰å…¨ãªåºƒé–“ã‚’è¦‹ã¤ã‘ãŸã€‚ç„šãç«ã‚’å›²ã‚“ã§ä¸€æ¯ã¤ã...',
    'ğŸ• æ¸…ã‚‰ã‹ãªæ³‰ã‚’ç™ºè¦‹ï¼ç–²ã‚ŒãŸä½“ã‚’ç™’ã™...',
    'ğŸ• å¤ã„ç¥­å£‡ã®ã‚ã‚‹éƒ¨å±‹ã ã€‚ä¸æ€è­°ã¨å®‰å¿ƒæ„ŸãŒã‚ã‚‹...',
    'ğŸ• è‹”ã‚€ã—ãŸçŸ³å®¤ã«æ¸©ã‹ãªå…‰ãŒå·®ã—è¾¼ã‚“ã§ã„ã‚‹ã€‚å°‘ã—ä¼‘ã‚‚ã†...',
    'ğŸ• å†’é™ºè€…ã®æ®‹ã—ãŸã‚­ãƒ£ãƒ³ãƒ—è·¡ã‚’ç™ºè¦‹ã€‚ã¾ã ä½¿ãˆãã†ã ...',
    'ğŸ• é­”æ³•ã®ç¯ã‚ŠãŒç¯ã‚‹å®‰å…¨åœ°å¸¯ã€‚ã“ã“ã§ä¼‘æ†©ã—ã‚ˆã†...',
    'ğŸ• åœ°ä¸‹æ°´è„ˆã®éŸ³ãŒå¿ƒåœ°ã‚ˆã„ã€‚ã“ã“ãªã‚‰å®‰å…¨ã«ä¼‘ã‚ã‚‹...',
    'ğŸ• é¢¨é€šã—ã®è‰¯ã„éƒ¨å±‹ã‚’è¦‹ã¤ã‘ãŸã€‚æ–°é®®ãªç©ºæ°—ã§æ°—åˆ†ãŒå›å¾©ã™ã‚‹...',
    'ğŸ• ä¸æ€è­°ãªã‚­ãƒã‚³ãŒç™ºå…‰ã™ã‚‹ç¾ã—ã„æ´ç©´ã€‚æŸã®é–“ã®ä¼‘æ¯...',
    'ğŸ• æ—…ã®å•†äººãŒæ®‹ã—ãŸç‰©è³‡ã‚’ç™ºè¦‹ã€‚ã‚ã‚ŠãŒãŸãä½¿ã‚ã›ã¦ã‚‚ã‚‰ãŠã†...',
  ],
  restRecover: [
    'ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼å…¨å“¡ãŒè‹±æ°—ã‚’é¤Šã£ãŸ',
    'å‚·ãŒå°‘ã—ç™’ãˆã€ä½“åŠ›ãŒå›å¾©ã—ãŸ',
    'æ¸©ã‹ã„é£Ÿäº‹ã§å…¨å“¡ã®é¡”è‰²ãŒè‰¯ããªã£ãŸ',
    'ã—ã°ã—ã®ä¼‘æ¯ã§ç–²åŠ´ãŒå’Œã‚‰ã„ã ',
    'æ°´ã‚’é£²ã¿ã€ä½“åŠ›ã‚’å–ã‚Šæˆ»ã—ãŸ',
    'ç›®ã‚’é–‰ã˜ã¦ç²¾ç¥ã‚’é›†ä¸­ã•ã›ãŸã€‚å›å¾©ã—ãŸ',
    'äº’ã„ã®å‚·ã‚’æ‰‹å½“ã¦ã—åˆã„ã€å°‘ã—æ¥½ã«ãªã£ãŸ',
  ],

  // === å®ç®± ===
  treasureFind: [
    'ğŸ’ æœ½ã¡ãŸæ‰‰ã®å¥¥ã«å®ç®±ã‚’ç™ºè¦‹ï¼',
    'ğŸ’ è¼ãå®ç®±ãŒæš—é—˜ã«ä½‡ã‚“ã§ã„ãŸï¼',
    'ğŸ’ éš ã—éƒ¨å±‹ã«å®ç®±ãŒã‚ã£ãŸï¼ç½ ã§ã¯ãªã•ãã†ã ...',
    'ğŸ’ å€’ã—ãŸé­”ç‰©ã®å·£ã®ä¸­ã«å®ç®±ã‚’è¦‹ã¤ã‘ãŸï¼',
    'ğŸ’ å£ã®éš™é–“ã‹ã‚‰è¦—ã„ã¦ã„ãŸã®ã¯...å®ç®±ã ï¼',
    'ğŸ’ å¤ä»£ã®å°å°ãŒè§£ã‘ã€å®ç®±ãŒç¾ã‚ŒãŸï¼',
    'ğŸ’ åœ°é¢ã«åŠåˆ†åŸ‹ã¾ã£ãŸå®ç®±ã‚’æ˜ã‚Šå‡ºã—ãŸï¼',
  ],
  treasureGet: [
    'ã€{item}ã€‘ã‚’æ‰‹ã«å…¥ã‚ŒãŸï¼{target}ãŒè£…å‚™ã—ãŸï¼',
    'ç´ æ™´ã‚‰ã—ã„ï¼ã€{item}ã€‘ã ï¼{target}ã®ã‚‚ã®ã«ãªã£ãŸï¼',
    'ã€{item}ã€‘ã‚’ç™ºè¦‹ï¼{target}ãŒå¤§äº‹ãã†ã«å—ã‘å–ã£ãŸï¼',
    'ä¸­ã‹ã‚‰ã€{item}ã€‘ãŒï¼{target}ãŒç›®ã‚’è¼ã‹ã›ã¦ã„ã‚‹ï¼',
    'ã€{item}ã€‘ã‚²ãƒƒãƒˆï¼{target}ã®åŠ›ãŒå¢—ã—ãŸï¼',
  ],
  treasureStatUp: {
    hp: ['{target}ã®ç”Ÿå‘½åŠ›ãŒã¿ãªãã‚‹ï¼æœ€å¤§HPãŒä¸Šæ˜‡ï¼', '{target}ãŒåŠ›å¼·ã•ã‚’å¾—ãŸï¼æœ€å¤§HPå¢—åŠ ï¼'],
    atk: ['{target}ã®æ”»æ’ƒåŠ›ãŒä¸ŠãŒã£ãŸï¼', '{target}ãŒæ–°ãŸãªåŠ›ã‚’æ‰‹ã«ã—ãŸï¼æ”»æ’ƒåŠ›ä¸Šæ˜‡ï¼'],
    def: ['{target}ã®å®ˆã‚ŠãŒå›ºããªã£ãŸï¼é˜²å¾¡åŠ›ä¸Šæ˜‡ï¼', '{target}ã®é˜²å¾¡åŠ›ãŒå¼·åŒ–ã•ã‚ŒãŸï¼'],
    spd: ['{target}ã®è¶³å–ã‚ŠãŒè»½ããªã£ãŸï¼ç´ æ—©ã•ä¸Šæ˜‡ï¼', '{target}ãŒé¢¨ã®ã‚ˆã†ã«é€Ÿããªã£ãŸï¼ç´ æ—©ã•å¢—åŠ ï¼'],
  },

  // === ãƒ•ãƒ­ã‚¢åˆ°é” ===
  floorMilestone: {
    5:  ['â” åœ°ä¸‹5éšã€‚ç©ºæ°—ãŒå†·ãŸããªã£ã¦ããŸ...', 'â” B5Fã€‚ã“ã®è¾ºã‚Šã‹ã‚‰æœ¬å½“ã®ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ãŒå§‹ã¾ã‚‹', 'â” 5éšåˆ°é”ã€‚å£ã«ä¸æ°—å‘³ãªæ¨¡æ§˜ãŒæã‹ã‚Œã¦ã„ã‚‹...'],
    10: ['â” åœ°ä¸‹10éšï¼å¥‡å¦™ãªå”¸ã‚Šå£°ãŒé ãã‹ã‚‰èã“ãˆã‚‹...', 'â” B10Fåˆ°é”ï¼ã“ã“ã¾ã§æ¥ãŸå†’é™ºè€…ã¯å¤šããªã„ã ã‚ã†', 'â” 10éšã€‚é­”åŠ›ã®æ¿ƒåº¦ãŒæ˜ã‚‰ã‹ã«ä¸ŠãŒã£ã¦ã„ã‚‹...'],
    15: ['â” åœ°ä¸‹15éšã€‚å…‰æºãªã—ã§ã¯ä¸€å¯¸å…ˆã‚‚è¦‹ãˆãªã„é—‡...', 'â” B15Fï¼å£ãŒè„ˆå‹•ã—ã¦ã„ã‚‹ã‚ˆã†ã«è¦‹ãˆã‚‹...æ°—ã®ã›ã„ã‹ï¼Ÿ', 'â” 15éšåˆ°é”ã€‚ã“ã“ã‹ã‚‰å…ˆã¯æœªçŸ¥ã®é ˜åŸŸã ...'],
    20: ['â” åœ°ä¸‹20éšï¼ç©ºæ°—ãŒé‡ã„ã€‚æ·±æ·µã®æ¯å¹ã‚’æ„Ÿã˜ã‚‹...', 'â” B20Fåˆ°é”ï¼ä¼èª¬ã®é ˜åŸŸã«è¶³ã‚’è¸ã¿å…¥ã‚ŒãŸï¼', 'â” 20éšã€‚åœ°ä¸Šã®å…‰ã¯ã‚‚ã¯ã‚„é ã„è¨˜æ†¶ã®å½¼æ–¹...'],
    25: ['â” åœ°ä¸‹25éšï¼ç¾å®ŸãŒæ­ªã¿å§‹ã‚ã¦ã„ã‚‹...', 'â” B25Fï¼ã“ã“ã¯äººã®æ¥ã‚‹å ´æ‰€ã§ã¯ãªã„...', 'â” 25éšåˆ°é”ã€‚ç©ºé–“ãã®ã‚‚ã®ãŒæ•µæ„ã‚’æŒã£ã¦ã„ã‚‹...'],
    30: ['â” åœ°ä¸‹30éšï¼æ·±æ·µã®æ ¸å¿ƒã«è¿‘ã¥ã„ã¦ã„ã‚‹ï¼', 'â” B30Fåˆ°é”ï¼ã“ã®éšå±¤ã‚’è¦‹ãŸè€…ã¯ã»ã¨ã‚“ã©ã„ãªã„ï¼'],
  },
  floorAmbience: [
    'å£ã‚’ä¼ã†æ°´æ»´ã®éŸ³ã ã‘ãŒéŸ¿ã„ã¦ã„ã‚‹...',
    'æ¾æ˜ã®ç‚ãŒä¸è‡ªç„¶ã«æºã‚ŒãŸ...',
    'ã©ã“ã‹ã‚‰ã‹å†·ãŸã„é¢¨ãŒå¹ã„ã¦ãã‚‹...',
    'é ãã§ä½•ã‹ãŒå´©ã‚Œã‚‹éŸ³ãŒã—ãŸ...',
    'è¶³å…ƒã«å‰ã®å†’é™ºè€…ã®ã‚‚ã®ã‚‰ã—ãéª¨ãŒæ•£ã‚‰ã°ã£ã¦ã„ã‚‹...',
    'å£ã«è‹”ãŒç”Ÿãˆã€ã˜ã£ã¨ã‚Šã¨ã—ãŸæ¹¿æ°—ãŒæ¼‚ã†...',
    'å¤©äº•ã‹ã‚‰æ­£ä½“ä¸æ˜ã®æ¶²ä½“ãŒæ»´ã‚Šè½ã¡ã¦ã„ã‚‹...',
    'å¥‡å¦™ãªç´‹æ§˜ãŒæ·¡ãå…‰ã‚’æ”¾ã£ã¦ã„ã‚‹...',
    'ç©ºæ°—ãŒæ¾±ã¿ã€æ¯è‹¦ã—ã•ã‚’æ„Ÿã˜ã‚‹...',
    'ã‹ã™ã‹ã«ç”˜ã„åŒ‚ã„ãŒã™ã‚‹...ç½ ã‹ã‚‚ã—ã‚Œãªã„...',
  ],

  // === æ‹æ„›ã‚¤ãƒ™ãƒ³ãƒˆ ===
  loveStage1: [
    '{a}ãŒ{b}ã‚’ã¡ã‚‰ã¡ã‚‰ã¨æ°—ã«ã—ã¦ã„ã‚‹...',
    '{a}ã®è¦–ç·šãŒ{b}ã«å‘ã„ã¦ã„ã‚‹ã“ã¨ãŒå¤šã„...',
    '{b}ãŒè»¢ã³ãã†ã«ãªã£ãŸæ™‚ã€{a}ãŒã•ã£ã¨æ‰‹ã‚’å·®ã—å‡ºã—ãŸ',
    'æˆ¦é—˜å¾Œã€{a}ãŒçœŸã£å…ˆã«{b}ã®ç„¡äº‹ã‚’ç¢ºèªã—ã¦ã„ãŸ',
    '{a}ãŒ{b}ã®éš£ã‚’ã‚­ãƒ¼ãƒ—ã—ã¦ã„ã‚‹ã€‚ç„¡æ„è­˜ï¼Ÿ',
    '{b}ãŒè©±ã—ã‹ã‘ã‚‹ã¨{a}ãŒã¡ã‚‡ã£ã¨ãã“ã¡ãªããªã‚‹...',
    '{a}ãŒ{b}ã®å¥½ããªé£Ÿã¹ç‰©ã‚’è¦šãˆã¦ã„ãŸã€‚...å¶ç„¶ï¼Ÿ',
    'ä¼‘æ†©ä¸­ã€{a}ãŒ{b}ã«æ°´ç­’ã‚’å·®ã—å‡ºã—ãŸã€‚å„ªã—ã„...',
  ],
  loveStage2: [
    '{a}ã¨{b}ãŒæ¥½ã—ãã†ã«è©±ã—ã¦ã„ã‚‹ã€‚è·é›¢ãŒè¿‘ã„...',
    '{a}ã¨{b}ãŒã‚ˆãäºŒäººãã‚Šã«ãªã£ã¦ã„ã‚‹æ°—ãŒã™ã‚‹...',
    'æˆ¦é—˜ä¸­ã€{a}ãŒ{b}ã‚’åº‡ã†ã‚ˆã†ãªå‹•ãã‚’è¦‹ã›ãŸ',
    'ä¼‘æ†©ä¸­ã€{a}ã¨{b}ãŒç„šãç«ã®å‰ã§è‚©ã‚’å¯„ã›åˆã£ã¦ã„ãŸ',
    'ã€Œ{b}ã®ã“ã¨...ã€{a}ãŒã¼ã‚“ã‚„ã‚Šå‘Ÿã„ãŸã€‚èã“ãˆã¦ã‚‹ã',
    '{a}ãŒ{b}ã«ã ã‘ç‰¹åˆ¥ã«å„ªã—ã„ã€‚ä»–ã®ãƒ¡ãƒ³ãƒãƒ¼ãŒã‚¸ãƒˆç›®ã§è¦‹ã¦ã„ã‚‹',
    '{a}ã¨{b}ãŒåŒæ™‚ã«åŒã˜ã“ã¨ã‚’è¨€ã£ãŸã€‚è¦‹ã¤ã‚åˆã£ã¦ç…§ã‚Œã¦ã„ã‚‹',
    '{b}ãŒæ€ªæˆ‘ã‚’ã—ãŸæ™‚ã€{a}ãŒå–ã‚Šä¹±ã—ã¦ã„ãŸ',
  ],
  loveStage3: [
    'ğŸ’• {a}ã¨{b}ã¯æ‹ã«è½ã¡ãŸã‚ˆã†ã ï¼æˆ¦é—˜ã«å…¨ãé›†ä¸­ã§ãã¦ã„ãªã„ï¼',
    'ğŸ’• {a}ã¨{b}ã®é–“ã«ãƒ”ãƒ³ã‚¯ã®ã‚ªãƒ¼ãƒ©ãŒ...ï¼å®Œå…¨ã«æ‹ã—ã¦ã‚‹ï¼',
    'ğŸ’• {a}ãŒ{b}ã«èŠ±ã‚’æ‘˜ã‚“ã§æ¸¡ã—ãŸã€‚ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ã®ä¸­ã§ä½•ã—ã¦ã‚‹ã‚“ã ...',
    'ğŸ’• {a}ã¨{b}ãŒæ‰‹ã‚’ç¹‹ã„ã§æ­©ã„ã¦ã„ã‚‹ã€‚æˆ¦ã†æ°—ã‚ã‚‹ã®ã‹...ï¼Ÿ',
    'ğŸ’• ã€Œ{b}ã‚’å®ˆã‚Œã‚‹ãªã‚‰å‘½ã‚‚ã„ã‚‰ãªã„ã€{a}ãŒçœŸé¡”ã§è¨€ã£ãŸã€‚ãŠã„ãŠã„...',
    'ğŸ’• {a}ã¨{b}ãŒã‚¤ãƒãƒ£ã‚¤ãƒãƒ£ã—ã¦ã„ã‚‹ã€‚ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã®ç©ºæ°—ãŒå¾®å¦™ã«...',
    'ğŸ’• ã€ŒäºŒäººã®ä¸–ç•Œã€ã«å…¥ã£ãŸ{a}ã¨{b}ã€‚å‘¼ã³ã‹ã‘ã¦ã‚‚èã“ãˆã¦ã„ãªã„...',
  ],
  loveStage4: [
    'ğŸ’” {a}ã¨{b}ã¯ã‚‚ã†æˆ¦ã„ã©ã“ã‚ã§ã¯ãªã„ã€‚äº’ã„ã—ã‹è¦‹ãˆã¦ã„ãªã„...',
    'ğŸ’” ã€Œã‚‚ã†ã“ã‚“ãªå±é™ºãªå ´æ‰€ã«ã„ã‚‰ã‚Œãªã„ã€{a}ãŒ{b}ã®æ‰‹ã‚’å–ã£ãŸ',
    'ğŸ’” {a}ã¨{b}ã¯æ­¦å™¨ã‚’ç½®ã„ãŸã€‚äºŒäººã§ç”Ÿãã‚‹é“ã‚’é¸ã‚“ã ã®ã ...',
    'ğŸ’” ã€Œå†’é™ºã‚ˆã‚Šå¤§åˆ‡ãªã‚‚ã®ã‚’è¦‹ã¤ã‘ãŸã€{a}ãŒå¾®ç¬‘ã‚“ã ã€‚{b}ã‚‚é ·ã„ãŸ',
    'ğŸ’” {a}ã¨{b}ã¯æŠ±ãåˆã£ã¦é›¢ã‚Œãªã„ã€‚ã‚‚ã†å†’é™ºè€…ã§ã¯ã„ã‚‰ã‚Œãªã„...',
  ],
  loveLeave: [
    '{a}ã¨{b}ã¯æ‰‹ã‚’å–ã‚Šåˆã£ã¦ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ã‚’å»ã£ãŸ...',
    '{a}ã¨{b}ã¯å¹¸ã›ãã†ã«å»ã£ã¦ã„ã£ãŸã€‚ãŠå¹¸ã›ã«...',
    'ã€Œã¿ã‚“ãªã€ã”ã‚ã‚“ã­ã€{a}ã¨{b}ã¯æŒ¯ã‚Šè¿”ã‚‹ã“ã¨ãªãå»ã£ãŸ...',
    '{a}ã¨{b}ã¯æ—…ç«‹ã£ãŸã€‚å½¼ã‚‰ã®å†’é™ºã¯ã€åˆ¥ã®å½¢ã§ç¶šãã®ã ã‚ã†...',
    'æ®‹ã•ã‚ŒãŸãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã¯ã€äºŒäººã®èƒŒä¸­ã‚’è¤‡é›‘ãªæ€ã„ã§è¦‹é€ã£ãŸ...',
  ],

  // === åŒè·å«‰å¦¬ ===
  jealousy: [
    'ğŸ˜¤ {names}ã®é–“ã«ãƒ”ãƒªãƒƒã¨ã—ãŸç©ºæ°—ãŒ...ï¼ˆèƒ½åŠ›ä½ä¸‹ï¼‰',
    'ğŸ˜¤ {a}ãŒ{b}ã®è£…å‚™ã‚’ã‚¸ãƒ­ã‚¸ãƒ­è¦‹ã¦ã„ã‚‹...ã€Œãªã‚“ã§ã‚¢ã‚¤ãƒ„ã®ã»ã†ãŒè‰¯ã„ã‚“ã ã€ï¼ˆèƒ½åŠ›ä½ä¸‹ï¼‰',
    'ğŸ˜¤ {a}ã¨{b}ãŒãŠäº’ã„ã®æˆ¦ã„æ–¹ã«ãƒ€ãƒ¡å‡ºã—ã—åˆã£ã¦ã„ã‚‹ï¼ˆèƒ½åŠ›ä½ä¸‹ï¼‰',
    'ğŸ˜¤ ã€Œç§ã®ã»ã†ãŒä¸Šæ‰‹ãã‚„ã‚Œã‚‹ã€{a}ã¨{b}ãŒç«èŠ±ã‚’æ•£ã‚‰ã—ã¦ã„ã‚‹ï¼ˆèƒ½åŠ›ä½ä¸‹ï¼‰',
    'ğŸ˜¤ {a}ãŒ{b}ã®æ´»èºã‚’è¦‹ã¦èˆŒæ‰“ã¡ã—ãŸã€‚å¤§äººã’ãªã„...ï¼ˆèƒ½åŠ›ä½ä¸‹ï¼‰',
    'ğŸ˜¤ åŒã˜{cls}ã¨ã—ã¦{a}ã¨{b}ã®ãƒ—ãƒ©ã‚¤ãƒ‰ãŒã¶ã¤ã‹ã‚‹ï¼ï¼ˆèƒ½åŠ›ä½ä¸‹ï¼‰',
    'ğŸ˜¤ {a}ã€Œãã®ç¨‹åº¦ã§{cls}ã‚’åä¹—ã‚‹ãªã€{b}ã€Œã¯ï¼Ÿã€é™ºæ‚ªãƒ ãƒ¼ãƒ‰ï¼ˆèƒ½åŠ›ä½ä¸‹ï¼‰',
    'ğŸ˜¤ {a}ã¨{b}ãŒ{cls}ã¨ã—ã¦ã®å®ŸåŠ›ã‚’ç«¶ã„åˆã„ã€é€£æºãŒå´©ã‚Œã¦ã„ã‚‹ï¼ˆèƒ½åŠ›ä½ä¸‹ï¼‰',
  ],

  // === æ­»äº¡ ===
  death: [
    'ğŸ’€ {name}ã¯åŠ›å°½ããŸ...',
    'ğŸ’€ {name}ãŒå€’ã‚ŒãŸï¼ã‚‚ã†å‹•ã‹ãªã„...',
    'ğŸ’€ {name}ã®ç³ã‹ã‚‰å…‰ãŒæ¶ˆãˆãŸ...',
    'ğŸ’€ ã€Œã¿ã‚“ãª...å…ˆã«...ã€{name}ã¯é™ã‹ã«ç›®ã‚’é–‰ã˜ãŸ...',
    'ğŸ’€ {name}ã¯ä»²é–“ã‚’åº‡ã†ã‚ˆã†ã«ã—ã¦å´©ã‚Œè½ã¡ãŸ...',
    'ğŸ’€ {name}ã®å†’é™ºã¯ã“ã“ã§çµ‚ã‚ã£ãŸ...',
    'ğŸ’€ {name}ã¯æœ€å¾Œã®åŠ›ã§å¾®ç¬‘ã¿ã€å€’ã‚ŒãŸ...',
  ],

  // === å…¨æ»… ===
  wipe: [
    'ï¼ï¼ï¼ å…¨æ»…...é—‡ãŒå…¨ã¦ã‚’é£²ã¿è¾¼ã‚“ã  ï¼ï¼ï¼',
    'ï¼ï¼ï¼ ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã¯å£Šæ»…ã—ãŸ...èª°ã‚‚ç”Ÿãæ®‹ã‚Œãªã‹ã£ãŸ ï¼ï¼ï¼',
    'ï¼ï¼ï¼ ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ã«é™å¯‚ãŒæˆ»ã£ãŸã€‚å†’é™ºè€…ãŸã¡ã®å§¿ã¯ã‚‚ã†ãªã„... ï¼ï¼ï¼',
    'ï¼ï¼ï¼ å…¨æ»…ã€‚å½¼ã‚‰ã®å‹‡å§¿ã¯èªã‚Šç¶™ãŒã‚Œã‚‹ã ã‚ã†... ï¼ï¼ï¼',
    'ï¼ï¼ï¼ æ·±æ·µã«æŒ‘ã‚“ã è€…ãŸã¡ã¯ã€æ·±æ·µã«å‘‘ã¾ã‚ŒãŸ... ï¼ï¼ï¼',
  ],

  // === æ¢ç´¢é–‹å§‹ ===
  startMsg: [
    'ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ãŒæš—é—‡ã®å…¥å£ã«ç«‹ã£ãŸ...',
    'å†·ãŸã„é¢¨ãŒãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ã®å¥¥ã‹ã‚‰å¹ãä»˜ã‘ã‚‹...',
    'æ¾æ˜ã«ç«ã‚’ç¯ã—ã€ä¸€æ­©ã‚’è¸ã¿å‡ºã—ãŸ...',
    'é‡ã„é‰„æ‰‰ãŒè»‹ã¿ãªãŒã‚‰é–‹ã„ãŸã€‚å†’é™ºãŒå§‹ã¾ã‚‹...',
    'å…¨å“¡ãŒé ·ãåˆã„ã€é—‡ã®ä¸­ã¸è¶³ã‚’è¸ã¿å…¥ã‚ŒãŸ...',
  ],

  // === ãƒ’ãƒ¼ãƒ©ãƒ¼ãƒ»ç›—è³Šä¸åœ¨è­¦å‘Š ===
  noHealer: [
    'âš  ãƒ’ãƒ¼ãƒ©ãƒ¼ãŒã„ãªã„...å›å¾©æ‰‹æ®µãŒé™ã‚‰ã‚Œã‚‹ã ã‚ã†',
    'âš  å›å¾©å½¹ä¸åœ¨ï¼ç„¡èŒ¶ã¯ç¦ç‰©ã ...',
    'âš  ãƒ’ãƒ¼ãƒ©ãƒ¼ãªã—ã‹...å‚·è–¬ã ã‘ã§æŒã¤ã ã‚ã†ã‹',
  ],
  noThief: [
    'âš  ç›—è³ŠãŒã„ãªã„...ç½ ã®è§£é™¤ãŒã§ããªã„ã‹ã‚‚ã—ã‚Œãªã„',
    'âš  ç›—è³Šä¸åœ¨ï¼ç½ ã«ã¯ååˆ†æ³¨æ„ã—ã‚...',
    'âš  ç½ ã®å°‚é–€å®¶ãŒã„ãªã„...æ…é‡ã«é€²ã‚€ã—ã‹ãªã„',
  ],

  // === åŒè·å…¥ã‚Š ===
  dupClass: [
    '{cls}ãŒ2äºº...äº’ã„ã‚’æ„è­˜ã—ã¦ãã“ã¡ãªã„ç©ºæ°—ãŒæµã‚Œã‚‹',
    '{cls}ãŒ2äººã‚‚ã„ã‚‹ã€‚ã€Œä¿ºã®æ–¹ãŒä¸Šã ã€ã¨è¨€ã‚ã‚“ã°ã‹ã‚Šã®è¦–ç·š...',
    'åŒã˜{cls}åŒå£«ã€è¤‡é›‘ãªç©ºæ°—ãŒæ¼‚ã£ã¦ã„ã‚‹...',
  ],
};

// ===== ã‚²ãƒ¼ãƒ çŠ¶æ…‹ =====
let selected = [];
let party = [];
let floor = 0;
let running = false;
let speedMs = [3000, 1800, 800];
let currentSpeed = 1;
let deathLog = [];
let loveStates = {}; // uid pair -> stage (0-4)
let mvpDamage = {};
let intervalId = null;
let gameStartTime = 0;
let totalPlayTime = 0;
let achievements = [];
let gameStats = {
  monstersKilled: 0,
  trapsDisarmed: 0,
  conversationsHad: 0,
  highestFloor: 0,
  totalDamageDealt: 0,
  totalHealing: 0,
  gamesPlayed: 0,
  totalDeaths: 0
};

// ===== ã‚»ãƒ¼ãƒ–ãƒ»ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½ =====
function saveGame() {
  const saveData = {
    version: '2.0',
    party: party,
    floor: floor,
    loveStates: loveStates,
    deathLog: deathLog,
    mvpDamage: mvpDamage,
    gameStats: gameStats,
    achievements: achievements,
    gameStartTime: gameStartTime,
    timestamp: Date.now()
  };
  
  localStorage.setItem('dungeonParty_save', JSON.stringify(saveData));
  showEventMessage('ã‚²ãƒ¼ãƒ ã‚’ä¿å­˜ã—ã¾ã—ãŸ', 'system');
}

function loadGame() {
  const saveStr = localStorage.getItem('dungeonParty_save');
  if (!saveStr) return false;
  
  try {
    const saveData = JSON.parse(saveStr);
    if (saveData.version !== '2.0') return false;
    
    party = saveData.party || [];
    floor = saveData.floor || 1;
    loveStates = saveData.loveStates || {};
    deathLog = saveData.deathLog || [];
    mvpDamage = saveData.mvpDamage || {};
    gameStats = {...gameStats, ...saveData.gameStats};
    achievements = saveData.achievements || [];
    gameStartTime = saveData.gameStartTime || Date.now();
    
    showScreen('dungeon-screen');
    renderHP();
    updateAdventureField();
    showEventMessage('ã‚²ãƒ¼ãƒ ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ', 'system');
    
    return true;
  } catch (e) {
    console.error('ã‚»ãƒ¼ãƒ–ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—:', e);
    return false;
  }
}

function hasSaveData() {
  const saveStr = localStorage.getItem('dungeonParty_save');
  return saveStr !== null;
}

function deleteSaveData() {
  localStorage.removeItem('dungeonParty_save');
  showEventMessage('ã‚»ãƒ¼ãƒ–ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã—ãŸ', 'system');
}

// ===== ã‚¢ãƒãƒ¼ãƒ–ãƒ¡ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ  =====
const ACHIEVEMENTS = {
  first_clear: { name: 'åˆå›ã‚¯ãƒªã‚¢', desc: 'åˆã‚ã¦B10Fã‚’ã‚¯ãƒªã‚¢', icon: 'ğŸ†' },
  all_alive: { name: 'å®Œå…¨å‹åˆ©', desc: 'å…¨å“¡ç”Ÿå­˜ã§ã‚¯ãƒªã‚¢', icon: 'ğŸ’ª' },
  speed_run: { name: 'ã‚¹ãƒ”ãƒ¼ãƒ‰ãƒ©ãƒ³', desc: '10åˆ†ä»¥å†…ã§ã‚¯ãƒªã‚¢', icon: 'âš¡' },
  love_master: { name: 'æ‹æ„›ãƒã‚¹ã‚¿ãƒ¼', desc: 'æ‹æ„›ãƒ¬ãƒ™ãƒ«3ã®ãƒšã‚¢ã‚’ä½œæˆ', icon: 'ğŸ’•' },
  no_healer: { name: 'ç„¡è¬€ãªæŒ‘æˆ¦', desc: 'ãƒ’ãƒ¼ãƒ©ãƒ¼ãªã—ã§B5Fåˆ°é”', icon: 'ğŸ”¥' },
  balanced_party: { name: 'ãƒãƒ©ãƒ³ã‚¹å‹', desc: 'å…¨6è·æ¥­ã‚’ä½¿ç”¨ã—ã¦ã‚¯ãƒªã‚¢', icon: 'âš–ï¸' },
  trap_master: { name: 'ãƒˆãƒ©ãƒƒãƒ—ãƒã‚¹ã‚¿ãƒ¼', desc: 'ç½ ã‚’20å€‹è§£é™¤', icon: 'ğŸ”§' },
  monster_hunter: { name: 'ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ãƒãƒ³ã‚¿ãƒ¼', desc: '100ä½“ã®ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’æ’ƒç ´', icon: 'âš”ï¸' }
};

function checkAchievement(achievementId) {
  if (achievements.includes(achievementId)) return;
  
  const achievement = ACHIEVEMENTS[achievementId];
  if (!achievement) return;
  
  achievements.push(achievementId);
  showEventMessage(`ğŸ† ã‚¢ãƒãƒ¼ãƒ–ãƒ¡ãƒ³ãƒˆç²å¾—: ${achievement.name}`, 'achievement');
  addLog(`ğŸ† ã‚¢ãƒãƒ¼ãƒ–ãƒ¡ãƒ³ãƒˆç²å¾—: ${achievement.name} - ${achievement.desc}`, 'achievement');
  
  // ã‚»ãƒ¼ãƒ–ãƒ‡ãƒ¼ã‚¿æ›´æ–°
  if (running) saveGame();
}

function updateStats(statName, value = 1) {
  gameStats[statName] = (gameStats[statName] || 0) + value;
}

// ===== UI: é¸æŠç”»é¢ =====
const STAT_MAX = {hp:200, atk:60, def:30, spd:30};

function makeStatBar(label, val, max, cls) {
  const pct = Math.min(100, val/max*100);
  return `<div class="stat-row"><span class="stat-label">${label}</span><div class="stat-bar-bg"><div class="stat-bar-fill ${cls}" style="width:${pct}%"></div></div><span class="stat-val">${val}</span></div>`;
}

function renderSelect() {
  const grid = document.getElementById('char-grid');
  grid.innerHTML = '';
  characters.forEach(c => {
    const p = c.personality || {};
    const genderCls = c.gender==='m'?'gender-m':'gender-f';
    const div = document.createElement('div');
    div.className = 'char-card' + (selected.includes(c.uid)?' selected':'') +
      (selected.length>=4 && !selected.includes(c.uid)?' disabled':'');
    div.innerHTML = `<div class="char-icon">${c.icon}</div>
      <div class="char-name"><span class="${genderCls}">${c.genderLabel}</span> ${c.name}</div>
      <div class="char-class">${c.className}</div>
      <div class="char-trait">${p.traitShort||p.trait||''}</div>
      <div class="char-quote">ã€Œ${p.quote||'...'}ã€</div>
      <div class="char-stats-bars">
        ${makeStatBar('HP',c.baseHp,STAT_MAX.hp,'hp')}
        ${makeStatBar('ATK',c.atk,STAT_MAX.atk,'atk')}
        ${makeStatBar('DEF',c.def,STAT_MAX.def,'def')}
        ${makeStatBar('SPD',c.spd,STAT_MAX.spd,'spd')}
      </div>`;
    div.onclick = (e) => { e.stopPropagation(); toggleSelect(c.uid); };
    // é•·æŠ¼ã—ã§è©³ç´°è¡¨ç¤º
    let pressTimer = null;
    div.addEventListener('pointerdown', () => { pressTimer = setTimeout(() => showDetail(c.uid), 500); });
    div.addEventListener('pointerup', () => clearTimeout(pressTimer));
    div.addEventListener('pointerleave', () => clearTimeout(pressTimer));
    // PC: ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã§è©³ç´°
    div.addEventListener('dblclick', (e) => { e.preventDefault(); showDetail(c.uid); });
    grid.appendChild(div);
  });
  document.getElementById('party-info').textContent = `${selected.length} / 4 äººé¸æŠä¸­`;
  document.getElementById('start-btn').disabled = selected.length !== 4;
  renderPartyPreview();
}

function toggleSelect(uid) {
  const i = selected.indexOf(uid);
  if (i >= 0) selected.splice(i, 1);
  else if (selected.length < 4) selected.push(uid);
  renderSelect();
}

// ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
const PARTY_HINTS = [
  'çµ„ã¿åˆã‚ã›ã‚’å·¥å¤«ã—ã¦ã€ã‚ˆã‚Šæ·±ã„éšå±¤ã‚’ç›®æŒ‡ãã†ï¼',
  'ãƒ’ãƒ¼ãƒ©ãƒ¼ãŒã„ã‚‹ã¨å®‰å®šæ„ŸãŒå¢—ã™ã‹ã‚‚...',
  'ç›—è³ŠãŒã„ãªã„ã¨ç½ ã«è‹¦åŠ´ã™ã‚‹ã‹ã‚‚...',
  'åŒã˜è·æ¥­ãŒ2äººã„ã‚‹ã¨ã€ä½•ã‹èµ·ã“ã‚Šãã†...',
];
const PAIR_HINTS = {
  'knight_m:healer_f': 'ã“ã®äºŒäººã€ãªã‚“ã ã‹è¦–ç·šãŒåˆã£ã¦ã‚‹æ°—ãŒã™ã‚‹...',
  'mage_m:archer_f': 'æ­£åå¯¾ã®æ€§æ ¼ã ã‘ã©...ä½•ã‹èµ·ããã†ãªäºˆæ„Ÿ',
  'thief_m:mage_f': 'ã‚«ã‚ªã‚¹ãªçµ„ã¿åˆã‚ã›...ç›®ãŒé›¢ã›ãªã„',
  'archer_m:priest_f': 'åˆã€…ã—ã„ç©ºæ°—ãŒæ¼‚ã£ã¦ã„ã‚‹...',
  'priest_m:thief_f': 'é™ã¨é™...ã§ã‚‚ä½•ã‹é€šã˜åˆã†ã‚‚ã®ãŒï¼Ÿ',
  'knight_m:knight_f': 'é¨å£«ãŒäºŒäºº...ãƒ—ãƒ©ã‚¤ãƒ‰ãŒã¶ã¤ã‹ã‚Šãã†',
  'mage_m:mage_f': 'å¤©æ‰åŒå£«...ç«èŠ±ãŒæ•£ã‚Šãã†',
  'healer_m:healer_f': 'ç™’ã—æ‰‹ãŒäºŒäºº...ãŠäº’ã„æ°—é£ã„ã™ãï¼Ÿ',
  'thief_m:thief_f': 'å½±ã®è€…åŒå£«...å¦™ãªç·Šå¼µæ„ŸãŒã‚ã‚‹',
  'archer_m:archer_f': 'å¼“ä½¿ã„åŒå£«ã®ãƒ©ã‚¤ãƒãƒ«æ„è­˜ãŒèŠ½ç”Ÿãˆãã†...',
  'priest_m:priest_f': 'è–è·è€…ã‚³ãƒ³ãƒ“...æ¯’èˆŒã¨ä¸–è©±ç„¼ãã®ç›¸æ€§ã¯ï¼Ÿ',
};
function renderPartyPreview() {
  const preview = document.getElementById('party-preview');
  const members = document.getElementById('party-preview-members');
  const hint = document.getElementById('party-hint');
  if (selected.length === 0) { preview.classList.remove('show'); return; }
  preview.classList.add('show');
  let html = '';
  for (let i=0; i<4; i++) {
    if (i < selected.length) {
      const c = characters.find(x=>x.uid===selected[i]);
      html += `<div class="party-preview-member"><span class="pp-icon">${c.icon}</span><div class="pp-info"><div class="pp-name">${c.name}</div><div class="pp-class">${c.className}</div></div></div>`;
    } else {
      html += `<div class="party-preview-empty">?</div>`;
    }
  }
  members.innerHTML = html;
  // ç›¸æ€§ãƒ’ãƒ³ãƒˆ
  let hintText = '';
  if (selected.length >= 2) {
    for (let i=0;i<selected.length;i++) {
      for (let j=i+1;j<selected.length;j++) {
        const k1 = selected[i]+':'+selected[j];
        const k2 = selected[j]+':'+selected[i];
        if (PAIR_HINTS[k1]) { hintText = PAIR_HINTS[k1]; break; }
        if (PAIR_HINTS[k2]) { hintText = PAIR_HINTS[k2]; break; }
      }
      if (hintText) break;
    }
  }
  if (!hintText && selected.length >= 2) {
    // åŒè·ãƒã‚§ãƒƒã‚¯
    const classes = selected.map(uid => characters.find(x=>x.uid===uid).classId);
    const dupes = classes.filter((c,i)=>classes.indexOf(c)!==i);
    if (dupes.length > 0) {
      const cls = CLASSES.find(x=>x.id===dupes[0]).name;
      hintText = `${cls}ãŒäºŒäºº...ç«¶ã„åˆã†ã‹ã€è¶³ã‚’å¼•ã£å¼µã‚‹ã‹...`;
    }
  }
  if (!hintText && selected.length < 4) hintText = PARTY_HINTS[selected.length % PARTY_HINTS.length];
  hint.textContent = hintText ? `ğŸ’­ ${hintText}` : '';
}

// ã‚­ãƒ£ãƒ©è©³ç´°ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—
function showDetail(uid) {
  const c = characters.find(x=>x.uid===uid);
  const p = c.personality || {};
  const genderCls = c.gender==='m'?'gender-m':'gender-f';
  const content = document.getElementById('card-detail-content');
  content.innerHTML = `
    <h3>${c.icon} <span class="${genderCls}">${c.genderLabel}</span> ${c.name}</h3>
    <div style="text-align:center;color:#aaa;font-size:.85em">${c.className}ã€€|ã€€${p.traitShort||p.trait||''}</div>
    <div class="detail-section">
      <h4>ğŸ“– ãƒãƒƒã‚¯ã‚¹ãƒˆãƒ¼ãƒªãƒ¼</h4>
      <p>${p.backstory||'ä¸æ˜'}</p>
    </div>
    <div class="detail-section detail-stats">
      <h4>ğŸ“Š ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</h4>
      ${makeStatBar('HP',c.baseHp,STAT_MAX.hp,'hp')}
      ${makeStatBar('ATK',c.atk,STAT_MAX.atk,'atk')}
      ${makeStatBar('DEF',c.def,STAT_MAX.def,'def')}
      ${makeStatBar('SPD',c.spd,STAT_MAX.spd,'spd')}
    </div>
    <div class="detail-section">
      <h4>ğŸ’¬ æ€§æ ¼ãƒ»å£èª¿</h4>
      <p>${p.trait||''}ï¼ˆ${p.tone||''}ï¼‰</p>
    </div>
    <div class="detail-section">
      <h4>âš” æˆ¦é—˜ã‚¹ã‚¿ã‚¤ãƒ«</h4>
      <p>${c.desc}</p>
    </div>
    <div class="detail-section">
      <h4>ğŸ—£ ä»£è¡¨ã‚»ãƒªãƒ•</h4>
      <p style="font-style:italic;color:#7ecfcf">ã€Œ${p.quote||'...'}ã€</p>
    </div>
  `;
  document.getElementById('card-detail-overlay').classList.add('show');
}
function closeDetail() {
  document.getElementById('card-detail-overlay').classList.remove('show');
}
document.getElementById('card-detail-overlay').addEventListener('click', (e) => {
  if (e.target === document.getElementById('card-detail-overlay')) closeDetail();
});

// ===== ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³é–‹å§‹ =====
function startDungeon() {
  party = selected.map(uid => {
    const c = characters.find(x=>x.uid===uid);
    return {...c, hp: c.baseHp, maxHp: c.baseHp, alive: true, buffs: {}, loveTarget: null, loveStage: 0};
  });
  floor = 0; deathLog = []; loveStates = {}; mvpDamage = {};
  party.forEach(p => mvpDamage[p.uid] = 0);

  // æ‹æ„›ãƒšã‚¢ãƒã‚§ãƒƒã‚¯
  initLovePairs();

  document.getElementById('party-preview').classList.remove('show');
  showScreen('dungeon-screen');
  renderHP();
  clearLog();
  addLog('ï¼ï¼ï¼ ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³æ¢ç´¢é–‹å§‹ ï¼ï¼ï¼', 'system');
  addLog(pick(TEXTS.startMsg), 'system');

  // ã‚·ãƒŠã‚¸ãƒ¼ç™ºå‹•ãƒã‚§ãƒƒã‚¯
  checkSynergies();

  // ãƒ’ãƒ¼ãƒ©ãƒ¼ä¸åœ¨è­¦å‘Š
  if (!party.some(p=>p.classId==='healer')) {
    addLog(pick(TEXTS.noHealer), 'system');
  }
  if (!party.some(p=>p.classId==='thief')) {
    addLog(pick(TEXTS.noThief), 'system');
  }

  // åŒè·ãƒã‚§ãƒƒã‚¯
  const classCount = {};
  party.forEach(p => classCount[p.classId] = (classCount[p.classId]||0)+1);
  Object.entries(classCount).forEach(([cid,cnt]) => {
    if (cnt >= 2) {
      const cls = CLASSES.find(c=>c.id===cid).name;
      addLog(pick(TEXTS.dupClass).replace(/{cls}/g, cls), 'system');
    }
  });

  running = true;
  gameStartTime = Date.now();
  updateStats('gamesPlayed');
  
  // å†’é™ºãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åˆæœŸåŒ–
  initAdventureField();
  
  // è‡ªå‹•ã‚»ãƒ¼ãƒ–è¨­å®šã®ç¢ºèª
  const settings = JSON.parse(localStorage.getItem('dungeonParty_settings') || '{}');
  if (settings.autoSave !== false) {
    saveGame();
  }
  
  scheduleNextFloor();
}

function initLovePairs() {
  const uids = party.map(p=>p.uid);
  LOVE_PAIRS.forEach(([a,b,prob]) => {
    if (uids.includes(a) && uids.includes(b)) {
      if (Math.random() < prob) {
        const key = a + ':' + b;
        loveStates[key] = {a, b, stage: 0, timer: 3 + Math.floor(Math.random()*3)};
      }
    }
  });
}

function checkSynergies() {
  const classIds = party.map(p=>p.classId);
  SYNERGIES.forEach(s => {
    if (s.members.every(m => classIds.includes(m))) {
      addLog(`âœ¨ã€${s.name}ã€‘ç™ºå‹•ï¼`, 'synergy');
      party.forEach(p => {
        if (s.members.includes(p.classId)) {
          if (s.effect === 'defUp') p.def += s.value;
          if (s.effect === 'atkUp') p.atk += s.value;
          if (s.effect === 'spdUp') p.spd += s.value;
          if (s.effect === 'healUp') p.buffs.healMult = s.value;
        }
      });
    }
  });
}

// ===== ãƒ•ãƒ­ã‚¢é€²è¡Œ =====
function scheduleNextFloor() {
  if (!running) return;
  intervalId = setTimeout(async () => await processFloor(), speedMs[currentSpeed]);
}

// ===== æ›ã‘åˆã„ç™ºç”Ÿã‚·ã‚¹ãƒ†ãƒ  =====
function triggerBanter(context) {
  // context: 'explore' | 'battle' | 'rest'
  const alive = party.filter(p=>p.alive);
  if (alive.length < 2) return;

  // ç¢ºç‡ãƒã‚§ãƒƒã‚¯ï¼ˆ20-30%ï¼‰
  if (Math.random() > 0.25) return;

  let lines = null;

  // 1. ã‚­ãƒ£ãƒ©å›ºæœ‰ãƒšã‚¢ã‚’å„ªå…ˆãƒã‚§ãƒƒã‚¯
  if (context === 'explore' || context === 'rest') {
    const pairKeys = [];
    for (let i=0;i<alive.length;i++) {
      for (let j=i+1;j<alive.length;j++) {
        pairKeys.push(alive[i].uid+':'+alive[j].uid);
        pairKeys.push(alive[j].uid+':'+alive[i].uid);
      }
    }
    const matchedPairs = pairKeys.filter(k => BANTER.pair[k]);
    if (matchedPairs.length > 0 && Math.random() < 0.5) {
      const key = pick(matchedPairs);
      lines = pick(BANTER.pair[key]).lines;
    }
  }

  // 2. æ‹æ„›æ®µéšåˆ¥
  if (!lines && (context === 'explore' || context === 'rest')) {
    for (const [key, state] of Object.entries(loveStates)) {
      const pa = party.find(p=>p.uid===state.a);
      const pb = party.find(p=>p.uid===state.b);
      if (pa && pb && pa.alive && pb.alive && state.stage >= 1 && state.stage <= 3) {
        if (BANTER.loveStage[state.stage] && Math.random() < 0.3) {
          const template = pick(BANTER.loveStage[state.stage]);
          const otherMembers = alive.filter(p=>p.uid!==pa.uid && p.uid!==pb.uid);
          const other = otherMembers.length > 0 ? pick(otherMembers).name : 'ã¿ã‚“ãª';
          lines = template.lines.map(l => l.replace(/{a}/g, pa.name).replace(/{b}/g, pb.name).replace(/ä»–ãƒ¡ãƒ³ãƒãƒ¼/g, other));
          break;
        }
      }
    }
  }

  // 3. åŒè·ãƒ©ã‚¤ãƒãƒ«
  if (!lines && context === 'explore') {
    const classCount = {};
    alive.forEach(p => {
      if (!classCount[p.classId]) classCount[p.classId] = [];
      classCount[p.classId].push(p);
    });
    for (const [cid, members] of Object.entries(classCount)) {
      if (members.length >= 2 && BANTER.rivalry[cid] && Math.random() < 0.3) {
        const template = pick(BANTER.rivalry[cid]);
        lines = template.lines.map(l => l.replace(/{a}/g, members[0].name).replace(/{b}/g, members[1].name));
        break;
      }
    }
  }

  // 4. æˆ¦é—˜ä¸­ã®æ±ç”¨
  if (!lines && context === 'battle') {
    const a = pick(alive), b = pick(alive.filter(p=>p.uid!==a.uid));
    if (b) {
      const template = pick(BANTER.battleGeneric);
      lines = template.lines.map(l => l.replace(/{a}/g, a.name).replace(/{b}/g, b.name));
    }
  }

  // 5. ä¼‘æ†©ä¸­ã®æ±ç”¨
  if (!lines && context === 'rest') {
    const a = pick(alive), b = pick(alive.filter(p=>p.uid!==a.uid));
    if (b) {
      const template = pick(BANTER.restGeneric);
      lines = template.lines.map(l => l.replace(/{a}/g, a.name).replace(/{b}/g, b.name));
    }
  }

  // 6. æ±ç”¨é›‘è«‡
  if (!lines && context === 'explore') {
    const a = pick(alive), b = pick(alive.filter(p=>p.uid!==a.uid));
    if (b) {
      const template = pick(BANTER.generic);
      lines = template.lines.map(l => l.replace(/{a}/g, a.name).replace(/{b}/g, b.name));
    }
  }

  // è¡¨ç¤º
  if (lines) {
    addLog('ğŸ’¬', 'talk');
    lines.forEach(l => addLog(`  ${l}`, 'talk'));
    updateStats('conversationsHad');
  }
}

// ===== ã‚­ãƒ£ãƒ©å›ºæœ‰ã‚»ãƒªãƒ•æŒ¿å…¥ =====
function getCharBattleCry(p) {
  if (p.personality && p.personality.battleCry && Math.random() < 0.25) {
    return `${p.name}ã€Œ${pick(p.personality.battleCry)}ã€`;
  }
  return null;
}

async function processFloor() {
  if (!running) return;
  floor++;
  document.getElementById('floor-display').textContent = `B${floor}F`;
  addLog(`\nâ”â”â” B${floor}F â”â”â”`, 'floor');

  // ãƒ•ãƒ­ã‚¢ç¯€ç›®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
  if (TEXTS.floorMilestone[floor]) {
    addLog(pick(TEXTS.floorMilestone[floor]), 'floor');
  } else if (Math.random() < 0.3) {
    addLog(pick(TEXTS.floorAmbience), 'system');
  }

  // åŒè·ãƒšãƒŠãƒ«ãƒ†ã‚£
  applyJealousy();

  // æ‹æ„›é€²è¡Œ
  advanceLove();

  // ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰çŠ¶æ…‹æ›´æ–°
  updateAdventureField();
  
  // æ›ã‘åˆã„ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆæ¢ç´¢ä¸­ï¼‰
  triggerBanter('explore');

  // ã‚¤ãƒ™ãƒ³ãƒˆæ±ºå®š
  const r = Math.random();
  const alive = party.filter(p=>p.alive);
  if (alive.length === 0) { endGame(); return; }
  
  // åŸºæœ¬çš„ã«ã¯æ¢ç´¢ãƒ¢ãƒ¼ãƒ‰
  setExploringMode();

  if (r < 0.55) {
    await battleEvent(); // éåŒæœŸæˆ¦é—˜
  } else if (r < 0.75) {
    trapEvent();
  } else if (r < 0.90) {
    restEvent();
  } else {
    treasureEvent();
  }

  // ç”Ÿå­˜ãƒã‚§ãƒƒã‚¯ + ãƒ”ãƒ³ãƒæ™‚ã‚»ãƒªãƒ•
  party.forEach(p => {
    if (p.hp <= 0 && p.alive) {
      p.alive = false; p.hp = 0;
      addLog(pick(TEXTS.death).replace(/{name}/g, p.name), 'death');
      deathLog.push({name:p.name, floor, cause:'æˆ¦é—˜ä¸èƒ½'});
    } else if (p.alive && p.hp > 0 && p.hp < p.maxHp * 0.25 && p.personality && p.personality.battleHurt && Math.random() < 0.4) {
      addLog(`  ğŸ’¬ ${p.name}ã€Œ${pick(p.personality.battleHurt)}ã€`, 'talk');
    }
  });

  renderHP();

  if (party.filter(p=>p.alive).length === 0) {
    endGame(); return;
  }

  scheduleNextFloor();
}

// ===== å†’é™ºãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰æ©Ÿèƒ½ =====
function updateAdventureField() {
  // ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ãƒ¡ãƒ³ãƒãƒ¼ã‚’ã‚¹ãƒ—ãƒ©ã‚¤ãƒˆã«è¡¨ç¤º
  party.forEach((member, index) => {
    const sprite = document.getElementById(`char${index}`);
    const nameEl = sprite?.parentElement.querySelector('.char-name-mini');
    const hpFill = document.getElementById(`charHp${index}`);
    const hpText = document.getElementById(`charHpText${index}`);
    
    if (sprite) {
      sprite.textContent = member.icon;
      sprite.className = `character-sprite ${member.alive ? '' : 'dead'}`;
      
      // åå‰è¡¨ç¤º
      if (nameEl) nameEl.textContent = member.name;
      
      // HPãƒãƒ¼æ›´æ–°
      if (hpFill && hpText) {
        const hpPercent = Math.max(0, member.hp / member.maxHp * 100);
        hpFill.style.width = `${hpPercent}%`;
        hpText.textContent = `${Math.max(0,member.hp)}/${member.maxHp}`;
        
        // HPãƒãƒ¼ã®è‰²å¤‰æ›´
        hpFill.className = 'hp-fill';
        if (hpPercent <= 25) hpFill.classList.add('low');
        else if (hpPercent <= 50) hpFill.classList.add('mid');
      }
    }
  });
  
  // ãƒ•ãƒ­ã‚¢è¡¨ç¤ºæ›´æ–°
  const floorDisplay = document.getElementById('fieldFloorDisplay');
  if (floorDisplay) {
    floorDisplay.textContent = `B${floor}F`;
  }
}

function showEnemy(monsterName, currentHp, maxHp) {
  const enemyContainer = document.getElementById('enemyContainer');
  const enemySprite = document.getElementById('currentEnemy');
  const enemyNameEl = document.getElementById('enemyName');
  const enemyHpFill = document.getElementById('enemyHpFill');
  const enemyHpText = document.getElementById('enemyHpText');
  const envTitle = document.getElementById('envTitle');
  
  // ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚¢ã‚¤ã‚³ãƒ³ã‚’è¨­å®š
  const monsterIcons = {
    'ã‚´ãƒ–ãƒªãƒ³ã®ç¾¤ã‚Œ': 'ğŸ‘¹',
    'ã‚¹ã‚±ãƒ«ãƒˆãƒ³æˆ¦å£«': 'ğŸ’€',
    'ã‚ªãƒ¼ã‚¯': 'ğŸ‘º',
    'ãƒ€ãƒ¼ã‚¯ã‚¨ãƒ«ãƒ•': 'ğŸ§â€â™€ï¸',
    'ãƒŸãƒã‚¿ã‚¦ãƒ­ã‚¹': 'ğŸ‚',
    'ãƒ¯ã‚¤ãƒãƒ¼ãƒ³': 'ğŸ‰',
    'ãƒªãƒƒãƒ': 'â˜ ï¸',
    'ãƒ‰ãƒ©ã‚´ãƒ³': 'ğŸ²',
    'ãƒ‡ãƒ¼ãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ‰': 'ğŸ‘¹',
    'æ·±æ·µã®ä½¿å¾’': 'ğŸŒ‘',
  };
  
  // æ•µã‚’è¡¨ç¤º
  if (enemyContainer) enemyContainer.style.display = 'block';
  if (enemySprite) enemySprite.textContent = monsterIcons[monsterName] || 'ğŸ‘¿';
  if (enemyNameEl) enemyNameEl.textContent = monsterName;
  if (envTitle) envTitle.textContent = 'âš”ï¸ æˆ¦é—˜ä¸­';
  
  updateEnemyHP(currentHp, maxHp);
}

function hideEnemy() {
  const enemyContainer = document.getElementById('enemyContainer');
  const envTitle = document.getElementById('envTitle');
  
  if (enemyContainer) enemyContainer.style.display = 'none';
  if (envTitle) envTitle.textContent = 'ğŸŒ‘ æ·±æ·µã®é—‡';
}

function updateEnemyHP(currentHp, maxHp) {
  const enemyHpFill = document.getElementById('enemyHpFill');
  const enemyHpText = document.getElementById('enemyHpText');
  
  if (enemyHpFill && enemyHpText) {
    const hpPercent = Math.max(0, currentHp / maxHp * 100);
    enemyHpFill.style.width = `${hpPercent}%`;
    enemyHpText.textContent = `${Math.max(0, currentHp)}/${maxHp}`;
  }
}

function showEventMessage(message, type = 'normal') {
  const actionDesc = document.getElementById('actionDesc');
  const eventMessages = document.getElementById('eventMessages');
  
  if (actionDesc) {
    actionDesc.textContent = message;
    actionDesc.className = `action-description ${type}`;
  }
  
  // ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ã«è¿½åŠ 
  if (eventMessages) {
    const msgEl = document.createElement('div');
    msgEl.className = `event-msg ${type}`;
    msgEl.textContent = message;
    eventMessages.appendChild(msgEl);
    eventMessages.scrollTop = eventMessages.scrollHeight;
    
    // å¤ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‰Šé™¤ï¼ˆæœ€æ–°5ä»¶ã®ã¿ä¿æŒï¼‰
    while (eventMessages.children.length > 5) {
      eventMessages.removeChild(eventMessages.firstChild);
    }
  }
}

function showSpeechBubble(character, text) {
  const speechBubble = document.getElementById('speechBubble');
  const speechContent = document.getElementById('speechContent');
  
  if (speechBubble && speechContent) {
    speechContent.textContent = `${character}ï¼š${text}`;
    speechBubble.style.display = 'block';
    
    // 3ç§’å¾Œã«éè¡¨ç¤º
    setTimeout(() => {
      speechBubble.style.display = 'none';
    }, 3000);
  }
}

function updateEventStatus(status) {
  const eventStatus = document.getElementById('eventStatus');
  if (eventStatus) {
    eventStatus.textContent = status;
  }
}

function showDamageNumber(targetElement, damage, type = 'damage') {
  const damageContainer = targetElement.querySelector('.damage-numbers');
  if (!damageContainer) return;
  
  const popup = document.createElement('div');
  popup.className = `damage-popup ${type}`;
  
  if (type === 'damage') {
    popup.textContent = `-${damage}`;
  } else if (type === 'heal') {
    popup.textContent = `+${damage}`;
  } else if (type === 'miss') {
    popup.textContent = 'Miss!';
  }
  
  damageContainer.appendChild(popup);
  
  // 1.5ç§’å¾Œã«å‰Šé™¤
  setTimeout(() => {
    if (popup.parentNode) popup.parentNode.removeChild(popup);
  }, 1500);
}

function performAttackAnimation(attackerIndex, target = 'enemy') {
  const attacker = document.getElementById(`char${attackerIndex}`);
  if (!attacker) return;
  
  return new Promise((resolve) => {
    // æ”»æ’ƒã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹
    attacker.classList.add('attacking');
    
    setTimeout(() => {
      // ãƒ’ãƒƒãƒˆã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
      if (target === 'enemy') {
        const enemy = document.getElementById('currentEnemy');
        if (enemy) enemy.classList.add('damaged');
        
        setTimeout(() => {
          if (enemy) enemy.classList.remove('damaged');
        }, 500);
      } else {
        // ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ãƒ¡ãƒ³ãƒãƒ¼ãŒæ”»æ’ƒã•ã‚Œã‚‹å ´åˆ
        const targetEl = document.getElementById(`char${target}`);
        if (targetEl) {
          targetEl.classList.add('hit-flash');
          setTimeout(() => targetEl.classList.remove('hit-flash'), 300);
        }
      }
      
      // æ”»æ’ƒã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³çµ‚äº†
      attacker.classList.remove('attacking');
      resolve();
    }, 300);
  });
}

function performEnemyAttackAnimation() {
  const enemy = document.getElementById('currentEnemy');
  if (!enemy) return Promise.resolve();
  
  return new Promise((resolve) => {
    enemy.classList.add('attacking');
    
    setTimeout(() => {
      enemy.classList.remove('attacking');
      resolve();
    }, 500);
  });
}

function initAdventureField() {
  updateAdventureField();
  updateEventStatus('æ¢ç´¢æº–å‚™å®Œäº†');
  showEventMessage('ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ã®å¥¥æ·±ãã¸å‘ã‹ã†');
}

function setExploringMode() {
  hideEnemy();
  updateEventStatus('æ¢ç´¢ä¸­...');
  
  // ãƒ©ãƒ³ãƒ€ãƒ ãªæ¢ç´¢ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
  const exploreMessages = [
    'æš—ã„é€šè·¯ã‚’æ…é‡ã«é€²ã‚“ã§ã„ã‚‹',
    'çŸ³ã®å£ã«å¤ã„æ–‡å­—ãŒåˆ»ã¾ã‚Œã¦ã„ã‚‹',
    'ã‹ã™ã‹ãªé¢¨ã®éŸ³ãŒèã“ãˆã‚‹',
    'è¶³éŸ³ãŒé™å¯‚ã«éŸ¿ã',
    'ä½•ã‹ã®æ°—é…ã‚’æ„Ÿã˜ã‚‹...'
  ];
  showEventMessage(exploreMessages[Math.floor(Math.random() * exploreMessages.length)]);
}

function setBattleMode(monsterName) {
  updateEventStatus('æˆ¦é—˜ä¸­ï¼');
  showEventMessage(`${monsterName} ã¨æˆ¦é—˜é–‹å§‹ï¼`, 'battle');
}

// ===== ã‚¤ãƒ™ãƒ³ãƒˆ =====
async function battleEvent() {
  const monsters = [
    {name:'ã‚´ãƒ–ãƒªãƒ³ã®ç¾¤ã‚Œ',atk:15,hp:60,tier:1},
    {name:'ã‚¹ã‚±ãƒ«ãƒˆãƒ³æˆ¦å£«',atk:22,hp:80,tier:1},
    {name:'ã‚ªãƒ¼ã‚¯',atk:30,hp:120,tier:2},
    {name:'ãƒ€ãƒ¼ã‚¯ã‚¨ãƒ«ãƒ•',atk:35,hp:90,tier:2},
    {name:'ãƒŸãƒã‚¿ã‚¦ãƒ­ã‚¹',atk:45,hp:200,tier:3},
    {name:'ãƒ¯ã‚¤ãƒãƒ¼ãƒ³',atk:50,hp:180,tier:3},
    {name:'ãƒªãƒƒãƒ',atk:55,hp:150,tier:4},
    {name:'ãƒ‰ãƒ©ã‚´ãƒ³',atk:70,hp:300,tier:4},
    {name:'ãƒ‡ãƒ¼ãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ‰',atk:80,hp:350,tier:5},
    {name:'æ·±æ·µã®ä½¿å¾’',atk:90,hp:400,tier:5},
  ];

  // ãƒ•ãƒ­ã‚¢ã«å¿œã˜ãŸæ•µé¸æŠ
  const maxTier = Math.min(5, Math.ceil(floor / 8));
  const pool = monsters.filter(m => m.tier <= maxTier);
  const mon = pool[Math.floor(Math.random()*pool.length)];
  const scale = Math.pow(1.06, floor - 1); // ã‚ˆã‚Šæ»‘ã‚‰ã‹ãªæˆé•·
  const mAtk = Math.floor(mon.atk * scale);
  let mHp = Math.floor(mon.hp * scale);
  const maxHp = mHp;

  // æ•µå‡ºç¾ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
  const appearMsgs = TEXTS.monsterAppear[mon.name] || TEXTS.monsterAppear._default;
  const appearMsg = pick(appearMsgs).replace(/{name}/g, mon.name);
  addLog(`âš” ${appearMsg}`, 'battle');

  // æˆ¦é—˜ãƒ¢ãƒ¼ãƒ‰è¨­å®š
  setBattleMode(mon.name);
  showEnemy(mon.name, mHp, maxHp);

  const alive = party.filter(p=>p.alive);
  // æˆ¦é—˜ä¸­ã®æ›ã‘åˆã„
  triggerBanter('battle');

  // ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼æ”»æ’ƒï¼ˆé †ç•ªã«ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ä»˜ãã§ï¼‰
  for (let i = 0; i < alive.length; i++) {
    const p = alive[i];
    const charIndex = party.findIndex(member => member.uid === p.uid);
    
      // ã‚­ãƒ£ãƒ©å›ºæœ‰ã‚»ãƒªãƒ•
    const cry = getCharBattleCry(p);
    if (cry) {
      addLog(`  ğŸ’¬ ${cry}`, 'talk');
      // ã‚¹ãƒ”ãƒ¼ãƒãƒãƒ–ãƒ«ã§ã‚‚è¡¨ç¤º
      const speechText = cry.replace(/.*ã€Œ(.*)ã€.*/, '$1');
      showSpeechBubble(p.name, speechText);
    }
    
    // ãƒ€ãƒ¡ãƒ¼ã‚¸è¨ˆç®—
    const lovePenalty = p.loveStage >= 3 ? 0.6 : p.loveStage >= 2 ? 0.8 : 1;
    const dmg = Math.max(1, Math.floor((p.atk + Math.random()*10) * lovePenalty));
    mHp -= dmg;
    mvpDamage[p.uid] += dmg;
    
    // æ”»æ’ƒãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    const atkMsgs = TEXTS.attack[p.classId] || TEXTS.attack.knight;
    addLog(`  â†’ ${pick(atkMsgs).replace(/{name}/g, p.name)} ${dmg}ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼`, 'battle');
    
    // æ”»æ’ƒã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
    await performAttackAnimation(charIndex, 'enemy');
    
    // æ•µã«ãƒ€ãƒ¡ãƒ¼ã‚¸è¡¨ç¤º
    const enemySlot = document.querySelector('.enemy-slot');
    if (enemySlot) {
      showDamageNumber(enemySlot, dmg, 'damage');
    }
    
    // æ•µHPæ›´æ–°
    updateEnemyHP(mHp, maxHp);
    
    // ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰çŠ¶æ…‹æ›´æ–°
    updateAdventureField();
    
    // 0.5ç§’å¾…æ©Ÿï¼ˆæ¬¡ã®æ”»æ’ƒã¾ã§ï¼‰
    await new Promise(resolve => setTimeout(resolve, 500));
    
    // æ•µãŒæ­»äº¡ã—ãŸå ´åˆã¯æ”»æ’ƒçµ‚äº†
    if (mHp <= 0) break;
  }

  // æˆ¦é—˜çµæœã®å‡¦ç†
  if (mHp <= 0) {
    addLog(`  â†’ ${pick(TEXTS.victory).replace(/{name}/g, mon.name)}`, 'battle');
    updateStats('monstersKilled');
    updateStats('totalDamageDealt', Object.values(mvpDamage).reduce((a,b) => a+b, 0));
    
    // å‹åˆ©æ™‚ã‚­ãƒ£ãƒ©ã‚»ãƒªãƒ•
    if (Math.random() < 0.35) {
      const speaker = pick(alive);
      if (speaker.personality && speaker.personality.battleWin) {
        addLog(`  ğŸ’¬ ${speaker.name}ã€Œ${pick(speaker.personality.battleWin)}ã€`, 'talk');
      }
    }
  } else {
    addLog(`  â†’ ${pick(TEXTS.counterattack).replace(/{name}/g, mon.name)}`, 'battle');
    
    // æ•µã®æ”»æ’ƒã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
    await performEnemyAttackAnimation();
    
    // æ•µæ”»æ’ƒï¼šã‚¿ãƒ³ã‚¯ãŒã„ã‚Œã°é›†ä¸­ã€ã„ãªã‘ã‚Œã°ãƒ©ãƒ³ãƒ€ãƒ 
    const knights = alive.filter(p=>p.classId==='knight');
    const targets = knights.length > 0 && Math.random()<0.6 ? knights : alive;
    const numHits = 1 + Math.floor(Math.random()*2);
    
    for (let i = 0; i < numHits; i++) {
      const t = targets[Math.floor(Math.random()*targets.length)];
      const charIndex = party.findIndex(member => member.uid === t.uid);
      const dmg = Math.max(1, mAtk - t.def + Math.floor(Math.random()*8));
      t.hp -= dmg;
      
      addLog(`  â†’ ${pick(TEXTS.takeDamage).replace(/{name}/g, t.name).replace(/{dmg}/g, dmg)} (HP:${Math.max(0,t.hp)}/${t.maxHp})`, 'battle');
      
      // ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ãƒ¡ãƒ³ãƒãƒ¼ã«ãƒ€ãƒ¡ãƒ¼ã‚¸è¡¨ç¤º
      const charSlot = document.querySelector(`[data-index="${charIndex}"]`);
      if (charSlot) {
        showDamageNumber(charSlot, dmg, 'damage');
        // ãƒ’ãƒƒãƒˆãƒ•ãƒ©ãƒƒã‚·ãƒ¥
        const charSprite = charSlot.querySelector('.character-sprite');
        if (charSprite) {
          charSprite.classList.add('hit-flash');
          setTimeout(() => charSprite.classList.remove('hit-flash'), 300);
        }
      }
      
      // 0.3ç§’å¾…æ©Ÿï¼ˆæ¬¡ã®ãƒ’ãƒƒãƒˆã¾ã§ï¼‰
      await new Promise(resolve => setTimeout(resolve, 300));
    }
    
    if (mHp > 0) addLog(`  â†’ ${pick(TEXTS.monsterFlee).replace(/{name}/g, mon.name)}`, 'battle');
  }

  // å°‘ã—å¾…ã£ã¦ã‹ã‚‰æˆ¦é—˜ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æ›´æ–°
  await new Promise(resolve => setTimeout(resolve, 500));

  // ãƒ’ãƒ¼ãƒ©ãƒ¼å›å¾©ï¼ˆã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ä»˜ãï¼‰
  const healers = alive.filter(p=>p.classId==='healer' && p.alive && p.loveStage<3);
  for (const h of healers) {
    const mult = h.buffs.healMult || 1;
    const wounded = party.filter(p=>p.alive && p.hp < p.maxHp);
    if (wounded.length > 0) {
      const t = wounded.sort((a,b)=>a.hp/a.maxHp-b.hp/b.maxHp)[0];
      const heal = Math.floor((25 + Math.random()*15) * mult);
      t.hp = Math.min(t.maxHp, t.hp + heal);
      
      addLog(`  ğŸ’š ${pick(TEXTS.heal).replace(/{healer}/g, h.name).replace(/{target}/g, t.name).replace(/{val}/g, heal)} (HP:${t.hp}/${t.maxHp})`, 'heal');
      updateStats('totalHealing', heal);
      
      // å›å¾©å¯¾è±¡ã«ãƒ’ãƒ¼ãƒ«ã‚¨ãƒ•ã‚§ã‚¯ãƒˆè¡¨ç¤º
      const targetIndex = party.findIndex(member => member.uid === t.uid);
      const targetSlot = document.querySelector(`[data-index="${targetIndex}"]`);
      if (targetSlot) {
        showDamageNumber(targetSlot, heal, 'heal');
      }
      
      await new Promise(resolve => setTimeout(resolve, 300));
    }
  }

  // åƒ§ä¾¶ãƒãƒ•ï¼ˆã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ä»˜ãï¼‰
  const priests = alive.filter(p=>p.classId==='priest' && p.alive && p.loveStage<3);
  for (const pr of priests) {
    if (Math.random() < 0.4) {
      const t = alive[Math.floor(Math.random()*alive.length)];
      const buff = Math.floor(3 + Math.random()*5);
      t.def += buff;
      
      addLog(`  ğŸ“¿ ${pick(TEXTS.priestBuff).replace(/{priest}/g, pr.name).replace(/{target}/g, t.name).replace(/{val}/g, buff)}`, 'synergy');
      
      // ãƒãƒ•å¯¾è±¡ã«ã‚¨ãƒ•ã‚§ã‚¯ãƒˆè¡¨ç¤º
      const targetIndex = party.findIndex(member => member.uid === t.uid);
      const targetSlot = document.querySelector(`[data-index="${targetIndex}"]`);
      if (targetSlot) {
        const targetSprite = targetSlot.querySelector('.character-sprite');
        if (targetSprite) {
          targetSprite.style.boxShadow = '0 0 15px #ffd700';
          setTimeout(() => {
            targetSprite.style.boxShadow = '';
          }, 1000);
        }
      }
      
      await new Promise(resolve => setTimeout(resolve, 300));
    }
  }

  // ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰çŠ¶æ…‹æ›´æ–°
  updateAdventureField(); // æ­»äº¡çŠ¶æ…‹ãªã©ã‚’åæ˜ 
  
  // 2ç§’å¾Œã«æ¢ç´¢ãƒ¢ãƒ¼ãƒ‰ã«æˆ»ã‚‹
  setTimeout(() => {
    setExploringMode();
    showEventMessage(mHp <= 0 ? 'æˆ¦é—˜ã«å‹åˆ©ã—ãŸ' : 'æ•µã‚’é€€ã‘ãŸ');
  }, 2000);
}

function trapEvent() {
  const traps = [
    {name:'è½ã¨ã—ç©´', dmg:20},
    {name:'æ¯’é‡ã®ç½ ', dmg:25},
    {name:'çˆ†ç™ºã®ãƒ«ãƒ¼ãƒ³', dmg:35},
    {name:'å‘ªã„ã®éœ§', dmg:30},
    {name:'çŸ¢ã®é›¨', dmg:28},
  ];
  const trap = traps[Math.floor(Math.random()*traps.length)];
  const scale = 1 + floor * 0.05;
  const baseDmg = Math.floor(trap.dmg * scale);

  const thieves = party.filter(p=>p.classId==='thief' && p.alive && p.loveStage<3);
  if (thieves.length > 0 && Math.random() < 0.85) { // è§£é™¤ç‡å‘ä¸Š
    addLog(`ğŸ”§ ${pick(TEXTS.trapFound).replace(/{trap}/g, trap.name).replace(/{thief}/g, thieves[0].name)}`, 'trap');
    if (thieves[0].personality && thieves[0].personality.trapLine && Math.random() < 0.4) {
      addLog(`  ğŸ’¬ ${thieves[0].name}ã€Œ${pick(thieves[0].personality.trapLine)}ã€`, 'talk');
    }
    updateStats('trapsDisarmed');
    
    // ç›—è³Šã«ãƒœãƒ¼ãƒŠã‚¹çµŒé¨“å€¤
    thieves[0].atk += Math.floor(Math.random() * 2) + 1; // +1ï½2æ”»æ’ƒåŠ›
  } else {
    addLog(pick(TEXTS.trapTriggered).replace(/{trap}/g, trap.name), 'trap');
    const alive = party.filter(p=>p.alive);
    const hit = thieves.length > 0 ? 0.5 : 1;
    alive.forEach(p => {
      if (Math.random() < hit) {
        const dmg = Math.max(1, baseDmg - Math.floor(p.def * 0.3));
        p.hp -= dmg;
        addLog(`  â†’ ${pick(TEXTS.trapDamage).replace(/{name}/g, p.name).replace(/{dmg}/g, dmg).replace(/{trap}/g, trap.name)}`, 'trap');
      }
    });
  }
}

function restEvent() {
  addLog(pick(TEXTS.restScene), 'rest');
  const alive = party.filter(p=>p.alive);
  alive.forEach(p => {
    const heal = Math.floor(p.maxHp * (0.05 + Math.random()*0.1));
    p.hp = Math.min(p.maxHp, p.hp + heal);
  });
  addLog(`  â†’ ${pick(TEXTS.restRecover)}`, 'rest');

  // ã‚­ãƒ£ãƒ©å›ºæœ‰ã®ä¼‘æ†©ã‚»ãƒªãƒ•
  if (Math.random() < 0.4) {
    const speaker = pick(alive);
    if (speaker.personality && speaker.personality.restLine) {
      addLog(`  ğŸ’¬ ${speaker.name}ã€Œ${pick(speaker.personality.restLine)}ã€`, 'talk');
    }
  }

  // ä¼‘æ†©ä¸­ã®æ›ã‘åˆã„
  triggerBanter('rest');
}

function treasureEvent() {
  const items = [
    // åŸºæœ¬å¼·åŒ–ã‚¢ã‚¤ãƒ†ãƒ 
    {name:'åŠ›ã®çµæ™¶', type:'stat', stat:'atk', val:5, rarity:'common'},
    {name:'å®ˆã‚Šã®ãŠå®ˆã‚Š', type:'stat', stat:'def', val:5, rarity:'common'},
    {name:'ç–¾é¢¨ã®é´', type:'stat', stat:'spd', val:5, rarity:'common'},
    {name:'ç”Ÿå‘½ã®é›«', type:'stat', stat:'hp', val:30, rarity:'common'},
    
    // è£…å‚™ã‚¢ã‚¤ãƒ†ãƒ 
    {name:'é‹­åˆ©ãªå‰£', type:'equipment', slot:'weapon', atk:8, rarity:'uncommon'},
    {name:'é­”æ³•ã®æ–', type:'equipment', slot:'weapon', atk:6, def:2, rarity:'uncommon'},
    {name:'é‹¼ã®ç›¾', type:'equipment', slot:'shield', def:10, rarity:'uncommon'},
    {name:'çš®ã®é§', type:'equipment', slot:'armor', def:6, hp:20, rarity:'common'},
    {name:'éŠ€ã®æŒ‡è¼ª', type:'equipment', slot:'accessory', atk:3, def:3, rarity:'rare'},
    {name:'è³¢è€…ã®å¸½å­', type:'equipment', slot:'helmet', def:4, spd:3, rarity:'uncommon'},
    
    // ç‰¹æ®Šã‚¢ã‚¤ãƒ†ãƒ 
    {name:'çµŒé¨“ã®æ›¸', type:'special', effect:'levelup', rarity:'rare'},
    {name:'å…¨å›å¾©è–¬', type:'special', effect:'fullheal', rarity:'uncommon'},
    {name:'ç¥ç¦ã®è–æ°´', type:'special', effect:'blessing', rarity:'rare'}
  ];
  
  // ãƒ¬ã‚¢ãƒªãƒ†ã‚£ã«ã‚ˆã‚‹å‡ºç¾ç‡èª¿æ•´
  const rarityWeights = {common: 50, uncommon: 30, rare: 15, legendary: 5};
  const weightedItems = [];
  items.forEach(item => {
    const weight = rarityWeights[item.rarity] || 10;
    for(let i = 0; i < weight; i++) {
      weightedItems.push(item);
    }
  });
  
  const item = weightedItems[Math.floor(Math.random() * weightedItems.length)];
  const alive = party.filter(p=>p.alive);
  const target = alive[Math.floor(Math.random()*alive.length)];
  
  addLog(pick(TEXTS.treasureFind), 'synergy');
  
  if (item.type === 'stat') {
    addLog(`  â†’ ${pick(TEXTS.treasureGet).replace(/{item}/g, item.name).replace(/{target}/g, target.name)}`, 'synergy');
    if (item.stat==='hp') { 
      target.maxHp += item.val; 
      target.hp += item.val; 
    } else {
      target[item.stat] += item.val;
    }
    addLog(`  â†’ ${pick(TEXTS.treasureStatUp[item.stat]).replace(/{target}/g, target.name)}`, 'synergy');
    
  } else if (item.type === 'equipment') {
    equipItem(target, item);
    
  } else if (item.type === 'special') {
    useSpecialItem(target, item);
  }
}

function equipItem(character, item) {
  if (!character.equipment) character.equipment = {};
  
  const oldItem = character.equipment[item.slot];
  if (oldItem) {
    // å¤ã„è£…å‚™ã®åŠ¹æœã‚’å‰Šé™¤
    removeEquipmentStats(character, oldItem);
    addLog(`  â†’ ${character.name}ã®${oldItem.name}ãŒå¤–ã‚ŒãŸ`, 'system');
  }
  
  // æ–°ã—ã„è£…å‚™ã®åŠ¹æœã‚’é©ç”¨
  character.equipment[item.slot] = item;
  applyEquipmentStats(character, item);
  
  const rarityColor = {common:'#fff', uncommon:'#4caf50', rare:'#2196f3', legendary:'#ffd700'};
  addLog(`  â†’ ${character.name}ãŒ${item.name}ã‚’è£…å‚™ã—ãŸï¼`, 'synergy');
}

function applyEquipmentStats(character, item) {
  if (item.atk) character.atk += item.atk;
  if (item.def) character.def += item.def;
  if (item.spd) character.spd += item.spd;
  if (item.hp) { character.maxHp += item.hp; character.hp += item.hp; }
}

function removeEquipmentStats(character, item) {
  if (item.atk) character.atk -= item.atk;
  if (item.def) character.def -= item.def;
  if (item.spd) character.spd -= item.spd;
  if (item.hp) character.maxHp -= item.hp;
}

function useSpecialItem(target, item) {
  addLog(`  â†’ ${target.name}ãŒ${item.name}ã‚’ä½¿ç”¨ã—ãŸï¼`, 'synergy');
  
  switch(item.effect) {
    case 'levelup':
      target.atk += 3;
      target.def += 2;
      target.maxHp += 15;
      target.hp += 15;
      addLog(`  â†’ ${target.name}ã®ãƒ¬ãƒ™ãƒ«ãŒä¸ŠãŒã£ãŸï¼å…¨èƒ½åŠ›å€¤ãŒå‘ä¸Šï¼`, 'synergy');
      break;
      
    case 'fullheal':
      target.hp = target.maxHp;
      addLog(`  â†’ ${target.name}ã®HPãŒå®Œå…¨å›å¾©ã—ãŸï¼`, 'heal');
      break;
      
    case 'blessing':
      target.atk += 5;
      target.def += 5;
      addLog(`  â†’ ${target.name}ã«ç¥ã®ç¥ç¦ãŒå®¿ã£ãŸï¼`, 'synergy');
      break;
  }
}

// ===== åŒè·å«‰å¦¬ =====
function applyJealousy() {
  const classCount = {};
  party.filter(p=>p.alive).forEach(p => {
    classCount[p.classId] = (classCount[p.classId]||0)+1;
  });
  Object.entries(classCount).forEach(([cid,cnt]) => {
    if (cnt >= 2 && Math.random() < 0.3) {
      const dupes = party.filter(p=>p.alive && p.classId===cid);
      dupes.forEach(p => { p.atk = Math.max(5, p.atk - 2); });
      const cls = CLASSES.find(c=>c.id===cid).name;
      addLog(pick(TEXTS.jealousy).replace(/{names}/g, dupes.map(p=>p.name).join('ã¨')).replace(/{a}/g, dupes[0].name).replace(/{b}/g, dupes[1].name).replace(/{cls}/g, cls), 'love');
    }
  });
}

// ===== æ‹æ„›é€²è¡Œ =====
function advanceLove() {
  Object.entries(loveStates).forEach(([key, state]) => {
    const pa = party.find(p=>p.uid===state.a);
    const pb = party.find(p=>p.uid===state.b);
    if (!pa || !pb || !pa.alive || !pb.alive) return;

    state.timer--;
    if (state.timer > 0) return;

    state.stage++;
    state.timer = 2 + Math.floor(Math.random()*3);
    pa.loveStage = Math.max(pa.loveStage, state.stage);
    pb.loveStage = Math.max(pb.loveStage, state.stage);

    const loveMsgSets = [
      [TEXTS.loveStage1, 'love'],
      [TEXTS.loveStage2, 'love'],
      [TEXTS.loveStage3, 'love'],
      [TEXTS.loveStage4, 'death'],
    ];

    if (state.stage <= 4) {
      const [pool, cls] = loveMsgSets[Math.min(state.stage-1, loveMsgSets.length-1)];
      addLog(pick(pool).replace(/{a}/g, pa.name).replace(/{b}/g, pb.name), cls);
    }

    if (state.stage >= 4) {
      pa.alive = false; pa.hp = 0;
      pb.alive = false; pb.hp = 0;
      deathLog.push({name:pa.name, floor, cause:`${pb.name}ã¨ã®æ‹ã«è½ã¡ãŸ`});
      deathLog.push({name:pb.name, floor, cause:`${pa.name}ã¨ã®æ‹ã«è½ã¡ãŸ`});
      addLog(pick(TEXTS.loveLeave).replace(/{a}/g, pa.name).replace(/{b}/g, pb.name), 'love');
    }
  });
}

// ===== UI =====
const CLASS_ICONS = {knight:'ğŸ›¡ï¸',mage:'ğŸ”®',healer:'ğŸ’š',thief:'ğŸ—¡ï¸',archer:'ğŸ¹',priest:'ğŸ“¿'};

function getStatusIcons(p) {
  let icons = '';
  if (!p.alive) return 'â˜ ï¸';
  if (p.loveStage >= 3) icons += 'ğŸ’•';
  else if (p.loveStage >= 1) icons += 'ğŸ’—';
  // å«‰å¦¬ãƒã‚§ãƒƒã‚¯ï¼ˆåŒè·ãŒã„ã‚‹ã‹ï¼‰
  const sameClass = party.filter(x=>x.uid!==p.uid && x.classId===p.classId && x.alive);
  if (sameClass.length > 0) icons += 'ğŸ˜¤';
  return icons;
}

function renderHP() {
  const area = document.getElementById('party-hp');
  area.innerHTML = party.map(p => {
    const pct = Math.max(0, p.hp / p.maxHp * 100);
    const cls = pct <= 25 ? 'low' : pct <= 50 ? 'mid' : '';
    const statusIcons = getStatusIcons(p);
    const classIcon = CLASS_ICONS[p.classId]||'';
    return `<div class="hp-bar-wrap${p.alive?'':' dead'}">
      <div class="hp-name">
        <span class="char-info-left">${p.icon}${classIcon} ${p.name}</span>
        <span><span class="status-icons">${statusIcons}</span> ${Math.max(0,p.hp)}/${p.maxHp}</span>
      </div>
      <div class="hp-bar-bg"><div class="hp-bar ${cls}" style="width:${pct}%"></div></div>
    </div>`;
  }).join('');
}

function addLog(text, cls='') {
  const area = document.getElementById('log-area');
  const div = document.createElement('div');
  // ã‚»ãƒªãƒ•ã¯å¹ãå‡ºã—é¢¨ã«
  const isTalkBubble = cls === 'talk' && (text.includes('ã€Œ') || text.trim().startsWith('ğŸ’¬'));
  div.className = 'log-line ' + cls + (isTalkBubble ? ' talk-bubble' : '');
  div.textContent = text;
  area.appendChild(div);
  area.scrollTop = area.scrollHeight;
}

function clearLog() {
  document.getElementById('log-area').innerHTML = '';
}

function showScreen(id) {
  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

function setSpeed(s) {
  currentSpeed = s;
  document.querySelectorAll('.speed-control button').forEach((b,i)=>b.classList.toggle('active',i===s));
}

// ===== çµæœ =====
function endGame() {
  running = false;
  clearTimeout(intervalId);
  addLog(`\n${pick(TEXTS.wipe)}`, 'death');
  
  // çµ±è¨ˆæƒ…å ±æ›´æ–°
  gameStats.highestFloor = Math.max(gameStats.highestFloor, floor);
  gameStats.totalDeaths += deathLog.length;
  totalPlayTime = Date.now() - gameStartTime;
  
  // ã‚¢ãƒãƒ¼ãƒ–ãƒ¡ãƒ³ãƒˆåˆ¤å®š
  checkEndGameAchievements();
  
  // ãƒ‡ãƒ¼ã‚¿ä¿å­˜
  localStorage.setItem('dungeonParty_stats', JSON.stringify(gameStats));
  localStorage.setItem('dungeonParty_achievements', JSON.stringify(achievements));

  setTimeout(() => {
    showDetailedResults();
  }, 1000);
}

function showDetailedResults() {
  // MVPè¨ˆç®—
  let mvpUid = null, mvpVal = 0;
  Object.entries(mvpDamage).forEach(([uid,d]) => { if (d>mvpVal){mvpVal=d;mvpUid=uid;} });
  const mvp = characters.find(c=>c.uid===mvpUid);
  
  // ç”Ÿå­˜è€…æ•°
  const survivors = party.filter(p => p.alive).length;
  const allDead = survivors === 0;
  
  // ãƒ—ãƒ¬ã‚¤æ™‚é–“è¨ˆç®—
  const playTimeMinutes = Math.floor(totalPlayTime / 60000);
  const playTimeSeconds = Math.floor((totalPlayTime % 60000) / 1000);
  
  // æ‹æ„›çŠ¶æ³
  const loveCount = Object.values(loveStates).filter(state => state.stage >= 3).length;
  
  // çµæœã‚¿ã‚¤ãƒˆãƒ«è¨­å®š
  const resultTitle = document.getElementById('result-title');
  if (floor >= 30) {
    resultTitle.innerHTML = 'ğŸŒŸ ä¼èª¬ã®å†’é™ºè€…';
  } else if (floor >= 20) {
    resultTitle.innerHTML = 'â­ ç†Ÿç·´ã®å†’é™ºè€…';
  } else if (floor >= 10) {
    resultTitle.innerHTML = 'ğŸ’ª é§†ã‘å‡ºã—å†’é™ºè€…';
  } else {
    resultTitle.innerHTML = 'ğŸ˜… æ¢ç´¢çµ‚äº†';
  }
  
  // ã‚µãƒãƒªãƒ¼è¡¨ç¤º
  const summary = document.getElementById('result-summary');
  summary.innerHTML = `
    <div class="result-title-main">B${floor}F åˆ°é”</div>
    <div class="result-subtitle">${survivors}/${party.length}äººç”Ÿå­˜</div>
    <div class="result-time">ãƒ—ãƒ¬ã‚¤æ™‚é–“: ${playTimeMinutes}åˆ†${playTimeSeconds}ç§’</div>
  `;
  
  // çµ±è¨ˆè¡¨ç¤º
  const stats = document.getElementById('result-stats');
  stats.innerHTML = `
    <div class="result-stat-card">
      <h4>ğŸ† MVP</h4>
      <div class="result-stat-value">${mvp ? `${mvp.icon} ${mvp.name}` : 'ãªã—'}</div>
      <div style="font-size:0.8em; color:#aaa;">${mvpVal}ãƒ€ãƒ¡ãƒ¼ã‚¸</div>
    </div>
    <div class="result-stat-card">
      <h4>âš”ï¸ ç·ãƒ€ãƒ¡ãƒ¼ã‚¸</h4>
      <div class="result-stat-value">${Object.values(mvpDamage).reduce((a,b) => a+b, 0)}</div>
    </div>
    <div class="result-stat-card">
      <h4>ğŸ’• æ‹æ„›ãƒšã‚¢</h4>
      <div class="result-stat-value">${loveCount}çµ„</div>
    </div>
    <div class="result-stat-card">
      <h4>â±ï¸ æ™‚é–“</h4>
      <div class="result-stat-value">${playTimeMinutes}:${playTimeSeconds.toString().padStart(2, '0')}</div>
    </div>
  `;
  
  // ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼çŠ¶æ³
  const partyResult = document.getElementById('result-party');
  partyResult.innerHTML = `
    <h4>ğŸ›¡ï¸ ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼çŠ¶æ³</h4>
    <div class="result-party-grid">
      ${party.map(member => `
        <div class="result-party-member ${member.alive ? 'alive' : 'dead'}">
          <div style="font-size:2em;">${member.icon}</div>
          <div style="font-weight:bold;">${member.name}</div>
          <div style="font-size:0.8em; color:#aaa;">${member.className}</div>
          <div style="font-size:0.8em;">
            ${member.alive ? `HP: ${member.hp}/${member.maxHp}` : 'ğŸ’€ æˆ¦é—˜ä¸èƒ½'}
          </div>
          ${member.equipment ? Object.values(member.equipment).map(eq => `<div style="font-size:0.7em; color:#4caf50;">+${eq.name}</div>`).join('') : ''}
        </div>
      `).join('')}
    </div>
  `;
  
  // æ–°è¦ã‚¢ãƒãƒ¼ãƒ–ãƒ¡ãƒ³ãƒˆè¡¨ç¤º
  const recentAchievements = achievements.slice(-3); // ç›´è¿‘3ã¤
  const achievementResult = document.getElementById('result-achievements');
  if (recentAchievements.length > 0) {
    achievementResult.innerHTML = `
      <h4>ğŸ† ç²å¾—ã‚¢ãƒãƒ¼ãƒ–ãƒ¡ãƒ³ãƒˆ</h4>
      <div style="display:flex; gap:10px; justify-content:center; flex-wrap:wrap;">
        ${recentAchievements.map(id => {
          const achievement = ACHIEVEMENTS[id];
          return achievement ? `
            <div class="achievement-item unlocked" style="width:150px;">
              <div class="achievement-icon">${achievement.icon}</div>
              <div class="achievement-name">${achievement.name}</div>
            </div>
          ` : '';
        }).join('')}
      </div>
    `;
  } else {
    achievementResult.innerHTML = '';
  }
  
  showScreen('result-screen');
}

function checkEndGameAchievements() {
  const survivors = party.filter(p => p.alive).length;
  const playTimeMs = Date.now() - gameStartTime;
  
  // åˆå›ã‚¯ãƒªã‚¢ (B10Fä»¥ä¸Š)
  if (floor >= 10) {
    checkAchievement('first_clear');
  }
  
  // å®Œå…¨å‹åˆ© (å…¨å“¡ç”Ÿå­˜ã§ã‚¯ãƒªã‚¢)
  if (survivors === party.length && floor >= 10) {
    checkAchievement('all_alive');
  }
  
  // ã‚¹ãƒ”ãƒ¼ãƒ‰ãƒ©ãƒ³ (10åˆ†ä»¥å†…)
  if (playTimeMs <= 600000 && floor >= 10) {
    checkAchievement('speed_run');
  }
  
  // æ‹æ„›ãƒã‚¹ã‚¿ãƒ¼
  const maxLoveStage = Math.max(0, ...Object.values(loveStates).map(s => s.stage));
  if (maxLoveStage >= 3) {
    checkAchievement('love_master');
  }
  
  // ãƒ’ãƒ¼ãƒ©ãƒ¼ãªã—æŒ‘æˆ¦
  const hasHealer = party.some(p => p.classId === 'healer');
  if (!hasHealer && floor >= 5) {
    checkAchievement('no_healer');
  }
  
  // ãƒãƒ©ãƒ³ã‚¹å‹ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼
  const usedClasses = [...new Set(party.map(p => p.classId))];
  if (usedClasses.length === 6 && floor >= 10) {
    checkAchievement('balanced_party');
  }
  
  // ãƒˆãƒ©ãƒƒãƒ—ãƒã‚¹ã‚¿ãƒ¼
  if (gameStats.trapsDisarmed >= 20) {
    checkAchievement('trap_master');
  }
  
  // ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ãƒãƒ³ã‚¿ãƒ¼
  if (gameStats.monstersKilled >= 100) {
    checkAchievement('monster_hunter');
  }
}

function backToSelect() {
  running = false;
  if (intervalId) clearTimeout(intervalId);
  selected = [];
  renderSelect();
  showScreen('select-screen');
  updateContinueButton();
}

function continueGame() {
  if (loadGame()) {
    running = true;
    scheduleNextFloor();
  }
}

function showSettings() {
  showScreen('settings-screen');
  updateStatsDisplay();
  updateAchievementsDisplay();
  loadSettings();
}

function pauseGame() {
  running = !running;
  const pauseBtn = document.getElementById('pause-btn');
  if (running) {
    pauseBtn.textContent = 'â¸ï¸';
    pauseBtn.title = 'ãƒãƒ¼ã‚º';
    scheduleNextFloor();
    showEventMessage('ã‚²ãƒ¼ãƒ ã‚’å†é–‹ã—ã¾ã—ãŸ', 'system');
  } else {
    pauseBtn.textContent = 'â–¶ï¸';
    pauseBtn.title = 'å†é–‹';
    if (intervalId) clearTimeout(intervalId);
    showEventMessage('ã‚²ãƒ¼ãƒ ã‚’ä¸€æ™‚åœæ­¢ã—ã¾ã—ãŸ', 'system');
  }
}

function updateSettings() {
  const settings = {
    defaultSpeed: parseInt(document.getElementById('default-speed').value),
    autoSave: document.getElementById('auto-save').checked,
    animations: document.getElementById('animations').checked
  };
  localStorage.setItem('dungeonParty_settings', JSON.stringify(settings));
  
  // å³åº§ã«è¨­å®šã‚’é©ç”¨
  if (settings.defaultSpeed !== currentSpeed) {
    setSpeed(settings.defaultSpeed);
  }
}

function loadSettings() {
  const settingsStr = localStorage.getItem('dungeonParty_settings');
  if (!settingsStr) return;
  
  try {
    const settings = JSON.parse(settingsStr);
    document.getElementById('default-speed').value = settings.defaultSpeed || 1;
    document.getElementById('auto-save').checked = settings.autoSave !== false;
    document.getElementById('animations').checked = settings.animations !== false;
  } catch (e) {
    console.error('è¨­å®šã®èª­ã¿è¾¼ã¿ã«å¤±æ•—:', e);
  }
}

function resetStats() {
  if (confirm('çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“ã€‚')) {
    gameStats = {
      monstersKilled: 0,
      trapsDisarmed: 0,
      conversationsHad: 0,
      highestFloor: 0,
      totalDamageDealt: 0,
      totalHealing: 0,
      gamesPlayed: 0,
      totalDeaths: 0
    };
    achievements = [];
    localStorage.removeItem('dungeonParty_stats');
    updateStatsDisplay();
    updateAchievementsDisplay();
    showEventMessage('çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸ', 'system');
  }
}

function updateStatsDisplay() {
  document.getElementById('stat-games').textContent = gameStats.gamesPlayed || 0;
  document.getElementById('stat-floor').textContent = gameStats.highestFloor ? `B${gameStats.highestFloor}F` : 'B1F';
  document.getElementById('stat-monsters').textContent = gameStats.monstersKilled || 0;
  document.getElementById('stat-traps').textContent = gameStats.trapsDisarmed || 0;
}

function updateAchievementsDisplay() {
  const grid = document.getElementById('achievement-grid');
  grid.innerHTML = '';
  
  Object.entries(ACHIEVEMENTS).forEach(([id, achievement]) => {
    const div = document.createElement('div');
    div.className = `achievement-item ${achievements.includes(id) ? 'unlocked' : 'locked'}`;
    div.innerHTML = `
      <div class="achievement-icon">${achievement.icon}</div>
      <div class="achievement-name">${achievement.name}</div>
      <div class="achievement-desc">${achievement.desc}</div>
    `;
    grid.appendChild(div);
  });
}

function updateContinueButton() {
  const continueBtn = document.getElementById('continue-btn');
  if (hasSaveData()) {
    continueBtn.style.display = 'inline-block';
  } else {
    continueBtn.style.display = 'none';
  }
}

function shareResult() {
  const resultText = document.getElementById('result-summary').textContent;
  if (navigator.share) {
    navigator.share({
      title: 'æ·±æ·µã®ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ - çµæœ',
      text: resultText,
      url: window.location.href
    });
  } else {
    // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼
    navigator.clipboard.writeText(resultText + '\n' + window.location.href)
      .then(() => showEventMessage('çµæœã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ', 'system'))
      .catch(() => showEventMessage('ã‚·ã‚§ã‚¢æ©Ÿèƒ½ã¯ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã›ã‚“', 'system'));
  }
}

// åˆæœŸåŒ–
renderSelect();
loadSettings();
updateContinueButton();

// çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿
const statsStr = localStorage.getItem('dungeonParty_stats');
if (statsStr) {
  try {
    gameStats = {...gameStats, ...JSON.parse(statsStr)};
  } catch (e) {
    console.error('çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—:', e);
  }
}

// ã‚¢ãƒãƒ¼ãƒ–ãƒ¡ãƒ³ãƒˆã®èª­ã¿è¾¼ã¿
const achievementsStr = localStorage.getItem('dungeonParty_achievements');
if (achievementsStr) {
  try {
    achievements = JSON.parse(achievementsStr);
  } catch (e) {
    console.error('ã‚¢ãƒãƒ¼ãƒ–ãƒ¡ãƒ³ãƒˆã®èª­ã¿è¾¼ã¿ã«å¤±æ•—:', e);
  }
}
</script>
</body>
</html>
